function e(e,t){for(var r=0;r<t.length;r++){const n=t[r];if("string"!=typeof n&&!Array.isArray(n))for(const t in n)if("default"!==t&&!(t in e)){const r=Object.getOwnPropertyDescriptor(n,t);r&&Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:()=>n[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var r,n,s={exports:{}},i={};var o,a,l=(n||(n=1,s.exports=function(){if(r)return i;r=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(t,r,n){var s=null;if(void 0!==n&&(s=""+n),void 0!==r.key&&(s=""+r.key),"key"in r)for(var i in n={},r)"key"!==i&&(n[i]=r[i]);else n=r;return r=n.ref,{$$typeof:e,type:t,key:s,ref:void 0!==r?r:null,props:n}}return i.Fragment=t,i.jsx=n,i.jsxs=n,i}()),s.exports),c={exports:{}},u={};function h(){if(o)return u;o=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),p=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,y={};function v(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||g}function b(){}function w(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||g}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var x=w.prototype=new b;x.constructor=w,m(x,v.prototype),x.isPureReactComponent=!0;var _=Array.isArray;function S(){}var k={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function T(t,r,n){var s=n.ref;return{$$typeof:e,type:t,key:r,ref:void 0!==s?s:null,props:n}}function E(t){return"object"==typeof t&&null!==t&&t.$$typeof===e}var O=/\/+/g;function j(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36);var r,n}function P(r,n,s,i,o){var a=typeof r;"undefined"!==a&&"boolean"!==a||(r=null);var l,c,u=!1;if(null===r)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(r.$$typeof){case e:case t:u=!0;break;case d:return P((u=r._init)(r._payload),n,s,i,o)}}if(u)return o=o(r),u=""===i?"."+j(r,0):i,_(o)?(s="",null!=u&&(s=u.replace(O,"$&/")+"/"),P(o,n,s,"",function(e){return e})):null!=o&&(E(o)&&(l=o,c=s+(null==o.key||r&&r.key===o.key?"":(""+o.key).replace(O,"$&/")+"/")+u,o=T(l.type,c,l.props)),n.push(o)),1;u=0;var h,f=""===i?".":i+":";if(_(r))for(var g=0;g<r.length;g++)u+=P(i=r[g],n,s,a=f+j(i,g),o);else if("function"==typeof(g=null===(h=r)||"object"!=typeof h?null:"function"==typeof(h=p&&h[p]||h["@@iterator"])?h:null))for(r=g.call(r),g=0;!(i=r.next()).done;)u+=P(i=i.value,n,s,a=f+j(i,g++),o);else if("object"===a){if("function"==typeof r.then)return P(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(S,S):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(r),n,s,i,o);throw n=String(r),Error("Objects are not valid as a React child (found: "+("[object Object]"===n?"object with keys {"+Object.keys(r).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.")}return u}function A(e,t,r){if(null==e)return e;var n=[],s=0;return P(e,n,"","",function(e){return t.call(r,e,s++)}),n}function D(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},M={map:A,forEach:function(e,t,r){A(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};return u.Activity=f,u.Children=M,u.Component=v,u.Fragment=r,u.Profiler=s,u.PureComponent=w,u.StrictMode=n,u.Suspense=c,u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,u.__COMPILER_RUNTIME={__proto__:null,c:function(e){return k.H.useMemoCache(e)}},u.cache=function(e){return function(){return e.apply(null,arguments)}},u.cacheSignal=function(){return null},u.cloneElement=function(e,t,r){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var n=m({},e.props),s=e.key;if(null!=t)for(i in void 0!==t.key&&(s=""+t.key),t)!C.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(n[i]=t[i]);var i=arguments.length-2;if(1===i)n.children=r;else if(1<i){for(var o=Array(i),a=0;a<i;a++)o[a]=arguments[a+2];n.children=o}return T(e.type,s,n)},u.createContext=function(e){return(e={$$typeof:a,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:i,_context:e},e},u.createElement=function(e,t,r){var n,s={},i=null;if(null!=t)for(n in void 0!==t.key&&(i=""+t.key),t)C.call(t,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(s[n]=t[n]);var o=arguments.length-2;if(1===o)s.children=r;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];s.children=a}if(e&&e.defaultProps)for(n in o=e.defaultProps)void 0===s[n]&&(s[n]=o[n]);return T(e,i,s)},u.createRef=function(){return{current:null}},u.forwardRef=function(e){return{$$typeof:l,render:e}},u.isValidElement=E,u.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:D}},u.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},u.startTransition=function(e){var t=k.T,r={};k.T=r;try{var n=e(),s=k.S;null!==s&&s(r,n),"object"==typeof n&&null!==n&&"function"==typeof n.then&&n.then(S,N)}catch(i){N(i)}finally{null!==t&&null!==r.types&&(t.types=r.types),k.T=t}},u.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},u.use=function(e){return k.H.use(e)},u.useActionState=function(e,t,r){return k.H.useActionState(e,t,r)},u.useCallback=function(e,t){return k.H.useCallback(e,t)},u.useContext=function(e){return k.H.useContext(e)},u.useDebugValue=function(){},u.useDeferredValue=function(e,t){return k.H.useDeferredValue(e,t)},u.useEffect=function(e,t){return k.H.useEffect(e,t)},u.useEffectEvent=function(e){return k.H.useEffectEvent(e)},u.useId=function(){return k.H.useId()},u.useImperativeHandle=function(e,t,r){return k.H.useImperativeHandle(e,t,r)},u.useInsertionEffect=function(e,t){return k.H.useInsertionEffect(e,t)},u.useLayoutEffect=function(e,t){return k.H.useLayoutEffect(e,t)},u.useMemo=function(e,t){return k.H.useMemo(e,t)},u.useOptimistic=function(e,t){return k.H.useOptimistic(e,t)},u.useReducer=function(e,t,r){return k.H.useReducer(e,t,r)},u.useRef=function(e){return k.H.useRef(e)},u.useState=function(e){return k.H.useState(e)},u.useSyncExternalStore=function(e,t,r){return k.H.useSyncExternalStore(e,t,r)},u.useTransition=function(){return k.H.useTransition()},u.version="19.2.3",u}function d(){return a||(a=1,c.exports=h()),c.exports}var f=d();const p=e({__proto__:null,default:t(f)},[f]);var g,m,y={exports:{}},v={},b={exports:{}},w={};function x(){return m||(m=1,b.exports=(g||(g=1,function(e){function t(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<s(i,t)))break e;e[n]=t,e[r]=i,r=n}}function r(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,o=i>>>1;n<o;){var a=2*(n+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,r))c<i&&0>s(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[a]=r,n=a);else{if(!(c<i&&0>s(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,f=!1,p=!1,g=!1,m=!1,y="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function w(e){for(var s=r(c);null!==s;){if(null===s.callback)n(c);else{if(!(s.startTime<=e))break;n(c),s.sortIndex=s.expirationTime,t(l,s)}s=r(c)}}function x(e){if(g=!1,w(e),!p)if(null!==r(l))p=!0,S||(S=!0,_());else{var t=r(c);null!==t&&A(x,t.startTime-e)}}var _,S=!1,k=-1,C=5,T=-1;function E(){return!(!m&&e.unstable_now()-T<C)}function O(){if(m=!1,S){var t=e.unstable_now();T=t;var s=!0;try{e:{p=!1,g&&(g=!1,v(k),k=-1),f=!0;var i=d;try{t:{for(w(t),h=r(l);null!==h&&!(h.expirationTime>t&&E());){var o=h.callback;if("function"==typeof o){h.callback=null,d=h.priorityLevel;var a=o(h.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof a){h.callback=a,w(t),s=!0;break t}h===r(l)&&n(l),w(t)}else n(l);h=r(l)}if(null!==h)s=!0;else{var u=r(c);null!==u&&A(x,u.startTime-t),s=!1}}break e}finally{h=null,d=i,f=!1}s=void 0}}finally{s?_():S=!1}}}if("function"==typeof b)_=function(){b(O)};else if("undefined"!=typeof MessageChannel){var j=new MessageChannel,P=j.port2;j.port1.onmessage=O,_=function(){P.postMessage(null)}}else _=function(){y(O,0)};function A(t,r){k=y(function(){t(e.unstable_now())},r)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var r=d;d=t;try{return e()}finally{d=r}},e.unstable_requestPaint=function(){m=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=d;d=e;try{return t()}finally{d=r}},e.unstable_scheduleCallback=function(n,s,i){var o=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?o+i:o,n){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return n={id:u++,callback:s,priorityLevel:n,startTime:i,expirationTime:a=i+a,sortIndex:-1},i>o?(n.sortIndex=i,t(c,n),null===r(l)&&n===r(c)&&(g?(v(k),k=-1):g=!0,A(x,i-o))):(n.sortIndex=a,t(l,n),p||f||(p=!0,S||(S=!0,_()))),n},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(e){var t=d;return function(){var r=d;d=t;try{return e.apply(this,arguments)}finally{d=r}}}}(w)),w)),b.exports}var _,S,k,C,T={exports:{}},E={};function O(){if(_)return E;_=1;var e=d();function t(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");var i=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(e,t){return"font"===e?"":"string"==typeof t?"use-credentials"===t?t:"":void 0}return E.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,E.createPortal=function(e,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!r||1!==r.nodeType&&9!==r.nodeType&&11!==r.nodeType)throw Error(t(299));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,r,null,n)},E.flushSync=function(e){var t=i.T,r=n.p;try{if(i.T=null,n.p=2,e)return e()}finally{i.T=t,n.p=r,n.d.f()}},E.preconnect=function(e,t){"string"==typeof e&&(t?t="string"==typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,n.d.C(e,t))},E.prefetchDNS=function(e){"string"==typeof e&&n.d.D(e)},E.preinit=function(e,t){if("string"==typeof e&&t&&"string"==typeof t.as){var r=t.as,s=o(r,t.crossOrigin),i="string"==typeof t.integrity?t.integrity:void 0,a="string"==typeof t.fetchPriority?t.fetchPriority:void 0;"style"===r?n.d.S(e,"string"==typeof t.precedence?t.precedence:void 0,{crossOrigin:s,integrity:i,fetchPriority:a}):"script"===r&&n.d.X(e,{crossOrigin:s,integrity:i,fetchPriority:a,nonce:"string"==typeof t.nonce?t.nonce:void 0})}},E.preinitModule=function(e,t){if("string"==typeof e)if("object"==typeof t&&null!==t){if(null==t.as||"script"===t.as){var r=o(t.as,t.crossOrigin);n.d.M(e,{crossOrigin:r,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0})}}else null==t&&n.d.M(e)},E.preload=function(e,t){if("string"==typeof e&&"object"==typeof t&&null!==t&&"string"==typeof t.as){var r=t.as,s=o(r,t.crossOrigin);n.d.L(e,r,{crossOrigin:s,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0,type:"string"==typeof t.type?t.type:void 0,fetchPriority:"string"==typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"==typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"==typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"==typeof t.imageSizes?t.imageSizes:void 0,media:"string"==typeof t.media?t.media:void 0})}},E.preloadModule=function(e,t){if("string"==typeof e)if(t){var r=o(t.as,t.crossOrigin);n.d.m(e,{as:"string"==typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:r,integrity:"string"==typeof t.integrity?t.integrity:void 0})}else n.d.m(e)},E.requestFormReset=function(e){n.d.r(e)},E.unstable_batchedUpdates=function(e,t){return e(t)},E.useFormState=function(e,t,r){return i.H.useFormState(e,t,r)},E.useFormStatus=function(){return i.H.useHostTransitionStatus()},E.version="19.2.3",E}function j(){if(S)return T.exports;return S=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),T.exports=O(),T.exports}function P(){if(k)return v;k=1;var e=x(),t=d(),r=j();function n(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function i(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function o(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function a(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function l(e){if(i(e)!==e)throw Error(n(188))}function c(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=c(e)))return t;e=e.sibling}return null}var u=Object.assign,h=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),w=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function D(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=A&&e[A]||e["@@iterator"])?e:null}var N=Symbol.for("react.client.reference");function M(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===N?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case m:return"StrictMode";case S:return"Suspense";case C:return"SuspenseList";case O:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case p:return"Portal";case w:return e.displayName||"Context";case b:return(e._context.displayName||"Context")+".Consumer";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:M(e.type)||"Memo";case E:t=e._payload,e=e._init;try{return M(e(t))}catch(r){}}return null}var R=Array.isArray,L=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},F=[],z=-1;function B(e){return{current:e}}function U(e){0>z||(e.current=F[z],F[z]=null,z--)}function W(e,t){z++,F[z]=e.current,e.current=t}var V,H,G=B(null),Y=B(null),q=B(null),X=B(null);function K(e,t){switch(W(q,t),W(Y,e),W(G,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?wh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=xh(t=wh(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(G),W(G,e)}function J(){U(G),U(Y),U(q)}function Q(e){null!==e.memoizedState&&W(X,e);var t=G.current,r=xh(t,e.type);t!==r&&(W(Y,e),W(G,r))}function Z(e){Y.current===e&&(U(G),U(Y)),X.current===e&&(U(X),fd._currentValue=$)}function ee(e){if(void 0===V)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);V=t&&t[1]||"",H=-1<r.stack.indexOf("\n    at")?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+V+e+H}var te=!1;function re(e,t){if(!e||te)return"";te=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(s){var n=s}Reflect.construct(e,[],r)}else{try{r.call()}catch(i){n=i}e.call(r.prototype)}}else{try{throw Error()}catch(o){n=o}(r=e())&&"function"==typeof r.catch&&r.catch(function(){})}}catch(a){if(a&&n&&"string"==typeof a.stack)return[a.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=n.DetermineComponentFrameRoot(),o=i[0],a=i[1];if(o&&a){var l=o.split("\n"),c=a.split("\n");for(s=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;if(n===l.length||s===c.length)for(n=l.length-1,s=c.length-1;1<=n&&0<=s&&l[n]!==c[s];)s--;for(;1<=n&&0<=s;n--,s--)if(l[n]!==c[s]){if(1!==n||1!==s)do{if(n--,0>--s||l[n]!==c[s]){var u="\n"+l[n].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=n&&0<=s);break}}}finally{te=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?ee(r):""}function ne(e,t){switch(e.tag){case 26:case 27:case 5:return ee(e.type);case 16:return ee("Lazy");case 13:return e.child!==t&&null!==t?ee("Suspense Fallback"):ee("Suspense");case 19:return ee("SuspenseList");case 0:case 15:return re(e.type,!1);case 11:return re(e.type.render,!1);case 1:return re(e.type,!0);case 31:return ee("Activity");default:return""}}function se(e){try{var t="",r=null;do{t+=ne(e,r),r=e,e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}var ie=Object.prototype.hasOwnProperty,oe=e.unstable_scheduleCallback,ae=e.unstable_cancelCallback,le=e.unstable_shouldYield,ce=e.unstable_requestPaint,ue=e.unstable_now,he=e.unstable_getCurrentPriorityLevel,de=e.unstable_ImmediatePriority,fe=e.unstable_UserBlockingPriority,pe=e.unstable_NormalPriority,ge=e.unstable_LowPriority,me=e.unstable_IdlePriority,ye=e.log,ve=e.unstable_setDisableYieldValue,be=null,we=null;function xe(e){if("function"==typeof ye&&ve(e),we&&"function"==typeof we.setStrictMode)try{we.setStrictMode(be,e)}catch(t){}}var _e=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Se(e)/ke|0)|0},Se=Math.log,ke=Math.LN2;var Ce=256,Te=262144,Ee=4194304;function Oe(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function je(e,t,r){var n=e.pendingLanes;if(0===n)return 0;var s=0,i=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var a=134217727&n;return 0!==a?0!==(n=a&~i)?s=Oe(n):0!==(o&=a)?s=Oe(o):r||0!==(r=a&~e)&&(s=Oe(r)):0!==(a=n&~i)?s=Oe(a):0!==o?s=Oe(o):r||0!==(r=n&~e)&&(s=Oe(r)),0===s?0:0!==t&&t!==s&&0===(t&i)&&((i=s&-s)>=(r=t&-t)||32===i&&4194048&r)?t:s}function Pe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ae(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function De(){var e=Ee;return!(62914560&(Ee<<=1))&&(Ee=4194304),e}function Ne(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Me(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Re(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-_e(t);e.entangledLanes|=t,e.entanglements[n]=1073741824|e.entanglements[n]|261930&r}function Le(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-_e(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}function Ie(e,t){var r=t&-t;return 0!==((r=42&r?1:$e(r))&(e.suspendedLanes|t))?0:r}function $e(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Fe(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function ze(){var e=I.p;return 0!==e?e:void 0===(e=window.event)?32:jd(e.type)}function Be(e,t){var r=I.p;try{return I.p=e,t()}finally{I.p=r}}var Ue=Math.random().toString(36).slice(2),We="__reactFiber$"+Ue,Ve="__reactProps$"+Ue,He="__reactContainer$"+Ue,Ge="__reactEvents$"+Ue,Ye="__reactListeners$"+Ue,qe="__reactHandles$"+Ue,Xe="__reactResources$"+Ue,Ke="__reactMarker$"+Ue;function Je(e){delete e[We],delete e[Ve],delete e[Ge],delete e[Ye],delete e[qe]}function Qe(e){var t=e[We];if(t)return t;for(var r=e.parentNode;r;){if(t=r[He]||r[We]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=Fh(e);null!==e;){if(r=e[We])return r;e=Fh(e)}return t}r=(e=r).parentNode}return null}function Ze(e){if(e=e[We]||e[He]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function et(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(n(33))}function tt(e){var t=e[Xe];return t||(t=e[Xe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function rt(e){e[Ke]=!0}var nt=new Set,st={};function it(e,t){ot(e,t),ot(e+"Capture",t)}function ot(e,t){for(st[e]=t,e=0;e<t.length;e++)nt.add(t[e])}var at=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),lt={},ct={};function ut(e,t,r){if(s=t,ie.call(ct,s)||!ie.call(lt,s)&&(at.test(s)?ct[s]=!0:(lt[s]=!0,0)))if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var n=t.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void e.removeAttribute(t)}e.setAttribute(t,""+r)}var s}function ht(e,t,r){if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+r)}}function dt(e,t,r,n){if(null===n)e.removeAttribute(r);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(r)}e.setAttributeNS(t,r,""+n)}}function ft(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function pt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function gt(e){if(!e._valueTracker){var t=pt(e)?"checked":"value";e._valueTracker=function(e,t,r){var n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function mt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=pt(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function yt(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(Xa){return e.body}}var vt=/[\n"\\]/g;function bt(e){return e.replace(vt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function wt(e,t,r,n,s,i,o,a){e.name="",null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ft(t)):e.value!==""+ft(t)&&(e.value=""+ft(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?_t(e,o,ft(t)):null!=r?_t(e,o,ft(r)):null!=n&&e.removeAttribute("value"),null==s&&null!=i&&(e.defaultChecked=!!i),null!=s&&(e.checked=s&&"function"!=typeof s&&"symbol"!=typeof s),null!=a&&"function"!=typeof a&&"symbol"!=typeof a&&"boolean"!=typeof a?e.name=""+ft(a):e.removeAttribute("name")}function xt(e,t,r,n,s,i,o,a){if(null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.type=i),null!=t||null!=r){if(("submit"===i||"reset"===i)&&null==t)return void gt(e);r=null!=r?""+ft(r):"",t=null!=t?""+ft(t):r,a||t===e.value||(e.value=t),e.defaultValue=t}n="function"!=typeof(n=null!=n?n:s)&&"symbol"!=typeof n&&!!n,e.checked=a?e.checked:!!n,e.defaultChecked=!!n,null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.name=o),gt(e)}function _t(e,t,r){"number"===t&&yt(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function St(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ft(r),t=null,s=0;s<e.length;s++){if(e[s].value===r)return e[s].selected=!0,void(n&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function kt(e,t,r){null==t||((t=""+ft(t))!==e.value&&(e.value=t),null!=r)?e.defaultValue=null!=r?""+ft(r):"":e.defaultValue!==t&&(e.defaultValue=t)}function Ct(e,t,r,s){if(null==t){if(null!=s){if(null!=r)throw Error(n(92));if(R(s)){if(1<s.length)throw Error(n(93));s=s[0]}r=s}null==r&&(r=""),t=r}r=ft(t),e.defaultValue=r,(s=e.textContent)===r&&""!==s&&null!==s&&(e.value=s),gt(e)}function Tt(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var Et=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ot(e,t,r){var n=0===t.indexOf("--");null==r||"boolean"==typeof r||""===r?n?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":n?e.setProperty(t,r):"number"!=typeof r||0===r||Et.has(t)?"float"===t?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function jt(e,t,r){if(null!=t&&"object"!=typeof t)throw Error(n(62));if(e=e.style,null!=r){for(var s in r)!r.hasOwnProperty(s)||null!=t&&t.hasOwnProperty(s)||(0===s.indexOf("--")?e.setProperty(s,""):"float"===s?e.cssFloat="":e[s]="");for(var i in t)s=t[i],t.hasOwnProperty(i)&&r[i]!==s&&Ot(e,i,s)}else for(var o in t)t.hasOwnProperty(o)&&Ot(e,o,t[o])}function Pt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var At=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Dt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Nt(e){return Dt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Mt(){}var Rt=null;function Lt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var It=null,$t=null;function Ft(e){var t=Ze(e);if(t&&(e=t.stateNode)){var r=e[Ve]||null;e:switch(e=t.stateNode,t.type){case"input":if(wt(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+bt(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var i=s[Ve]||null;if(!i)throw Error(n(90));wt(s,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<r.length;t++)(s=r[t]).form===e.form&&mt(s)}break e;case"textarea":kt(e,r.value,r.defaultValue);break e;case"select":null!=(t=r.value)&&St(e,!!r.multiple,t,!1)}}}var zt=!1;function Bt(e,t,r){if(zt)return e(t,r);zt=!0;try{return e(t)}finally{if(zt=!1,(null!==It||null!==$t)&&(ru(),It&&(t=It,e=$t,$t=It=null,Ft(t),e)))for(t=0;t<e.length;t++)Ft(e[t])}}function Ut(e,t){var r=e.stateNode;if(null===r)return null;var s=r[Ve]||null;if(null===s)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(s=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!s;break e;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(n(231,t,typeof r));return r}var Wt=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Vt=!1;if(Wt)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){Vt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(Xa){Vt=!1}var Gt=null,Yt=null,qt=null;function Xt(){if(qt)return qt;var e,t,r=Yt,n=r.length,s="value"in Gt?Gt.value:Gt.textContent,i=s.length;for(e=0;e<n&&r[e]===s[e];e++);var o=n-e;for(t=1;t<=o&&r[n-t]===s[i-t];t++);return qt=s.slice(e,1<t?1-t:void 0)}function Kt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Jt(){return!0}function Qt(){return!1}function Zt(e){function t(t,r,n,s,i){for(var o in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=s,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?Jt:Qt,this.isPropagationStopped=Qt,this}return u(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Jt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Jt)},persist:function(){},isPersistent:Jt}),t}var er,tr,rr,nr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sr=Zt(nr),ir=u({},nr,{view:0,detail:0}),or=Zt(ir),ar=u({},ir,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==rr&&(rr&&"mousemove"===e.type?(er=e.screenX-rr.screenX,tr=e.screenY-rr.screenY):tr=er=0,rr=e),er)},movementY:function(e){return"movementY"in e?e.movementY:tr}}),lr=Zt(ar),cr=Zt(u({},ar,{dataTransfer:0})),ur=Zt(u({},ir,{relatedTarget:0})),hr=Zt(u({},nr,{animationName:0,elapsedTime:0,pseudoElement:0})),dr=Zt(u({},nr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),fr=Zt(u({},nr,{data:0})),pr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mr[e])&&!!t[e]}function vr(){return yr}var br=Zt(u({},ir,{key:function(e){if(e.key){var t=pr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Kt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?gr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vr,charCode:function(e){return"keypress"===e.type?Kt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Kt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),wr=Zt(u({},ar,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),xr=Zt(u({},ir,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vr})),_r=Zt(u({},nr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Sr=Zt(u({},ar,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),kr=Zt(u({},nr,{newState:0,oldState:0})),Cr=[9,13,27,32],Tr=Wt&&"CompositionEvent"in window,Er=null;Wt&&"documentMode"in document&&(Er=document.documentMode);var Or=Wt&&"TextEvent"in window&&!Er,jr=Wt&&(!Tr||Er&&8<Er&&11>=Er),Pr=String.fromCharCode(32),Ar=!1;function Dr(e,t){switch(e){case"keyup":return-1!==Cr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nr(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Mr=!1;var Rr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Rr[e.type]:"textarea"===t}function Ir(e,t,r,n){It?$t?$t.push(n):$t=[n]:It=n,0<(t=oh(t,"onChange")).length&&(r=new sr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var $r=null,Fr=null;function zr(e){Qu(e,0)}function Br(e){if(mt(et(e)))return e}function Ur(e,t){if("change"===e)return t}var Wr=!1;if(Wt){var Vr;if(Wt){var Hr="oninput"in document;if(!Hr){var Gr=document.createElement("div");Gr.setAttribute("oninput","return;"),Hr="function"==typeof Gr.oninput}Vr=Hr}else Vr=!1;Wr=Vr&&(!document.documentMode||9<document.documentMode)}function Yr(){$r&&($r.detachEvent("onpropertychange",qr),Fr=$r=null)}function qr(e){if("value"===e.propertyName&&Br(Fr)){var t=[];Ir(t,Fr,e,Lt(e)),Bt(zr,t)}}function Xr(e,t,r){"focusin"===e?(Yr(),Fr=r,($r=t).attachEvent("onpropertychange",qr)):"focusout"===e&&Yr()}function Kr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Br(Fr)}function Jr(e,t){if("click"===e)return Br(t)}function Qr(e,t){if("input"===e||"change"===e)return Br(t)}var Zr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function en(e,t){if(Zr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!ie.call(t,s)||!Zr(e[s],t[s]))return!1}return!0}function tn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function rn(e,t){var r,n=tn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=tn(n)}}function nn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function sn(e){for(var t=yt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=yt((e=t.contentWindow).document)}return t}function on(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var an=Wt&&"documentMode"in document&&11>=document.documentMode,ln=null,cn=null,un=null,hn=!1;function dn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;hn||null==ln||ln!==yt(n)||("selectionStart"in(n=ln)&&on(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},un&&en(un,n)||(un=n,0<(n=oh(cn,"onSelect")).length&&(t=new sr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ln)))}function fn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var pn={animationend:fn("Animation","AnimationEnd"),animationiteration:fn("Animation","AnimationIteration"),animationstart:fn("Animation","AnimationStart"),transitionrun:fn("Transition","TransitionRun"),transitionstart:fn("Transition","TransitionStart"),transitioncancel:fn("Transition","TransitionCancel"),transitionend:fn("Transition","TransitionEnd")},gn={},mn={};function yn(e){if(gn[e])return gn[e];if(!pn[e])return e;var t,r=pn[e];for(t in r)if(r.hasOwnProperty(t)&&t in mn)return gn[e]=r[t];return e}Wt&&(mn=document.createElement("div").style,"AnimationEvent"in window||(delete pn.animationend.animation,delete pn.animationiteration.animation,delete pn.animationstart.animation),"TransitionEvent"in window||delete pn.transitionend.transition);var vn=yn("animationend"),bn=yn("animationiteration"),wn=yn("animationstart"),xn=yn("transitionrun"),_n=yn("transitionstart"),Sn=yn("transitioncancel"),kn=yn("transitionend"),Cn=new Map,Tn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function En(e,t){Cn.set(e,t),it(t,[e])}Tn.push("scrollEnd");var On="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},jn=[],Pn=0,An=0;function Dn(){for(var e=Pn,t=An=Pn=0;t<e;){var r=jn[t];jn[t++]=null;var n=jn[t];jn[t++]=null;var s=jn[t];jn[t++]=null;var i=jn[t];if(jn[t++]=null,null!==n&&null!==s){var o=n.pending;null===o?s.next=s:(s.next=o.next,o.next=s),n.pending=s}0!==i&&Ln(r,s,i)}}function Nn(e,t,r,n){jn[Pn++]=e,jn[Pn++]=t,jn[Pn++]=r,jn[Pn++]=n,An|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function Mn(e,t,r,n){return Nn(e,t,r,n),In(e)}function Rn(e,t){return Nn(e,null,null,t),In(e)}function Ln(e,t,r){e.lanes|=r;var n=e.alternate;null!==n&&(n.lanes|=r);for(var s=!1,i=e.return;null!==i;)i.childLanes|=r,null!==(n=i.alternate)&&(n.childLanes|=r),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(s=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,s&&null!==t&&(s=31-_e(r),null===(n=(e=i.hiddenUpdates)[s])?e[s]=[t]:n.push(t),t.lane=536870912|r),i):null}function In(e){if(50<Yc)throw Yc=0,qc=null,Error(n(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var $n={};function Fn(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(e,t,r,n){return new Fn(e,t,r,n)}function Bn(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Un(e,t){var r=e.alternate;return null===r?((r=zn(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=65011712&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Wn(e,t){e.flags&=65011714;var r=e.alternate;return null===r?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Vn(e,t,r,s,i,o){var a=0;if(s=e,"function"==typeof e)Bn(e)&&(a=1);else if("string"==typeof e)a=function(e,t,r){if(1===r||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,r,G.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case O:return(e=zn(31,r,t,i)).elementType=O,e.lanes=o,e;case g:return Hn(r.children,i,o,t);case m:a=8,i|=24;break;case y:return(e=zn(12,r,t,2|i)).elementType=y,e.lanes=o,e;case S:return(e=zn(13,r,t,i)).elementType=S,e.lanes=o,e;case C:return(e=zn(19,r,t,i)).elementType=C,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case w:a=10;break e;case b:a=9;break e;case _:a=11;break e;case T:a=14;break e;case E:a=16,s=null;break e}a=29,r=Error(n(130,null===e?"null":typeof e,"")),s=null}return(t=zn(a,r,t,i)).elementType=e,t.type=s,t.lanes=o,t}function Hn(e,t,r,n){return(e=zn(7,e,n,t)).lanes=r,e}function Gn(e,t,r){return(e=zn(6,e,null,t)).lanes=r,e}function Yn(e){var t=zn(18,null,null,0);return t.stateNode=e,t}function qn(e,t,r){return(t=zn(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Xn=new WeakMap;function Kn(e,t){if("object"==typeof e&&null!==e){var r=Xn.get(e);return void 0!==r?r:(t={value:e,source:t,stack:se(t)},Xn.set(e,t),t)}return{value:e,source:t,stack:se(t)}}var Jn=[],Qn=0,Zn=null,es=0,ts=[],rs=0,ns=null,ss=1,is="";function os(e,t){Jn[Qn++]=es,Jn[Qn++]=Zn,Zn=e,es=t}function as(e,t,r){ts[rs++]=ss,ts[rs++]=is,ts[rs++]=ns,ns=e;var n=ss;e=is;var s=32-_e(n)-1;n&=~(1<<s),r+=1;var i=32-_e(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,ss=1<<32-_e(t)+s|r<<s|n,is=i+e}else ss=1<<i|r<<s|n,is=e}function ls(e){null!==e.return&&(os(e,1),as(e,1,0))}function cs(e){for(;e===Zn;)Zn=Jn[--Qn],Jn[Qn]=null,es=Jn[--Qn],Jn[Qn]=null;for(;e===ns;)ns=ts[--rs],ts[rs]=null,is=ts[--rs],ts[rs]=null,ss=ts[--rs],ts[rs]=null}function us(e,t){ts[rs++]=ss,ts[rs++]=is,ts[rs++]=ns,ss=t.id,is=t.overflow,ns=e}var hs=null,ds=null,fs=!1,ps=null,gs=!1,ms=Error(n(519));function ys(e){throw Ss(Kn(Error(n(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),ms}function vs(e){var t=e.stateNode,r=e.type,n=e.memoizedProps;switch(t[We]=e,t[Ve]=n,r){case"dialog":Zu("cancel",t),Zu("close",t);break;case"iframe":case"object":case"embed":Zu("load",t);break;case"video":case"audio":for(r=0;r<Ku.length;r++)Zu(Ku[r],t);break;case"source":Zu("error",t);break;case"img":case"image":case"link":Zu("error",t),Zu("load",t);break;case"details":Zu("toggle",t);break;case"input":Zu("invalid",t),xt(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0);break;case"select":Zu("invalid",t);break;case"textarea":Zu("invalid",t),Ct(t,n.value,n.defaultValue,n.children)}"string"!=typeof(r=n.children)&&"number"!=typeof r&&"bigint"!=typeof r||t.textContent===""+r||!0===n.suppressHydrationWarning||dh(t.textContent,r)?(null!=n.popover&&(Zu("beforetoggle",t),Zu("toggle",t)),null!=n.onScroll&&Zu("scroll",t),null!=n.onScrollEnd&&Zu("scrollend",t),null!=n.onClick&&(t.onclick=Mt),t=!0):t=!1,t||ys(e,!0)}function bs(e){for(hs=e.return;hs;)switch(hs.tag){case 5:case 31:case 13:return void(gs=!1);case 27:case 3:return void(gs=!0);default:hs=hs.return}}function ws(e){if(e!==hs)return!1;if(!fs)return bs(e),fs=!0,!1;var t,r=e.tag;if((t=3!==r&&27!==r)&&((t=5===r)&&(t=!("form"!==(t=e.type)&&"button"!==t)||_h(e.type,e.memoizedProps)),t=!t),t&&ds&&ys(e),bs(e),13===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(n(317));ds=$h(e)}else if(31===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(n(317));ds=$h(e)}else 27===r?(r=ds,jh(e.type)?(e=Ih,Ih=null,ds=e):ds=r):ds=hs?Lh(e.stateNode.nextSibling):null;return!0}function xs(){ds=hs=null,fs=!1}function _s(){var e=ps;return null!==e&&(null===Nc?Nc=e:Nc.push.apply(Nc,e),ps=null),e}function Ss(e){null===ps?ps=[e]:ps.push(e)}var ks=B(null),Cs=null,Ts=null;function Es(e,t,r){W(ks,t._currentValue),t._currentValue=r}function Os(e){e._currentValue=ks.current,U(ks)}function js(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ps(e,t,r,s){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var o=i.dependencies;if(null!==o){var a=i.child;o=o.firstContext;e:for(;null!==o;){var l=o;o=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),js(o.return,r,e),s||(a=null);break e}o=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(n(341));a.lanes|=r,null!==(o=a.alternate)&&(o.lanes|=r),js(a,r,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function As(e,t,r,s){e=null;for(var i=t,o=!1;null!==i;){if(!o)if(524288&i.flags)o=!0;else if(262144&i.flags)break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(n(387));if(null!==(a=a.memoizedProps)){var l=i.type;Zr(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===X.current){if(null===(a=i.alternate))throw Error(n(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(fd):e=[fd])}i=i.return}null!==e&&Ps(t,e,r,s),t.flags|=262144}function Ds(e){for(e=e.firstContext;null!==e;){if(!Zr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ns(e){Cs=e,Ts=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ms(e){return Ls(Cs,e)}function Rs(e,t){return null===Cs&&Ns(e),Ls(e,t)}function Ls(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},null===Ts){if(null===e)throw Error(n(308));Ts=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ts=Ts.next=t;return r}var Is="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},$s=e.unstable_scheduleCallback,Fs=e.unstable_NormalPriority,zs={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bs(){return{controller:new Is,data:new Map,refCount:0}}function Us(e){e.refCount--,0===e.refCount&&$s(Fs,function(){e.controller.abort()})}var Ws=null,Vs=0,Hs=0,Gs=null;function Ys(){if(0===--Vs&&null!==Ws){null!==Gs&&(Gs.status="fulfilled");var e=Ws;Ws=null,Hs=0,Gs=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var qs=L.S;L.S=function(e,t){Lc=ue(),"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Ws){var r=Ws=[];Vs=0,Hs=Hu(),Gs={status:"pending",value:void 0,then:function(e){r.push(e)}}}Vs++,t.then(Ys,Ys)}(0,t),null!==qs&&qs(e,t)};var Xs=B(null);function Ks(){var e=Xs.current;return null!==e?e:yc.pooledCache}function Js(e,t){W(Xs,null===t?Xs.current:t.pool)}function Qs(){var e=Ks();return null===e?null:{parent:zs._currentValue,pool:e}}var Zs=Error(n(460)),ei=Error(n(474)),ti=Error(n(542)),ri={then:function(){}};function ni(e){return"fulfilled"===(e=e.status)||"rejected"===e}function si(e,t,r){switch(void 0===(r=e[r])?e.push(t):r!==t&&(t.then(Mt,Mt),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw li(e=t.reason),e;default:if("string"==typeof t.status)t.then(Mt,Mt);else{if(null!==(e=yc)&&100<e.shellSuspendCounter)throw Error(n(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var r=t;r.status="fulfilled",r.value=e}},function(e){if("pending"===t.status){var r=t;r.status="rejected",r.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw li(e=t.reason),e}throw oi=t,Zs}}function ii(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"==typeof t&&"function"==typeof t.then)throw oi=t,Zs;throw t}}var oi=null;function ai(){if(null===oi)throw Error(n(459));var e=oi;return oi=null,e}function li(e){if(e===Zs||e===ti)throw Error(n(483))}var ci=null,ui=0;function hi(e){var t=ui;return ui+=1,null===ci&&(ci=[]),si(ci,e,t)}function di(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function fi(e,t){if(t.$$typeof===h)throw Error(n(525));throw e=Object.prototype.toString.call(t),Error(n(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function pi(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function s(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Un(e,t)).index=0,e.sibling=null,e}function o(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=67108866,r):n:(t.flags|=67108866,r):(t.flags|=1048576,r)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Gn(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function c(e,t,r,n){var s=r.type;return s===g?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===s||"object"==typeof s&&null!==s&&s.$$typeof===E&&ii(s)===t.type)?(di(t=i(t,r.props),r),t.return=e,t):(di(t=Vn(r.type,r.key,r.props,null,e.mode,n),r),t.return=e,t)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=qn(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function h(e,t,r,n,s){return null===t||7!==t.tag?((t=Hn(r,e.mode,n,s)).return=e,t):((t=i(t,r)).return=e,t)}function d(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Gn(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case f:return di(r=Vn(t.type,t.key,t.props,null,e.mode,r),t),r.return=e,r;case p:return(t=qn(t,e.mode,r)).return=e,t;case E:return d(e,t=ii(t),r)}if(R(t)||D(t))return(t=Hn(t,e.mode,r,null)).return=e,t;if("function"==typeof t.then)return d(e,hi(t),r);if(t.$$typeof===w)return d(e,Rs(e,t),r);fi(e,t)}return null}function m(e,t,r,n){var s=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return null!==s?null:l(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case f:return r.key===s?c(e,t,r,n):null;case p:return r.key===s?u(e,t,r,n):null;case E:return m(e,t,r=ii(r),n)}if(R(r)||D(r))return null!==s?null:h(e,t,r,n,null);if("function"==typeof r.then)return m(e,t,hi(r),n);if(r.$$typeof===w)return m(e,t,Rs(e,r),n);fi(e,r)}return null}function y(e,t,r,n,s){if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return l(t,e=e.get(r)||null,""+n,s);if("object"==typeof n&&null!==n){switch(n.$$typeof){case f:return c(t,e=e.get(null===n.key?r:n.key)||null,n,s);case p:return u(t,e=e.get(null===n.key?r:n.key)||null,n,s);case E:return y(e,t,r,n=ii(n),s)}if(R(n)||D(n))return h(t,e=e.get(r)||null,n,s,null);if("function"==typeof n.then)return y(e,t,r,hi(n),s);if(n.$$typeof===w)return y(e,t,r,Rs(t,n),s);fi(t,n)}return null}function v(l,c,u,h){if("object"==typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case f:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===g){if(7===c.tag){r(l,c.sibling),(h=i(c,u.props.children)).return=l,l=h;break e}}else if(c.elementType===b||"object"==typeof b&&null!==b&&b.$$typeof===E&&ii(b)===c.type){r(l,c.sibling),di(h=i(c,u.props),u),h.return=l,l=h;break e}r(l,c);break}t(l,c),c=c.sibling}u.type===g?((h=Hn(u.props.children,l.mode,h,u.key)).return=l,l=h):(di(h=Vn(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return a(l);case p:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){r(l,c.sibling),(h=i(c,u.children||[])).return=l,l=h;break e}r(l,c);break}t(l,c),c=c.sibling}(h=qn(u,l.mode,h)).return=l,l=h}return a(l);case E:return v(l,c,u=ii(u),h)}if(R(u))return function(n,i,a,l){for(var c=null,u=null,h=i,f=i=0,p=null;null!==h&&f<a.length;f++){h.index>f?(p=h,h=null):p=h.sibling;var g=m(n,h,a[f],l);if(null===g){null===h&&(h=p);break}e&&h&&null===g.alternate&&t(n,h),i=o(g,i,f),null===u?c=g:u.sibling=g,u=g,h=p}if(f===a.length)return r(n,h),fs&&os(n,f),c;if(null===h){for(;f<a.length;f++)null!==(h=d(n,a[f],l))&&(i=o(h,i,f),null===u?c=h:u.sibling=h,u=h);return fs&&os(n,f),c}for(h=s(h);f<a.length;f++)null!==(p=y(h,n,f,a[f],l))&&(e&&null!==p.alternate&&h.delete(null===p.key?f:p.key),i=o(p,i,f),null===u?c=p:u.sibling=p,u=p);return e&&h.forEach(function(e){return t(n,e)}),fs&&os(n,f),c}(l,c,u,h);if(D(u)){if("function"!=typeof(b=D(u)))throw Error(n(150));return function(i,a,l,c){if(null==l)throw Error(n(151));for(var u=null,h=null,f=a,p=a=0,g=null,v=l.next();null!==f&&!v.done;p++,v=l.next()){f.index>p?(g=f,f=null):g=f.sibling;var b=m(i,f,v.value,c);if(null===b){null===f&&(f=g);break}e&&f&&null===b.alternate&&t(i,f),a=o(b,a,p),null===h?u=b:h.sibling=b,h=b,f=g}if(v.done)return r(i,f),fs&&os(i,p),u;if(null===f){for(;!v.done;p++,v=l.next())null!==(v=d(i,v.value,c))&&(a=o(v,a,p),null===h?u=v:h.sibling=v,h=v);return fs&&os(i,p),u}for(f=s(f);!v.done;p++,v=l.next())null!==(v=y(f,i,p,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?p:v.key),a=o(v,a,p),null===h?u=v:h.sibling=v,h=v);return e&&f.forEach(function(e){return t(i,e)}),fs&&os(i,p),u}(l,c,u=b.call(u),h)}if("function"==typeof u.then)return v(l,c,hi(u),h);if(u.$$typeof===w)return v(l,c,Rs(l,u),h);fi(l,u)}return"string"==typeof u&&""!==u||"number"==typeof u||"bigint"==typeof u?(u=""+u,null!==c&&6===c.tag?(r(l,c.sibling),(h=i(c,u)).return=l,l=h):(r(l,c),(h=Gn(u,l.mode,h)).return=l,l=h),a(l)):r(l,c)}return function(e,t,r,n){try{ui=0;var s=v(e,t,r,n);return ci=null,s}catch(o){if(o===Zs||o===ti)throw o;var i=zn(29,o,null,e.mode);return i.lanes=n,i.return=e,i}}}var gi=pi(!0),mi=pi(!1),yi=!1;function vi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function wi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function xi(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,2&mc){var s=n.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),n.pending=t,t=In(e),Ln(e,null,r),t}return Nn(e,n,t,r),In(e)}function _i(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Le(e,r)}}function Si(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var s=null,i=null;if(null!==(r=r.firstBaseUpdate)){do{var o={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};null===i?s=i=o:i=i.next=o,r=r.next}while(null!==r);null===i?s=i=t:i=i.next=t}else s=i=t;return r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,callbacks:n.callbacks},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var ki=!1;function Ci(){if(ki){if(null!==Gs)throw Gs}}function Ti(e,t,r,n){ki=!1;var s=e.updateQueue;yi=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(null!==a){s.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?i=c:o.next=c,o=l;var h=e.alternate;null!==h&&((a=(h=h.updateQueue).lastBaseUpdate)!==o&&(null===a?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(null!==i){var d=s.baseState;for(o=0,h=c=l=null,a=i;;){var f=-536870913&a.lane,p=f!==a.lane;if(p?(bc&f)===f:(n&f)===f){0!==f&&f===Hs&&(ki=!0),null!==h&&(h=h.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var g=e,m=a;f=t;var y=r;switch(m.tag){case 1:if("function"==typeof(g=m.payload)){d=g.call(y,d,f);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null==(f="function"==typeof(g=m.payload)?g.call(y,d,f):g))break e;d=u({},d,f);break e;case 2:yi=!0}}null!==(f=a.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=s.callbacks)?s.callbacks=[f]:p.push(f))}else p={lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===h?(c=h=p,l=d):h=h.next=p,o|=f;if(null===(a=a.next)){if(null===(a=s.shared.pending))break;a=(p=a).next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}null===h&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=h,null===i&&(s.shared.lanes=0),Ec|=o,e.lanes=o,e.memoizedState=d}}function Ei(e,t){if("function"!=typeof e)throw Error(n(191,e));e.call(t)}function Oi(e,t){var r=e.callbacks;if(null!==r)for(e.callbacks=null,e=0;e<r.length;e++)Ei(r[e],t)}var ji=B(null),Pi=B(0);function Ai(e,t){W(Pi,e=Cc),W(ji,t),Cc=e|t.baseLanes}function Di(){W(Pi,Cc),W(ji,ji.current)}function Ni(){Cc=Pi.current,U(ji),U(Pi)}var Mi=B(null),Ri=null;function Li(e){var t=e.alternate;W(Bi,1&Bi.current),W(Mi,e),null===Ri&&(null===t||null!==ji.current||null!==t.memoizedState)&&(Ri=e)}function Ii(e){W(Bi,Bi.current),W(Mi,e),null===Ri&&(Ri=e)}function $i(e){22===e.tag?(W(Bi,Bi.current),W(Mi,e),null===Ri&&(Ri=e)):Fi()}function Fi(){W(Bi,Bi.current),W(Mi,Mi.current)}function zi(e){U(Mi),Ri===e&&(Ri=null),U(Bi)}var Bi=B(0);function Ui(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||Mh(r)||Rh(r)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(128&t.flags)return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Wi=0,Vi=null,Hi=null,Gi=null,Yi=!1,qi=!1,Xi=!1,Ki=0,Ji=0,Qi=null,Zi=0;function eo(){throw Error(n(321))}function to(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Zr(e[r],t[r]))return!1;return!0}function ro(e,t,r,n,s,i){return Wi=i,Vi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,L.H=null===e||null===e.memoizedState?va:ba,Xi=!1,i=r(n,s),Xi=!1,qi&&(i=so(t,r,n,s)),no(e),i}function no(e){L.H=ya;var t=null!==Hi&&null!==Hi.next;if(Wi=0,Gi=Hi=Vi=null,Yi=!1,Ji=0,Qi=null,t)throw Error(n(300));null===e||Ra||null!==(e=e.dependencies)&&Ds(e)&&(Ra=!0)}function so(e,t,r,s){Vi=e;var i=0;do{if(qi&&(Qi=null),Ji=0,qi=!1,25<=i)throw Error(n(301));if(i+=1,Gi=Hi=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}L.H=wa,o=t(r,s)}while(qi);return o}function io(){var e=L.H,t=e.useState()[0];return t="function"==typeof t.then?ho(t):t,e=e.useState()[0],(null!==Hi?Hi.memoizedState:null)!==e&&(Vi.flags|=1024),t}function oo(){var e=0!==Ki;return Ki=0,e}function ao(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function lo(e){if(Yi){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Yi=!1}Wi=0,Gi=Hi=Vi=null,qi=!1,Ji=Ki=0,Qi=null}function co(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Gi?Vi.memoizedState=Gi=e:Gi=Gi.next=e,Gi}function uo(){if(null===Hi){var e=Vi.alternate;e=null!==e?e.memoizedState:null}else e=Hi.next;var t=null===Gi?Vi.memoizedState:Gi.next;if(null!==t)Gi=t,Hi=e;else{if(null===e){if(null===Vi.alternate)throw Error(n(467));throw Error(n(310))}e={memoizedState:(Hi=e).memoizedState,baseState:Hi.baseState,baseQueue:Hi.baseQueue,queue:Hi.queue,next:null},null===Gi?Vi.memoizedState=Gi=e:Gi=Gi.next=e}return Gi}function ho(e){var t=Ji;return Ji+=1,null===Qi&&(Qi=[]),e=si(Qi,e,t),t=Vi,null===(null===Gi?t.memoizedState:Gi.next)&&(t=t.alternate,L.H=null===t||null===t.memoizedState?va:ba),e}function fo(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return ho(e);if(e.$$typeof===w)return Ms(e)}throw Error(n(438,String(e)))}function po(e){var t=null,r=Vi.updateQueue;if(null!==r&&(t=r.memoCache),null==t){var n=Vi.alternate;null!==n&&(null!==(n=n.updateQueue)&&(null!=(n=n.memoCache)&&(t={data:n.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===r&&(r={lastEffect:null,events:null,stores:null,memoCache:null},Vi.updateQueue=r),r.memoCache=t,void 0===(r=t.data[t.index]))for(r=t.data[t.index]=Array(e),n=0;n<e;n++)r[n]=P;return t.index++,r}function go(e,t){return"function"==typeof t?t(e):t}function mo(e){return yo(uo(),Hi,e)}function yo(e,t,r){var s=e.queue;if(null===s)throw Error(n(311));s.lastRenderedReducer=r;var i=e.baseQueue,o=s.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}t.baseQueue=i=o,s.pending=null}if(o=e.baseState,null===i)e.memoizedState=o;else{var l=a=null,c=null,u=t=i.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(bc&d)===d:(Wi&d)===d){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Hs&&(h=!0);else{if((Wi&f)===f){u=u.next,f===Hs&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,a=o):c=c.next=d,Vi.lanes|=f,Ec|=f}d=u.action,Xi&&r(o,d),o=u.hasEagerState?u.eagerState:r(o,d)}else f={lane:d,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,a=o):c=c.next=f,Vi.lanes|=d,Ec|=d;u=u.next}while(null!==u&&u!==t);if(null===c?a=o:c.next=l,!Zr(o,e.memoizedState)&&(Ra=!0,h&&null!==(r=Gs)))throw r;e.memoizedState=o,e.baseState=a,e.baseQueue=c,s.lastRenderedState=o}return null===i&&(s.lanes=0),[e.memoizedState,s.dispatch]}function vo(e){var t=uo(),r=t.queue;if(null===r)throw Error(n(311));r.lastRenderedReducer=e;var s=r.dispatch,i=r.pending,o=t.memoizedState;if(null!==i){r.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);Zr(o,t.memoizedState)||(Ra=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),r.lastRenderedState=o}return[o,s]}function bo(e,t,r){var s=Vi,i=uo(),o=fs;if(o){if(void 0===r)throw Error(n(407));r=r()}else r=t();var a=!Zr((Hi||i).memoizedState,r);if(a&&(i.memoizedState=r,Ra=!0),i=i.queue,Vo(_o.bind(null,s,i,e),[e]),i.getSnapshot!==t||a||null!==Gi&&1&Gi.memoizedState.tag){if(s.flags|=2048,Fo(9,{destroy:void 0},xo.bind(null,s,i,r,t),null),null===yc)throw Error(n(349));o||127&Wi||wo(s,t,r)}return r}function wo(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=Vi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Vi.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function xo(e,t,r,n){t.value=r,t.getSnapshot=n,So(t)&&ko(e)}function _o(e,t,r){return r(function(){So(t)&&ko(e)})}function So(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Zr(e,r)}catch(n){return!0}}function ko(e){var t=Rn(e,2);null!==t&&Jc(t,e,2)}function Co(e){var t=co();if("function"==typeof e){var r=e;if(e=r(),Xi){xe(!0);try{r()}finally{xe(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:e},t}function To(e,t,r,n){return e.baseState=r,yo(e,Hi,"function"==typeof n?n:go)}function Eo(e,t,r,s,i){if(pa(e))throw Error(n(485));if(null!==(e=t.action)){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==L.T?r(!0):o.isTransition=!1,s(o),null===(r=t.pending)?(o.next=t.pending=o,Oo(t,o)):(o.next=r.next,t.pending=r.next=o)}}function Oo(e,t){var r=t.action,n=t.payload,s=e.state;if(t.isTransition){var i=L.T,o={};L.T=o;try{var a=r(s,n),l=L.S;null!==l&&l(o,a),jo(e,t,a)}catch(c){Ao(e,t,c)}finally{null!==i&&null!==o.types&&(i.types=o.types),L.T=i}}else try{jo(e,t,i=r(s,n))}catch(u){Ao(e,t,u)}}function jo(e,t,r){null!==r&&"object"==typeof r&&"function"==typeof r.then?r.then(function(r){Po(e,t,r)},function(r){return Ao(e,t,r)}):Po(e,t,r)}function Po(e,t,r){t.status="fulfilled",t.value=r,Do(t),e.state=r,null!==(t=e.pending)&&((r=t.next)===t?e.pending=null:(r=r.next,t.next=r,Oo(e,r)))}function Ao(e,t,r){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do{t.status="rejected",t.reason=r,Do(t),t=t.next}while(t!==n)}e.action=null}function Do(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function No(e,t){return t}function Mo(e,t){if(fs){var r=yc.formState;if(null!==r){e:{var n=Vi;if(fs){if(ds){t:{for(var s=ds,i=gs;8!==s.nodeType;){if(!i){s=null;break t}if(null===(s=Lh(s.nextSibling))){s=null;break t}}s="F!"===(i=s.data)||"F"===i?s:null}if(s){ds=Lh(s.nextSibling),n="F!"===s.data;break e}}ys(n)}n=!1}n&&(t=r[0])}}return(r=co()).memoizedState=r.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:No,lastRenderedState:t},r.queue=n,r=ha.bind(null,Vi,n),n.dispatch=r,n=Co(!1),i=fa.bind(null,Vi,!1,n.queue),s={state:t,dispatch:null,action:e,pending:null},(n=co()).queue=s,r=Eo.bind(null,Vi,s,i,r),s.dispatch=r,n.memoizedState=e,[t,r,!1]}function Ro(e){return Lo(uo(),Hi,e)}function Lo(e,t,r){if(t=yo(e,t,No)[0],e=mo(go)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var n=ho(t)}catch(o){if(o===Zs)throw ti;throw o}else n=t;var s=(t=uo()).queue,i=s.dispatch;return r!==t.memoizedState&&(Vi.flags|=2048,Fo(9,{destroy:void 0},Io.bind(null,s,r),null)),[n,i,e]}function Io(e,t){e.action=t}function $o(e){var t=uo(),r=Hi;if(null!==r)return Lo(t,r,e);uo(),t=t.memoizedState;var n=(r=uo()).queue.dispatch;return r.memoizedState=e,[t,n,!1]}function Fo(e,t,r,n){return e={tag:e,create:r,deps:n,inst:t,next:null},null===(t=Vi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Vi.updateQueue=t),null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function zo(){return uo().memoizedState}function Bo(e,t,r,n){var s=co();Vi.flags|=e,s.memoizedState=Fo(1|t,{destroy:void 0},r,void 0===n?null:n)}function Uo(e,t,r,n){var s=uo();n=void 0===n?null:n;var i=s.memoizedState.inst;null!==Hi&&null!==n&&to(n,Hi.memoizedState.deps)?s.memoizedState=Fo(t,i,r,n):(Vi.flags|=e,s.memoizedState=Fo(1|t,i,r,n))}function Wo(e,t){Bo(8390656,8,e,t)}function Vo(e,t){Uo(2048,8,e,t)}function Ho(e){var t=uo().memoizedState;return function(e){Vi.flags|=4;var t=Vi.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Vi.updateQueue=t,t.events=[e];else{var r=t.events;null===r?t.events=[e]:r.push(e)}}({ref:t,nextImpl:e}),function(){if(2&mc)throw Error(n(440));return t.impl.apply(void 0,arguments)}}function Go(e,t){return Uo(4,2,e,t)}function Yo(e,t){return Uo(4,4,e,t)}function qo(e,t){if("function"==typeof t){e=e();var r=t(e);return function(){"function"==typeof r?r():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Xo(e,t,r){r=null!=r?r.concat([e]):null,Uo(4,4,qo.bind(null,t,e),r)}function Ko(){}function Jo(e,t){var r=uo();t=void 0===t?null:t;var n=r.memoizedState;return null!==t&&to(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Qo(e,t){var r=uo();t=void 0===t?null:t;var n=r.memoizedState;if(null!==t&&to(t,n[1]))return n[0];if(n=e(),Xi){xe(!0);try{e()}finally{xe(!1)}}return r.memoizedState=[n,t],n}function Zo(e,t,r){return void 0===r||1073741824&Wi&&!(261930&bc)?e.memoizedState=t:(e.memoizedState=r,e=Kc(),Vi.lanes|=e,Ec|=e,r)}function ea(e,t,r,n){return Zr(r,t)?r:null!==ji.current?(e=Zo(e,r,n),Zr(e,t)||(Ra=!0),e):42&Wi&&(!(1073741824&Wi)||261930&bc)?(e=Kc(),Vi.lanes|=e,Ec|=e,t):(Ra=!0,e.memoizedState=r)}function ta(e,t,r,n,s){var i=I.p;I.p=0!==i&&8>i?i:8;var o,a,l,c=L.T,u={};L.T=u,fa(e,!1,t,r);try{var h=s(),d=L.S;if(null!==d&&d(u,h),null!==h&&"object"==typeof h&&"function"==typeof h.then)da(e,t,(o=n,a=[],l={status:"pending",value:null,reason:null,then:function(e){a.push(e)}},h.then(function(){l.status="fulfilled",l.value=o;for(var e=0;e<a.length;e++)(0,a[e])(o)},function(e){for(l.status="rejected",l.reason=e,e=0;e<a.length;e++)(0,a[e])(void 0)}),l),Xc());else da(e,t,n,Xc())}catch(f){da(e,t,{then:function(){},status:"rejected",reason:f},Xc())}finally{I.p=i,null!==c&&null!==u.types&&(c.types=u.types),L.T=c}}function ra(){}function na(e,t,r,s){if(5!==e.tag)throw Error(n(476));var i=sa(e).queue;ta(e,i,t,$,null===r?ra:function(){return ia(e),r(s)})}function sa(e){var t=e.memoizedState;if(null!==t)return t;var r={};return(t={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:$},next:null}).next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:r},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ia(e){var t=sa(e);null===t.next&&(t=e.alternate.memoizedState),da(e,t.next.queue,{},Xc())}function oa(){return Ms(fd)}function aa(){return uo().memoizedState}function la(){return uo().memoizedState}function ca(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var r=Xc(),n=xi(t,e=wi(r),r);return null!==n&&(Jc(n,t,r),_i(n,t,r)),t={cache:Bs()},void(e.payload=t)}t=t.return}}function ua(e,t,r){var n=Xc();r={lane:n,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},pa(e)?ga(t,r):null!==(r=Mn(e,t,r,n))&&(Jc(r,e,n),ma(r,t,n))}function ha(e,t,r){da(e,t,r,Xc())}function da(e,t,r,n){var s={lane:n,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(pa(e))ga(t,s);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=i(o,r);if(s.hasEagerState=!0,s.eagerState=a,Zr(a,o))return Nn(e,t,s,0),null===yc&&Dn(),!1}catch(l){}if(null!==(r=Mn(e,t,s,n)))return Jc(r,e,n),ma(r,t,n),!0}return!1}function fa(e,t,r,s){if(s={lane:2,revertLane:Hu(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},pa(e)){if(t)throw Error(n(479))}else null!==(t=Mn(e,r,s,2))&&Jc(t,e,2)}function pa(e){var t=e.alternate;return e===Vi||null!==t&&t===Vi}function ga(e,t){qi=Yi=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function ma(e,t,r){if(4194048&r){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Le(e,r)}}var ya={readContext:Ms,use:fo,useCallback:eo,useContext:eo,useEffect:eo,useImperativeHandle:eo,useLayoutEffect:eo,useInsertionEffect:eo,useMemo:eo,useReducer:eo,useRef:eo,useState:eo,useDebugValue:eo,useDeferredValue:eo,useTransition:eo,useSyncExternalStore:eo,useId:eo,useHostTransitionStatus:eo,useFormState:eo,useActionState:eo,useOptimistic:eo,useMemoCache:eo,useCacheRefresh:eo};ya.useEffectEvent=eo;var va={readContext:Ms,use:fo,useCallback:function(e,t){return co().memoizedState=[e,void 0===t?null:t],e},useContext:Ms,useEffect:Wo,useImperativeHandle:function(e,t,r){r=null!=r?r.concat([e]):null,Bo(4194308,4,qo.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Bo(4194308,4,e,t)},useInsertionEffect:function(e,t){Bo(4,2,e,t)},useMemo:function(e,t){var r=co();t=void 0===t?null:t;var n=e();if(Xi){xe(!0);try{e()}finally{xe(!1)}}return r.memoizedState=[n,t],n},useReducer:function(e,t,r){var n=co();if(void 0!==r){var s=r(t);if(Xi){xe(!0);try{r(t)}finally{xe(!1)}}}else s=t;return n.memoizedState=n.baseState=s,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},n.queue=e,e=e.dispatch=ua.bind(null,Vi,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},co().memoizedState=e},useState:function(e){var t=(e=Co(e)).queue,r=ha.bind(null,Vi,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Ko,useDeferredValue:function(e,t){return Zo(co(),e,t)},useTransition:function(){var e=Co(!1);return e=ta.bind(null,Vi,e.queue,!0,!1),co().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var s=Vi,i=co();if(fs){if(void 0===r)throw Error(n(407));r=r()}else{if(r=t(),null===yc)throw Error(n(349));127&bc||wo(s,t,r)}i.memoizedState=r;var o={value:r,getSnapshot:t};return i.queue=o,Wo(_o.bind(null,s,o,e),[e]),s.flags|=2048,Fo(9,{destroy:void 0},xo.bind(null,s,o,r,t),null),r},useId:function(){var e=co(),t=yc.identifierPrefix;if(fs){var r=is;t="_"+t+"R_"+(r=(ss&~(1<<32-_e(ss)-1)).toString(32)+r),0<(r=Ki++)&&(t+="H"+r.toString(32)),t+="_"}else t="_"+t+"r_"+(r=Zi++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:oa,useFormState:Mo,useActionState:Mo,useOptimistic:function(e){var t=co();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=fa.bind(null,Vi,!0,r),r.dispatch=t,[e,t]},useMemoCache:po,useCacheRefresh:function(){return co().memoizedState=ca.bind(null,Vi)},useEffectEvent:function(e){var t=co(),r={impl:e};return t.memoizedState=r,function(){if(2&mc)throw Error(n(440));return r.impl.apply(void 0,arguments)}}},ba={readContext:Ms,use:fo,useCallback:Jo,useContext:Ms,useEffect:Vo,useImperativeHandle:Xo,useInsertionEffect:Go,useLayoutEffect:Yo,useMemo:Qo,useReducer:mo,useRef:zo,useState:function(){return mo(go)},useDebugValue:Ko,useDeferredValue:function(e,t){return ea(uo(),Hi.memoizedState,e,t)},useTransition:function(){var e=mo(go)[0],t=uo().memoizedState;return["boolean"==typeof e?e:ho(e),t]},useSyncExternalStore:bo,useId:aa,useHostTransitionStatus:oa,useFormState:Ro,useActionState:Ro,useOptimistic:function(e,t){return To(uo(),0,e,t)},useMemoCache:po,useCacheRefresh:la};ba.useEffectEvent=Ho;var wa={readContext:Ms,use:fo,useCallback:Jo,useContext:Ms,useEffect:Vo,useImperativeHandle:Xo,useInsertionEffect:Go,useLayoutEffect:Yo,useMemo:Qo,useReducer:vo,useRef:zo,useState:function(){return vo(go)},useDebugValue:Ko,useDeferredValue:function(e,t){var r=uo();return null===Hi?Zo(r,e,t):ea(r,Hi.memoizedState,e,t)},useTransition:function(){var e=vo(go)[0],t=uo().memoizedState;return["boolean"==typeof e?e:ho(e),t]},useSyncExternalStore:bo,useId:aa,useHostTransitionStatus:oa,useFormState:$o,useActionState:$o,useOptimistic:function(e,t){var r=uo();return null!==Hi?To(r,0,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:po,useCacheRefresh:la};function xa(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:u({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}wa.useEffectEvent=Ho;var _a={enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Xc(),s=wi(n);s.payload=t,null!=r&&(s.callback=r),null!==(t=xi(e,s,n))&&(Jc(t,e,n),_i(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Xc(),s=wi(n);s.tag=1,s.payload=t,null!=r&&(s.callback=r),null!==(t=xi(e,s,n))&&(Jc(t,e,n),_i(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Xc(),n=wi(r);n.tag=2,null!=t&&(n.callback=t),null!==(t=xi(e,n,r))&&(Jc(t,e,r),_i(t,e,r))}};function Sa(e,t,r,n,s,i,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!en(r,n)||!en(s,i))}function ka(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&_a.enqueueReplaceState(t,t.state,null)}function Ca(e,t){var r=t;if("ref"in t)for(var n in r={},t)"ref"!==n&&(r[n]=t[n]);if(e=e.defaultProps)for(var s in r===t&&(r=u({},r)),e)void 0===r[s]&&(r[s]=e[s]);return r}function Ta(e){On(e)}function Ea(e){console.error(e)}function Oa(e){On(e)}function ja(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function Pa(e,t,r){try{(0,e.onCaughtError)(r.value,{componentStack:r.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function Aa(e,t,r){return(r=wi(r)).tag=3,r.payload={element:null},r.callback=function(){ja(e,t)},r}function Da(e){return(e=wi(e)).tag=3,e}function Na(e,t,r,n){var s=r.type.getDerivedStateFromError;if("function"==typeof s){var i=n.value;e.payload=function(){return s(i)},e.callback=function(){Pa(t,r,n)}}var o=r.stateNode;null!==o&&"function"==typeof o.componentDidCatch&&(e.callback=function(){Pa(t,r,n),"function"!=typeof s&&(null===Fc?Fc=new Set([this]):Fc.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}var Ma=Error(n(461)),Ra=!1;function La(e,t,r,n){t.child=null===e?mi(t,null,r,n):gi(t,e.child,r,n)}function Ia(e,t,r,n,s){r=r.render;var i=t.ref;if("ref"in n){var o={};for(var a in n)"ref"!==a&&(o[a]=n[a])}else o=n;return Ns(t),n=ro(e,t,r,o,i,s),a=oo(),null===e||Ra?(fs&&a&&ls(t),t.flags|=1,La(e,t,n,s),t.child):(ao(e,t,s),al(e,t,s))}function $a(e,t,r,n,s){if(null===e){var i=r.type;return"function"!=typeof i||Bn(i)||void 0!==i.defaultProps||null!==r.compare?((e=Vn(r.type,null,n,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Fa(e,t,i,n,s))}if(i=e.child,!ll(e,s)){var o=i.memoizedProps;if((r=null!==(r=r.compare)?r:en)(o,n)&&e.ref===t.ref)return al(e,t,s)}return t.flags|=1,(e=Un(i,n)).ref=t.ref,e.return=t,t.child=e}function Fa(e,t,r,n,s){if(null!==e){var i=e.memoizedProps;if(en(i,n)&&e.ref===t.ref){if(Ra=!1,t.pendingProps=n=i,!ll(e,s))return t.lanes=e.lanes,al(e,t,s);131072&e.flags&&(Ra=!0)}}return Ga(e,t,r,n,s)}function za(e,t,r,n){var s=n.children,i=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===n.mode){if(128&t.flags){if(i=null!==i?i.baseLanes|r:r,null!==e){for(n=t.child=e.child,s=0;null!==n;)s=s|n.lanes|n.childLanes,n=n.sibling;n=s&~i}else n=0,t.child=null;return Ua(e,t,i,r,n)}if(!(536870912&r))return n=t.lanes=536870912,Ua(e,t,null!==i?i.baseLanes|r:r,r,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Js(0,null!==i?i.cachePool:null),null!==i?Ai(t,i):Di(),$i(t)}else null!==i?(Js(0,i.cachePool),Ai(t,i),Fi(),t.memoizedState=null):(null!==e&&Js(0,null),Di(),Fi());return La(e,t,s,r),t.child}function Ba(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Ua(e,t,r,n,s){var i=Ks();return i=null===i?null:{parent:zs._currentValue,pool:i},t.memoizedState={baseLanes:r,cachePool:i},null!==e&&Js(0,null),Di(),$i(t),null!==e&&As(e,t,n,!0),t.childLanes=s,null}function Wa(e,t){return(t=rl({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Va(e,t,r){return gi(t,e.child,null,r),(e=Wa(t,t.pendingProps)).flags|=2,zi(t),t.memoizedState=null,e}function Ha(e,t){var r=t.ref;if(null===r)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof r&&"object"!=typeof r)throw Error(n(284));null!==e&&e.ref===r||(t.flags|=4194816)}}function Ga(e,t,r,n,s){return Ns(t),r=ro(e,t,r,n,void 0,s),n=oo(),null===e||Ra?(fs&&n&&ls(t),t.flags|=1,La(e,t,r,s),t.child):(ao(e,t,s),al(e,t,s))}function Ya(e,t,r,n,s,i){return Ns(t),t.updateQueue=null,r=so(t,n,r,s),no(e),n=oo(),null===e||Ra?(fs&&n&&ls(t),t.flags|=1,La(e,t,r,i),t.child):(ao(e,t,i),al(e,t,i))}function qa(e,t,r,n,s){if(Ns(t),null===t.stateNode){var i=$n,o=r.contextType;"object"==typeof o&&null!==o&&(i=Ms(o)),i=new r(n,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=_a,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=n,i.state=t.memoizedState,i.refs={},vi(t),o=r.contextType,i.context="object"==typeof o&&null!==o?Ms(o):$n,i.state=t.memoizedState,"function"==typeof(o=r.getDerivedStateFromProps)&&(xa(t,r,o,n),i.state=t.memoizedState),"function"==typeof r.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(o=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),o!==i.state&&_a.enqueueReplaceState(i,i.state,null),Ti(t,n,i,s),Ci(),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){i=t.stateNode;var a=t.memoizedProps,l=Ca(r,a);i.props=l;var c=i.context,u=r.contextType;o=$n,"object"==typeof u&&null!==u&&(o=Ms(u));var h=r.getDerivedStateFromProps;u="function"==typeof h||"function"==typeof i.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(a||c!==o)&&ka(t,i,n,o),yi=!1;var d=t.memoizedState;i.state=d,Ti(t,n,i,s),Ci(),c=t.memoizedState,a||d!==c||yi?("function"==typeof h&&(xa(t,r,h,n),c=t.memoizedState),(l=yi||Sa(t,r,l,n,d,c,o))?(u||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=o,n=l):("function"==typeof i.componentDidMount&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,bi(e,t),u=Ca(r,o=t.memoizedProps),i.props=u,h=t.pendingProps,d=i.context,c=r.contextType,l=$n,"object"==typeof c&&null!==c&&(l=Ms(c)),(c="function"==typeof(a=r.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(o!==h||d!==l)&&ka(t,i,n,l),yi=!1,d=t.memoizedState,i.state=d,Ti(t,n,i,s),Ci();var f=t.memoizedState;o!==h||d!==f||yi||null!==e&&null!==e.dependencies&&Ds(e.dependencies)?("function"==typeof a&&(xa(t,r,a,n),f=t.memoizedState),(u=yi||Sa(t,r,u,n,d,f,l)||null!==e&&null!==e.dependencies&&Ds(e.dependencies))?(c||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(n,f,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(n,f,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),i.props=n,i.state=f,i.context=l,n=u):("function"!=typeof i.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return i=n,Ha(e,t),n=!!(128&t.flags),i||n?(i=t.stateNode,r=n&&"function"!=typeof r.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&n?(t.child=gi(t,e.child,null,s),t.child=gi(t,null,r,s)):La(e,t,r,s),t.memoizedState=i.state,e=t.child):e=al(e,t,s),e}function Ka(e,t,r,n){return xs(),t.flags|=256,La(e,t,r,n),t.child}var Ja={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qa(e){return{baseLanes:e,cachePool:Qs()}}function Za(e,t,r){return e=null!==e?e.childLanes&~r:0,t&&(e|=Pc),e}function el(e,t,r){var s,i=t.pendingProps,o=!1,a=!!(128&t.flags);if((s=a)||(s=(null===e||null!==e.memoizedState)&&!!(2&Bi.current)),s&&(o=!0,t.flags&=-129),s=!!(32&t.flags),t.flags&=-33,null===e){if(fs){if(o?Li(t):Fi(),(e=ds)?null!==(e=null!==(e=Nh(e,gs))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ns?{id:ss,overflow:is}:null,retryLane:536870912,hydrationErrors:null},(r=Yn(e)).return=t,t.child=r,hs=t,ds=null):e=null,null===e)throw ys(t);return Rh(e)?t.lanes=32:t.lanes=536870912,null}var l=i.children;return i=i.fallback,o?(Fi(),l=rl({mode:"hidden",children:l},o=t.mode),i=Hn(i,o,r,null),l.return=t,i.return=t,l.sibling=i,t.child=l,(i=t.child).memoizedState=Qa(r),i.childLanes=Za(e,s,r),t.memoizedState=Ja,Ba(null,i)):(Li(t),tl(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(a)256&t.flags?(Li(t),t.flags&=-257,t=nl(e,t,r)):null!==t.memoizedState?(Fi(),t.child=e.child,t.flags|=128,t=null):(Fi(),l=i.fallback,o=t.mode,i=rl({mode:"visible",children:i.children},o),(l=Hn(l,o,r,null)).flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,gi(t,e.child,null,r),(i=t.child).memoizedState=Qa(r),i.childLanes=Za(e,s,r),t.memoizedState=Ja,t=Ba(null,i));else if(Li(t),Rh(l)){if(s=l.nextSibling&&l.nextSibling.dataset)var u=s.dgst;s=u,(i=Error(n(419))).stack="",i.digest=s,Ss({value:i,source:null,stack:null}),t=nl(e,t,r)}else if(Ra||As(e,t,r,!1),s=0!==(r&e.childLanes),Ra||s){if(null!==(s=yc)&&(0!==(i=Ie(s,r))&&i!==c.retryLane))throw c.retryLane=i,Rn(e,i),Jc(s,e,i),Ma;Mh(l)||cu(),t=nl(e,t,r)}else Mh(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,ds=Lh(l.nextSibling),hs=t,fs=!0,ps=null,gs=!1,null!==e&&us(t,e),(t=tl(t,i.children)).flags|=4096);return t}return o?(Fi(),l=i.fallback,o=t.mode,u=(c=e.child).sibling,(i=Un(c,{mode:"hidden",children:i.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=Un(u,l):(l=Hn(l,o,r,null)).flags|=2,l.return=t,i.return=t,i.sibling=l,t.child=i,Ba(null,i),i=t.child,null===(l=e.child.memoizedState)?l=Qa(r):(null!==(o=l.cachePool)?(c=zs._currentValue,o=o.parent!==c?{parent:c,pool:c}:o):o=Qs(),l={baseLanes:l.baseLanes|r,cachePool:o}),i.memoizedState=l,i.childLanes=Za(e,s,r),t.memoizedState=Ja,Ba(e.child,i)):(Li(t),e=(r=e.child).sibling,(r=Un(r,{mode:"visible",children:i.children})).return=t,r.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=r,t.memoizedState=null,r)}function tl(e,t){return(t=rl({mode:"visible",children:t},e.mode)).return=e,e.child=t}function rl(e,t){return(e=zn(22,e,null,t)).lanes=0,e}function nl(e,t,r){return gi(t,e.child,null,r),(e=tl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function sl(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),js(e.return,t,r)}function il(e,t,r,n,s,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s,treeForkCount:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=s,o.treeForkCount=i)}function ol(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;n=n.children;var o=Bi.current,a=!!(2&o);if(a?(o=1&o|2,t.flags|=128):o&=1,W(Bi,o),La(e,t,n,r),n=fs?es:0,!a&&null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&sl(e,r,t);else if(19===e.tag)sl(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(s){case"forwards":for(r=t.child,s=null;null!==r;)null!==(e=r.alternate)&&null===Ui(e)&&(s=r),r=r.sibling;null===(r=s)?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),il(t,!1,s,r,i,n);break;case"backwards":case"unstable_legacy-backwards":for(r=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===Ui(e)){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}il(t,!0,r,null,i,n);break;case"together":il(t,!1,null,null,void 0,n);break;default:t.memoizedState=null}return t.child}function al(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Ec|=t.lanes,0===(r&t.childLanes)){if(null===e)return null;if(As(e,t,r,!1),0===(r&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(n(153));if(null!==t.child){for(r=Un(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Un(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function ll(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ds(e))}function cl(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ra=!0;else{if(!(ll(e,r)||128&t.flags))return Ra=!1,function(e,t,r){switch(t.tag){case 3:K(t,t.stateNode.containerInfo),Es(0,zs,e.memoizedState.cache),xs();break;case 27:case 5:Q(t);break;case 4:K(t,t.stateNode.containerInfo);break;case 10:Es(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Ii(t),null;break;case 13:var n=t.memoizedState;if(null!==n)return null!==n.dehydrated?(Li(t),t.flags|=128,null):0!==(r&t.child.childLanes)?el(e,t,r):(Li(t),null!==(e=al(e,t,r))?e.sibling:null);Li(t);break;case 19:var s=!!(128&e.flags);if((n=0!==(r&t.childLanes))||(As(e,t,r,!1),n=0!==(r&t.childLanes)),s){if(n)return ol(e,t,r);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),W(Bi,Bi.current),n)break;return null;case 22:return t.lanes=0,za(e,t,r,t.pendingProps);case 24:Es(0,zs,e.memoizedState.cache)}return al(e,t,r)}(e,t,r);Ra=!!(131072&e.flags)}else Ra=!1,fs&&1048576&t.flags&&as(t,es,t.index);switch(t.lanes=0,t.tag){case 16:e:{var s=t.pendingProps;if(e=ii(t.elementType),t.type=e,"function"!=typeof e){if(null!=e){var i=e.$$typeof;if(i===_){t.tag=11,t=Ia(null,t,e,s,r);break e}if(i===T){t.tag=14,t=$a(null,t,e,s,r);break e}}throw t=M(e)||e,Error(n(306,t,""))}Bn(e)?(s=Ca(e,s),t.tag=1,t=qa(null,t,e,s,r)):(t.tag=0,t=Ga(null,t,e,s,r))}return t;case 0:return Ga(e,t,t.type,t.pendingProps,r);case 1:return qa(e,t,s=t.type,i=Ca(s,t.pendingProps),r);case 3:e:{if(K(t,t.stateNode.containerInfo),null===e)throw Error(n(387));s=t.pendingProps;var o=t.memoizedState;i=o.element,bi(e,t),Ti(t,s,null,r);var a=t.memoizedState;if(s=a.cache,Es(0,zs,s),s!==o.cache&&Ps(t,[zs],r,!0),Ci(),s=a.element,o.isDehydrated){if(o={element:s,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ka(e,t,s,r);break e}if(s!==i){Ss(i=Kn(Error(n(424)),t)),t=Ka(e,t,s,r);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ds=Lh(e.firstChild),hs=t,fs=!0,ps=null,gs=!0,r=mi(t,null,s,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(xs(),s===i){t=al(e,t,r);break e}La(e,t,s,r)}t=t.child}return t;case 26:return Ha(e,t),null===e?(r=qh(t.type,null,t.pendingProps,null))?t.memoizedState=r:fs||(r=t.type,e=t.pendingProps,(s=bh(q.current).createElement(r))[We]=t,s[Ve]=e,gh(s,r,e),rt(s),t.stateNode=s):t.memoizedState=qh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Q(t),null===e&&fs&&(s=t.stateNode=zh(t.type,t.pendingProps,q.current),hs=t,gs=!0,i=ds,jh(t.type)?(Ih=i,ds=Lh(s.firstChild)):ds=i),La(e,t,t.pendingProps.children,r),Ha(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&fs&&((i=s=ds)&&(null!==(s=function(e,t,r,n){for(;1===e.nodeType;){var s=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(n){if(!e[Ke])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==s.rel||e.getAttribute("href")!==(null==s.href||""===s.href?null:s.href)||e.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin)||e.getAttribute("title")!==(null==s.title?null:s.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==s.src?null:s.src)||e.getAttribute("type")!==(null==s.type?null:s.type)||e.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==s.name?null:""+s.name;if("hidden"===s.type&&e.getAttribute("name")===i)return e}if(null===(e=Lh(e.nextSibling)))break}return null}(s,t.type,t.pendingProps,gs))?(t.stateNode=s,hs=t,ds=Lh(s.firstChild),gs=!1,i=!0):i=!1),i||ys(t)),Q(t),i=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,s=o.children,_h(i,o)?s=null:null!==a&&_h(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=ro(e,t,io,null,null,r),fd._currentValue=i),Ha(e,t),La(e,t,s,r),t.child;case 6:return null===e&&fs&&((e=r=ds)&&(null!==(r=function(e,t,r){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!r)return null;if(null===(e=Lh(e.nextSibling)))return null}return e}(r,t.pendingProps,gs))?(t.stateNode=r,hs=t,ds=null,e=!0):e=!1),e||ys(t)),null;case 13:return el(e,t,r);case 4:return K(t,t.stateNode.containerInfo),s=t.pendingProps,null===e?t.child=gi(t,null,s,r):La(e,t,s,r),t.child;case 11:return Ia(e,t,t.type,t.pendingProps,r);case 7:return La(e,t,t.pendingProps,r),t.child;case 8:case 12:return La(e,t,t.pendingProps.children,r),t.child;case 10:return s=t.pendingProps,Es(0,t.type,s.value),La(e,t,s.children,r),t.child;case 9:return i=t.type._context,s=t.pendingProps.children,Ns(t),s=s(i=Ms(i)),t.flags|=1,La(e,t,s,r),t.child;case 14:return $a(e,t,t.type,t.pendingProps,r);case 15:return Fa(e,t,t.type,t.pendingProps,r);case 19:return ol(e,t,r);case 31:return function(e,t,r){var s=t.pendingProps,i=!!(128&t.flags);if(t.flags&=-129,null===e){if(fs){if("hidden"===s.mode)return e=Wa(t,s),t.lanes=536870912,Ba(null,e);if(Ii(t),(e=ds)?null!==(e=null!==(e=Nh(e,gs))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ns?{id:ss,overflow:is}:null,retryLane:536870912,hydrationErrors:null},(r=Yn(e)).return=t,t.child=r,hs=t,ds=null):e=null,null===e)throw ys(t);return t.lanes=536870912,null}return Wa(t,s)}var o=e.memoizedState;if(null!==o){var a=o.dehydrated;if(Ii(t),i)if(256&t.flags)t.flags&=-257,t=Va(e,t,r);else{if(null===t.memoizedState)throw Error(n(558));t.child=e.child,t.flags|=128,t=null}else if(Ra||As(e,t,r,!1),i=0!==(r&e.childLanes),Ra||i){if(null!==(s=yc)&&0!==(a=Ie(s,r))&&a!==o.retryLane)throw o.retryLane=a,Rn(e,a),Jc(s,e,a),Ma;cu(),t=Va(e,t,r)}else e=o.treeContext,ds=Lh(a.nextSibling),hs=t,fs=!0,ps=null,gs=!1,null!==e&&us(t,e),(t=Wa(t,s)).flags|=4096;return t}return(e=Un(e.child,{mode:s.mode,children:s.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,r);case 22:return za(e,t,r,t.pendingProps);case 24:return Ns(t),s=Ms(zs),null===e?(null===(i=Ks())&&(i=yc,o=Bs(),i.pooledCache=o,o.refCount++,null!==o&&(i.pooledCacheLanes|=r),i=o),t.memoizedState={parent:s,cache:i},vi(t),Es(0,zs,i)):(0!==(e.lanes&r)&&(bi(e,t),Ti(t,null,null,r),Ci()),i=e.memoizedState,o=t.memoizedState,i.parent!==s?(i={parent:s,cache:s},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Es(0,zs,s)):(s=o.cache,Es(0,zs,s),s!==i.cache&&Ps(t,[zs],r,!0))),La(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(n(156,t.tag))}function ul(e){e.flags|=4}function hl(e,t,r,n,s){if((t=!!(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&s)===s)if(e.stateNode.complete)e.flags|=8192;else{if(!ou())throw oi=ri,ei;e.flags|=8192}}else e.flags&=-16777217}function dl(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!ad(t)){if(!ou())throw oi=ri,ei;e.flags|=8192}}function fl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?De():536870912,e.lanes|=t,Ac|=t)}function pl(e,t){if(!fs)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function gl(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;null!==s;)r|=s.lanes|s.childLanes,n|=65011712&s.subtreeFlags,n|=65011712&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ml(e,t,r){var s=t.pendingProps;switch(cs(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return gl(t),null;case 3:return r=t.stateNode,s=null,null!==e&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),Os(zs),J(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ws(t)?ul(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,_s())),gl(t),null;case 26:var i=t.type,o=t.memoizedState;return null===e?(ul(t),null!==o?(gl(t),dl(t,o)):(gl(t),hl(t,i,0,0,r))):o?o!==e.memoizedState?(ul(t),gl(t),dl(t,o)):(gl(t),t.flags&=-16777217):((e=e.memoizedProps)!==s&&ul(t),gl(t),hl(t,i,0,0,r)),null;case 27:if(Z(t),r=q.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==s&&ul(t);else{if(!s){if(null===t.stateNode)throw Error(n(166));return gl(t),null}e=G.current,ws(t)?vs(t):(e=zh(i,s,r),t.stateNode=e,ul(t))}return gl(t),null;case 5:if(Z(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==s&&ul(t);else{if(!s){if(null===t.stateNode)throw Error(n(166));return gl(t),null}if(o=G.current,ws(t))vs(t);else{var a=bh(q.current);switch(o){case 1:o=a.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:o=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":o=a.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":o=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(o=a.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"==typeof s.is?a.createElement("select",{is:s.is}):a.createElement("select"),s.multiple?o.multiple=!0:s.size&&(o.size=s.size);break;default:o="string"==typeof s.is?a.createElement(i,{is:s.is}):a.createElement(i)}}o[We]=t,o[Ve]=s;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)o.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=o;e:switch(gh(o,i,s),i){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&ul(t)}}return gl(t),hl(t,t.type,null===e||e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==s&&ul(t);else{if("string"!=typeof s&&null===t.stateNode)throw Error(n(166));if(e=q.current,ws(t)){if(e=t.stateNode,r=t.memoizedProps,s=null,null!==(i=hs))switch(i.tag){case 27:case 5:s=i.memoizedProps}e[We]=t,(e=!!(e.nodeValue===r||null!==s&&!0===s.suppressHydrationWarning||dh(e.nodeValue,r)))||ys(t,!0)}else(e=bh(e).createTextNode(s))[We]=t,t.stateNode=e}return gl(t),null;case 31:if(r=t.memoizedState,null===e||null!==e.memoizedState){if(s=ws(t),null!==r){if(null===e){if(!s)throw Error(n(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(n(557));e[We]=t}else xs(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;gl(t),e=!1}else r=_s(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return 256&t.flags?(zi(t),t):(zi(t),null);if(128&t.flags)throw Error(n(558))}return gl(t),null;case 13:if(s=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=ws(t),null!==s&&null!==s.dehydrated){if(null===e){if(!i)throw Error(n(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(n(317));i[We]=t}else xs(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;gl(t),i=!1}else i=_s(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(zi(t),t):(zi(t),null)}return zi(t),128&t.flags?(t.lanes=r,t):(r=null!==s,e=null!==e&&null!==e.memoizedState,r&&(i=null,null!==(s=t.child).alternate&&null!==s.alternate.memoizedState&&null!==s.alternate.memoizedState.cachePool&&(i=s.alternate.memoizedState.cachePool.pool),o=null,null!==s.memoizedState&&null!==s.memoizedState.cachePool&&(o=s.memoizedState.cachePool.pool),o!==i&&(s.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),fl(t,t.updateQueue),gl(t),null);case 4:return J(),null===e&&rh(t.stateNode.containerInfo),gl(t),null;case 10:return Os(t.type),gl(t),null;case 19:if(U(Bi),null===(s=t.memoizedState))return gl(t),null;if(i=!!(128&t.flags),null===(o=s.rendering))if(i)pl(s,!1);else{if(0!==Tc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(o=Ui(e))){for(t.flags|=128,pl(s,!1),e=o.updateQueue,t.updateQueue=e,fl(t,e),t.subtreeFlags=0,e=r,r=t.child;null!==r;)Wn(r,e),r=r.sibling;return W(Bi,1&Bi.current|2),fs&&os(t,s.treeForkCount),t.child}e=e.sibling}null!==s.tail&&ue()>Ic&&(t.flags|=128,i=!0,pl(s,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Ui(o))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,fl(t,e),pl(s,!0),null===s.tail&&"hidden"===s.tailMode&&!o.alternate&&!fs)return gl(t),null}else 2*ue()-s.renderingStartTime>Ic&&536870912!==r&&(t.flags|=128,i=!0,pl(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=s.last)?e.sibling=o:t.child=o,s.last=o)}return null!==s.tail?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ue(),e.sibling=null,r=Bi.current,W(Bi,i?1&r|2:1&r),fs&&os(t,s.treeForkCount),e):(gl(t),null);case 22:case 23:return zi(t),Ni(),s=null!==t.memoizedState,null!==e?null!==e.memoizedState!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?!!(536870912&r)&&!(128&t.flags)&&(gl(t),6&t.subtreeFlags&&(t.flags|=8192)):gl(t),null!==(r=t.updateQueue)&&fl(t,r.retryQueue),r=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),s=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(s=t.memoizedState.cachePool.pool),s!==r&&(t.flags|=2048),null!==e&&U(Xs),null;case 24:return r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Os(zs),gl(t),null;case 25:case 30:return null}throw Error(n(156,t.tag))}function yl(e,t){switch(cs(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Os(zs),J(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Z(t),null;case 31:if(null!==t.memoizedState){if(zi(t),null===t.alternate)throw Error(n(340));xs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(zi(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(n(340));xs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(Bi),null;case 4:return J(),null;case 10:return Os(t.type),null;case 22:case 23:return zi(t),Ni(),null!==e&&U(Xs),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Os(zs),null;default:return null}}function vl(e,t){switch(cs(t),t.tag){case 3:Os(zs),J();break;case 26:case 27:case 5:Z(t);break;case 4:J();break;case 31:null!==t.memoizedState&&zi(t);break;case 13:zi(t);break;case 19:U(Bi);break;case 10:Os(t.type);break;case 22:case 23:zi(t),Ni(),null!==e&&U(Xs);break;case 24:Os(zs)}}function bl(e,t){try{var r=t.updateQueue,n=null!==r?r.lastEffect:null;if(null!==n){var s=n.next;r=s;do{if((r.tag&e)===e){n=void 0;var i=r.create,o=r.inst;n=i(),o.destroy=n}r=r.next}while(r!==s)}}catch(a){Tu(t,t.return,a)}}function wl(e,t,r){try{var n=t.updateQueue,s=null!==n?n.lastEffect:null;if(null!==s){var i=s.next;n=i;do{if((n.tag&e)===e){var o=n.inst,a=o.destroy;if(void 0!==a){o.destroy=void 0,s=t;var l=r,c=a;try{c()}catch(u){Tu(s,l,u)}}}n=n.next}while(n!==i)}}catch(u){Tu(t,t.return,u)}}function xl(e){var t=e.updateQueue;if(null!==t){var r=e.stateNode;try{Oi(t,r)}catch(n){Tu(e,e.return,n)}}}function _l(e,t,r){r.props=Ca(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(n){Tu(e,t,n)}}function Sl(e,t){try{var r=e.ref;if(null!==r){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;default:n=e.stateNode}"function"==typeof r?e.refCleanup=r(n):r.current=n}}catch(s){Tu(e,t,s)}}function kl(e,t){var r=e.ref,n=e.refCleanup;if(null!==r)if("function"==typeof n)try{n()}catch(s){Tu(e,t,s)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof r)try{r(null)}catch(i){Tu(e,t,i)}else r.current=null}function Cl(e){var t=e.type,r=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&n.focus();break e;case"img":r.src?n.src=r.src:r.srcSet&&(n.srcset=r.srcSet)}}catch(s){Tu(e,e.return,s)}}function Tl(e,t,r){try{var s=e.stateNode;!function(e,t,r,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,a=null,l=null,c=null,u=null,h=null;for(p in r){var d=r[p];if(r.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":c=d;default:s.hasOwnProperty(p)||fh(e,t,p,null,s,d)}}for(var f in s){var p=s[f];if(d=r[f],s.hasOwnProperty(f)&&(null!=p||null!=d))switch(f){case"type":o=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":a=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(n(137,t));break;default:p!==d&&fh(e,t,f,p,s,d)}}return void wt(e,a,l,c,u,h,o,i);case"select":for(o in p=a=l=f=null,r)if(c=r[o],r.hasOwnProperty(o)&&null!=c)switch(o){case"value":break;case"multiple":p=c;default:s.hasOwnProperty(o)||fh(e,t,o,null,s,c)}for(i in s)if(o=s[i],c=r[i],s.hasOwnProperty(i)&&(null!=o||null!=c))switch(i){case"value":f=o;break;case"defaultValue":l=o;break;case"multiple":a=o;default:o!==c&&fh(e,t,i,o,s,c)}return t=l,r=a,s=p,void(null!=f?St(e,!!r,f,!1):!!s!=!!r&&(null!=t?St(e,!!r,t,!0):St(e,!!r,r?[]:"",!1)));case"textarea":for(l in p=f=null,r)if(i=r[l],r.hasOwnProperty(l)&&null!=i&&!s.hasOwnProperty(l))switch(l){case"value":case"children":break;default:fh(e,t,l,null,s,i)}for(a in s)if(i=s[a],o=r[a],s.hasOwnProperty(a)&&(null!=i||null!=o))switch(a){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(n(91));break;default:i!==o&&fh(e,t,a,i,s,o)}return void kt(e,f,p);case"option":for(var g in r)if(f=r[g],r.hasOwnProperty(g)&&null!=f&&!s.hasOwnProperty(g))if("selected"===g)e.selected=!1;else fh(e,t,g,null,s,f);for(c in s)if(f=s[c],p=r[c],s.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!=typeof f&&"symbol"!=typeof f;else fh(e,t,c,f,s,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in r)f=r[m],r.hasOwnProperty(m)&&null!=f&&!s.hasOwnProperty(m)&&fh(e,t,m,null,s,f);for(u in s)if(f=s[u],p=r[u],s.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(n(137,t));break;default:fh(e,t,u,f,s,p)}return;default:if(Pt(t)){for(var y in r)f=r[y],r.hasOwnProperty(y)&&void 0!==f&&!s.hasOwnProperty(y)&&ph(e,t,y,void 0,s,f);for(h in s)f=s[h],p=r[h],!s.hasOwnProperty(h)||f===p||void 0===f&&void 0===p||ph(e,t,h,f,s,p);return}}for(var v in r)f=r[v],r.hasOwnProperty(v)&&null!=f&&!s.hasOwnProperty(v)&&fh(e,t,v,null,s,f);for(d in s)f=s[d],p=r[d],!s.hasOwnProperty(d)||f===p||null==f&&null==p||fh(e,t,d,f,s,p)}(s,e.type,r,t),s[Ve]=t}catch(i){Tu(e,e.return,i)}}function El(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&jh(e.type)||4===e.tag}function Ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||El(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&jh(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function jl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?(9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).insertBefore(e,t):((t=9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).appendChild(e),null!=(r=r._reactRootContainer)||null!==t.onclick||(t.onclick=Mt));else if(4!==n&&(27===n&&jh(e.type)&&(r=e.stateNode,t=null),null!==(e=e.child)))for(jl(e,t,r),e=e.sibling;null!==e;)jl(e,t,r),e=e.sibling}function Pl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&(27===n&&jh(e.type)&&(r=e.stateNode),null!==(e=e.child)))for(Pl(e,t,r),e=e.sibling;null!==e;)Pl(e,t,r),e=e.sibling}function Al(e){var t=e.stateNode,r=e.memoizedProps;try{for(var n=e.type,s=t.attributes;s.length;)t.removeAttributeNode(s[0]);gh(t,n,r),t[We]=e,t[Ve]=r}catch(i){Tu(e,e.return,i)}}var Dl=!1,Nl=!1,Ml=!1,Rl="function"==typeof WeakSet?WeakSet:Set,Ll=null;function Il(e,t,r){var n=r.flags;switch(r.tag){case 0:case 11:case 15:Jl(e,r),4&n&&bl(5,r);break;case 1:if(Jl(e,r),4&n)if(e=r.stateNode,null===t)try{e.componentDidMount()}catch(o){Tu(r,r.return,o)}else{var s=Ca(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(s,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){Tu(r,r.return,a)}}64&n&&xl(r),512&n&&Sl(r,r.return);break;case 3:if(Jl(e,r),64&n&&null!==(e=r.updateQueue)){if(t=null,null!==r.child)switch(r.child.tag){case 27:case 5:case 1:t=r.child.stateNode}try{Oi(e,t)}catch(o){Tu(r,r.return,o)}}break;case 27:null===t&&4&n&&Al(r);case 26:case 5:Jl(e,r),null===t&&4&n&&Cl(r),512&n&&Sl(r,r.return);break;case 12:Jl(e,r);break;case 31:Jl(e,r),4&n&&Wl(e,r);break;case 13:Jl(e,r),4&n&&Vl(e,r),64&n&&(null!==(e=r.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var r=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==r.readyState)t();else{var n=function(){t(),r.removeEventListener("DOMContentLoaded",n)};r.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}(e,r=Pu.bind(null,r))));break;case 22:if(!(n=null!==r.memoizedState||Dl)){t=null!==t&&null!==t.memoizedState||Nl,s=Dl;var i=Nl;Dl=n,(Nl=t)&&!i?Zl(e,r,!!(8772&r.subtreeFlags)):Jl(e,r),Dl=s,Nl=i}break;case 30:break;default:Jl(e,r)}}function $l(e){var t=e.alternate;null!==t&&(e.alternate=null,$l(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Je(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Fl=null,zl=!1;function Bl(e,t,r){for(r=r.child;null!==r;)Ul(e,t,r),r=r.sibling}function Ul(e,t,r){if(we&&"function"==typeof we.onCommitFiberUnmount)try{we.onCommitFiberUnmount(be,r)}catch(i){}switch(r.tag){case 26:Nl||kl(r,t),Bl(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode).parentNode.removeChild(r);break;case 27:Nl||kl(r,t);var n=Fl,s=zl;jh(r.type)&&(Fl=r.stateNode,zl=!1),Bl(e,t,r),Bh(r.stateNode),Fl=n,zl=s;break;case 5:Nl||kl(r,t);case 6:if(n=Fl,s=zl,Fl=null,Bl(e,t,r),zl=s,null!==(Fl=n))if(zl)try{(9===Fl.nodeType?Fl.body:"HTML"===Fl.nodeName?Fl.ownerDocument.body:Fl).removeChild(r.stateNode)}catch(o){Tu(r,t,o)}else try{Fl.removeChild(r.stateNode)}catch(o){Tu(r,t,o)}break;case 18:null!==Fl&&(zl?(Ph(9===(e=Fl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,r.stateNode),Yd(e)):Ph(Fl,r.stateNode));break;case 4:n=Fl,s=zl,Fl=r.stateNode.containerInfo,zl=!0,Bl(e,t,r),Fl=n,zl=s;break;case 0:case 11:case 14:case 15:wl(2,r,t),Nl||wl(4,r,t),Bl(e,t,r);break;case 1:Nl||(kl(r,t),"function"==typeof(n=r.stateNode).componentWillUnmount&&_l(r,t,n)),Bl(e,t,r);break;case 21:Bl(e,t,r);break;case 22:Nl=(n=Nl)||null!==r.memoizedState,Bl(e,t,r),Nl=n;break;default:Bl(e,t,r)}}function Wl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Yd(e)}catch(r){Tu(t,t.return,r)}}}function Vl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Yd(e)}catch(r){Tu(t,t.return,r)}}function Hl(e,t){var r=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Rl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Rl),t;default:throw Error(n(435,e.tag))}}(e);t.forEach(function(t){if(!r.has(t)){r.add(t);var n=Au.bind(null,e,t);t.then(n,n)}})}function Gl(e,t){var r=t.deletions;if(null!==r)for(var s=0;s<r.length;s++){var i=r[s],o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:if(jh(l.type)){Fl=l.stateNode,zl=!1;break e}break;case 5:Fl=l.stateNode,zl=!1;break e;case 3:case 4:Fl=l.stateNode.containerInfo,zl=!0;break e}l=l.return}if(null===Fl)throw Error(n(160));Ul(o,a,i),Fl=null,zl=!1,null!==(o=i.alternate)&&(o.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)ql(t,e),t=t.sibling}var Yl=null;function ql(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Gl(t,e),Xl(e),4&s&&(wl(3,e,e.return),bl(3,e),wl(5,e,e.return));break;case 1:Gl(t,e),Xl(e),512&s&&(Nl||null===r||kl(r,r.return)),64&s&&Dl&&(null!==(e=e.updateQueue)&&(null!==(s=e.callbacks)&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===r?s:r.concat(s))));break;case 26:var i=Yl;if(Gl(t,e),Xl(e),512&s&&(Nl||null===r||kl(r,r.return)),4&s){var o=null!==r?r.memoizedState:null;if(s=e.memoizedState,null===r)if(null===s)if(null===e.stateNode){e:{s=e.type,r=e.memoizedProps,i=i.ownerDocument||i;t:switch(s){case"title":(!(o=i.getElementsByTagName("title")[0])||o[Ke]||o[We]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=i.createElement(s),i.head.insertBefore(o,i.querySelector("head > title"))),gh(o,s,r),o[We]=e,rt(o),s=o;break e;case"link":var a=id("link","href",i).get(s+(r.href||""));if(a)for(var l=0;l<a.length;l++)if((o=a[l]).getAttribute("href")===(null==r.href||""===r.href?null:r.href)&&o.getAttribute("rel")===(null==r.rel?null:r.rel)&&o.getAttribute("title")===(null==r.title?null:r.title)&&o.getAttribute("crossorigin")===(null==r.crossOrigin?null:r.crossOrigin)){a.splice(l,1);break t}gh(o=i.createElement(s),s,r),i.head.appendChild(o);break;case"meta":if(a=id("meta","content",i).get(s+(r.content||"")))for(l=0;l<a.length;l++)if((o=a[l]).getAttribute("content")===(null==r.content?null:""+r.content)&&o.getAttribute("name")===(null==r.name?null:r.name)&&o.getAttribute("property")===(null==r.property?null:r.property)&&o.getAttribute("http-equiv")===(null==r.httpEquiv?null:r.httpEquiv)&&o.getAttribute("charset")===(null==r.charSet?null:r.charSet)){a.splice(l,1);break t}gh(o=i.createElement(s),s,r),i.head.appendChild(o);break;default:throw Error(n(468,s))}o[We]=e,rt(o),s=o}e.stateNode=s}else od(i,e.type,e.stateNode);else e.stateNode=ed(i,s,e.memoizedProps);else o!==s?(null===o?null!==r.stateNode&&(r=r.stateNode).parentNode.removeChild(r):o.count--,null===s?od(i,e.type,e.stateNode):ed(i,s,e.memoizedProps)):null===s&&null!==e.stateNode&&Tl(e,e.memoizedProps,r.memoizedProps)}break;case 27:Gl(t,e),Xl(e),512&s&&(Nl||null===r||kl(r,r.return)),null!==r&&4&s&&Tl(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Gl(t,e),Xl(e),512&s&&(Nl||null===r||kl(r,r.return)),32&e.flags){i=e.stateNode;try{Tt(i,"")}catch(g){Tu(e,e.return,g)}}4&s&&null!=e.stateNode&&Tl(e,i=e.memoizedProps,null!==r?r.memoizedProps:i),1024&s&&(Ml=!0);break;case 6:if(Gl(t,e),Xl(e),4&s){if(null===e.stateNode)throw Error(n(162));s=e.memoizedProps,r=e.stateNode;try{r.nodeValue=s}catch(g){Tu(e,e.return,g)}}break;case 3:if(sd=null,i=Yl,Yl=Vh(t.containerInfo),Gl(t,e),Yl=i,Xl(e),4&s&&null!==r&&r.memoizedState.isDehydrated)try{Yd(t.containerInfo)}catch(g){Tu(e,e.return,g)}Ml&&(Ml=!1,Kl(e));break;case 4:s=Yl,Yl=Vh(e.stateNode.containerInfo),Gl(t,e),Xl(e),Yl=s;break;case 12:default:Gl(t,e),Xl(e);break;case 31:case 19:Gl(t,e),Xl(e),4&s&&(null!==(s=e.updateQueue)&&(e.updateQueue=null,Hl(e,s)));break;case 13:Gl(t,e),Xl(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==r&&null!==r.memoizedState)&&(Rc=ue()),4&s&&(null!==(s=e.updateQueue)&&(e.updateQueue=null,Hl(e,s)));break;case 22:i=null!==e.memoizedState;var c=null!==r&&null!==r.memoizedState,u=Dl,h=Nl;if(Dl=u||i,Nl=h||c,Gl(t,e),Nl=h,Dl=u,Xl(e),8192&s)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===r||c||Dl||Nl||Ql(e)),r=null,t=e;;){if(5===t.tag||26===t.tag){if(null===r){c=r=t;try{if(o=c.stateNode,i)"function"==typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var d=c.memoizedProps.style,f=null!=d&&d.hasOwnProperty("display")?d.display:null;l.style.display=null==f||"boolean"==typeof f?"":(""+f).trim()}}catch(g){Tu(c,c.return,g)}}}else if(6===t.tag){if(null===r){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(g){Tu(c,c.return,g)}}}else if(18===t.tag){if(null===r){c=t;try{var p=c.stateNode;i?Ah(p,!0):Ah(c.stateNode,!1)}catch(g){Tu(c,c.return,g)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}4&s&&(null!==(s=e.updateQueue)&&(null!==(r=s.retryQueue)&&(s.retryQueue=null,Hl(e,r))));case 30:case 21:}}function Xl(e){var t=e.flags;if(2&t){try{for(var r,s=e.return;null!==s;){if(El(s)){r=s;break}s=s.return}if(null==r)throw Error(n(160));switch(r.tag){case 27:var i=r.stateNode;Pl(e,Ol(e),i);break;case 5:var o=r.stateNode;32&r.flags&&(Tt(o,""),r.flags&=-33),Pl(e,Ol(e),o);break;case 3:case 4:var a=r.stateNode.containerInfo;jl(e,Ol(e),a);break;default:throw Error(n(161))}}catch(l){Tu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Jl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Il(e,t.alternate,t),t=t.sibling}function Ql(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:wl(4,t,t.return),Ql(t);break;case 1:kl(t,t.return);var r=t.stateNode;"function"==typeof r.componentWillUnmount&&_l(t,t.return,r),Ql(t);break;case 27:Bh(t.stateNode);case 26:case 5:kl(t,t.return),Ql(t);break;case 22:null===t.memoizedState&&Ql(t);break;default:Ql(t)}e=e.sibling}}function Zl(e,t,r){for(r=r&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var n=t.alternate,s=e,i=t,o=i.flags;switch(i.tag){case 0:case 11:case 15:Zl(s,i,r),bl(4,i);break;case 1:if(Zl(s,i,r),"function"==typeof(s=(n=i).stateNode).componentDidMount)try{s.componentDidMount()}catch(c){Tu(n,n.return,c)}if(null!==(s=(n=i).updateQueue)){var a=n.stateNode;try{var l=s.shared.hiddenCallbacks;if(null!==l)for(s.shared.hiddenCallbacks=null,s=0;s<l.length;s++)Ei(l[s],a)}catch(c){Tu(n,n.return,c)}}r&&64&o&&xl(i),Sl(i,i.return);break;case 27:Al(i);case 26:case 5:Zl(s,i,r),r&&null===n&&4&o&&Cl(i),Sl(i,i.return);break;case 12:Zl(s,i,r);break;case 31:Zl(s,i,r),r&&4&o&&Wl(s,i);break;case 13:Zl(s,i,r),r&&4&o&&Vl(s,i);break;case 22:null===i.memoizedState&&Zl(s,i,r),Sl(i,i.return);break;case 30:break;default:Zl(s,i,r)}t=t.sibling}}function ec(e,t){var r=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==r&&(null!=e&&e.refCount++,null!=r&&Us(r))}function tc(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Us(e))}function rc(e,t,r,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)nc(e,t,r,n),t=t.sibling}function nc(e,t,r,n){var s=t.flags;switch(t.tag){case 0:case 11:case 15:rc(e,t,r,n),2048&s&&bl(9,t);break;case 1:case 31:case 13:default:rc(e,t,r,n);break;case 3:rc(e,t,r,n),2048&s&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Us(e)));break;case 12:if(2048&s){rc(e,t,r,n),e=t.stateNode;try{var i=t.memoizedProps,o=i.id,a=i.onPostCommit;"function"==typeof a&&a(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Tu(t,t.return,l)}}else rc(e,t,r,n);break;case 23:break;case 22:i=t.stateNode,o=t.alternate,null!==t.memoizedState?2&i._visibility?rc(e,t,r,n):ic(e,t):2&i._visibility?rc(e,t,r,n):(i._visibility|=2,sc(e,t,r,n,!!(10256&t.subtreeFlags)||!1)),2048&s&&ec(o,t);break;case 24:rc(e,t,r,n),2048&s&&tc(t.alternate,t)}}function sc(e,t,r,n,s){for(s=s&&(!!(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var i=e,o=t,a=r,l=n,c=o.flags;switch(o.tag){case 0:case 11:case 15:sc(i,o,a,l,s),bl(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?sc(i,o,a,l,s):ic(i,o):(u._visibility|=2,sc(i,o,a,l,s)),s&&2048&c&&ec(o.alternate,o);break;case 24:sc(i,o,a,l,s),s&&2048&c&&tc(o.alternate,o);break;default:sc(i,o,a,l,s)}t=t.sibling}}function ic(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var r=e,n=t,s=n.flags;switch(n.tag){case 22:ic(r,n),2048&s&&ec(n.alternate,n);break;case 24:ic(r,n),2048&s&&tc(n.alternate,n);break;default:ic(r,n)}t=t.sibling}}var oc=8192;function ac(e,t,r){if(e.subtreeFlags&oc)for(e=e.child;null!==e;)lc(e,t,r),e=e.sibling}function lc(e,t,r){switch(e.tag){case 26:ac(e,t,r),e.flags&oc&&null!==e.memoizedState&&function(e,t,r,n){if(!("stylesheet"!==r.type||"string"==typeof n.media&&!1===matchMedia(n.media).matches||4&r.state.loading)){if(null===r.instance){var s=Xh(n.href),i=t.querySelector(Kh(s));if(i)return null!==(t=i._p)&&"object"==typeof t&&"function"==typeof t.then&&(e.count++,e=cd.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=i,void rt(i);i=t.ownerDocument||t,n=Jh(n),(s=Uh.get(s))&&rd(n,s),rt(i=i.createElement("link"));var o=i;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),gh(i,"link",n),r.instance=i}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&!(3&r.state.loading)&&(e.count++,r=cd.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}(r,Yl,e.memoizedState,e.memoizedProps);break;case 5:default:ac(e,t,r);break;case 3:case 4:var n=Yl;Yl=Vh(e.stateNode.containerInfo),ac(e,t,r),Yl=n;break;case 22:null===e.memoizedState&&(null!==(n=e.alternate)&&null!==n.memoizedState?(n=oc,oc=16777216,ac(e,t,r),oc=n):ac(e,t,r))}}function cc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function uc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];Ll=n,fc(n,e)}cc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)hc(e),e=e.sibling}function hc(e){switch(e.tag){case 0:case 11:case 15:uc(e),2048&e.flags&&wl(9,e,e.return);break;case 3:case 12:default:uc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,dc(e)):uc(e)}}function dc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];Ll=n,fc(n,e)}cc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:wl(8,t,t.return),dc(t);break;case 22:2&(r=t.stateNode)._visibility&&(r._visibility&=-3,dc(t));break;default:dc(t)}e=e.sibling}}function fc(e,t){for(;null!==Ll;){var r=Ll;switch(r.tag){case 0:case 11:case 15:wl(8,r,t);break;case 23:case 22:if(null!==r.memoizedState&&null!==r.memoizedState.cachePool){var n=r.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:Us(r.memoizedState.cache)}if(null!==(n=r.child))n.return=r,Ll=n;else e:for(r=e;null!==Ll;){var s=(n=Ll).sibling,i=n.return;if($l(n),n===r){Ll=null;break e}if(null!==s){s.return=i,Ll=s;break e}Ll=i}}}var pc={getCacheForType:function(e){var t=Ms(zs),r=t.data.get(e);return void 0===r&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return Ms(zs).controller.signal}},gc="function"==typeof WeakMap?WeakMap:Map,mc=0,yc=null,vc=null,bc=0,wc=0,xc=null,_c=!1,Sc=!1,kc=!1,Cc=0,Tc=0,Ec=0,Oc=0,jc=0,Pc=0,Ac=0,Dc=null,Nc=null,Mc=!1,Rc=0,Lc=0,Ic=1/0,$c=null,Fc=null,zc=0,Bc=null,Uc=null,Wc=0,Vc=0,Hc=null,Gc=null,Yc=0,qc=null;function Xc(){return 2&mc&&0!==bc?bc&-bc:null!==L.T?Hu():ze()}function Kc(){if(0===Pc)if(536870912&bc&&!fs)Pc=536870912;else{var e=Te;!(3932160&(Te<<=1))&&(Te=262144),Pc=e}return null!==(e=Mi.current)&&(e.flags|=32),Pc}function Jc(e,t,r){(e!==yc||2!==wc&&9!==wc)&&null===e.cancelPendingCommit||(su(e,0),tu(e,bc,Pc,!1)),Me(e,r),2&mc&&e===yc||(e===yc&&(!(2&mc)&&(Oc|=r),4===Tc&&tu(e,bc,Pc,!1)),$u(e))}function Qc(e,t,r){if(6&mc)throw Error(n(327));for(var s=!r&&!(127&t)&&0===(t&e.expiredLanes)||Pe(e,t),i=s?function(e,t){var r=mc;mc|=2;var s=au(),i=lu();yc!==e||bc!==t?($c=null,Ic=ue()+500,su(e,t)):Sc=Pe(e,t);e:for(;;)try{if(0!==wc&&null!==vc){t=vc;var o=xc;t:switch(wc){case 1:wc=0,xc=null,gu(e,t,o,1);break;case 2:case 9:if(ni(o)){wc=0,xc=null,pu(t);break}t=function(){2!==wc&&9!==wc||yc!==e||(wc=7),$u(e)},o.then(t,t);break e;case 3:wc=7;break e;case 4:wc=5;break e;case 7:ni(o)?(wc=0,xc=null,pu(t)):(wc=0,xc=null,gu(e,t,o,7));break;case 5:var a=null;switch(vc.tag){case 26:a=vc.memoizedState;case 5:case 27:var l=vc;if(a?ad(a):l.stateNode.complete){wc=0,xc=null;var c=l.sibling;if(null!==c)vc=c;else{var u=l.return;null!==u?(vc=u,mu(u)):vc=null}break t}}wc=0,xc=null,gu(e,t,o,5);break;case 6:wc=0,xc=null,gu(e,t,o,6);break;case 8:nu(),Tc=6;break e;default:throw Error(n(462))}}du();break}catch(h){iu(e,h)}return Ts=Cs=null,L.H=s,L.A=i,mc=r,null!==vc?0:(yc=null,bc=0,Dn(),Tc)}(e,t):uu(e,t,!0),o=s;;){if(0===i){Sc&&!s&&tu(e,t,0,!1);break}if(r=e.current.alternate,!o||eu(r)){if(2===i){if(o=t,e.errorRecoveryDisabledLanes&o)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=Dc;var c=l.current.memoizedState.isDehydrated;if(c&&(su(l,a).flags|=256),2!==(a=uu(l,a,!1))){if(kc&&!c){l.errorRecoveryDisabledLanes|=o,Oc|=o,i=4;break e}o=Nc,Nc=i,null!==o&&(null===Nc?Nc=o:Nc.push.apply(Nc,o))}i=a}if(o=!1,2!==i)continue}}if(1===i){su(e,0),tu(e,t,0,!0);break}e:{switch(s=e,o=i){case 0:case 1:throw Error(n(345));case 4:if((4194048&t)!==t)break;case 6:tu(s,t,Pc,!_c);break e;case 2:Nc=null;break;case 3:case 5:break;default:throw Error(n(329))}if((62914560&t)===t&&10<(i=Rc+300-ue())){if(tu(s,t,Pc,!_c),0!==je(s,0,!0))break e;Wc=t,s.timeoutHandle=kh(Zc.bind(null,s,r,Nc,$c,Mc,t,Pc,Oc,Ac,_c,o,"Throttled",-0,0),i)}else Zc(s,r,Nc,$c,Mc,t,Pc,Oc,Ac,_c,o,null,-0,0)}break}i=uu(e,t,!1),o=!1}$u(e)}function Zc(e,t,r,n,s,i,o,a,l,c,u,h,d,f){if(e.timeoutHandle=-1,8192&(h=t.subtreeFlags)||!(16785408&~h)){lc(t,i,h={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mt});var p=(62914560&i)===i?Rc-ue():(4194048&i)===i?Lc-ue():0;if(null!==(p=function(e,t){return e.stylesheets&&0===e.count&&hd(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var n=setTimeout(function(){if(e.stylesheets&&hd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===ld&&(ld=62500*function(){if("function"==typeof performance.getEntriesByType){for(var e=0,t=0,r=performance.getEntriesByType("resource"),n=0;n<r.length;n++){var s=r[n],i=s.transferSize,o=s.initiatorType,a=s.duration;if(i&&a&&mh(o)){for(o=0,a=s.responseEnd,n+=1;n<r.length;n++){var l=r[n],c=l.startTime;if(c>a)break;var u=l.transferSize,h=l.initiatorType;u&&mh(h)&&(o+=u*((l=l.responseEnd)<a?1:(a-c)/(l-c)))}if(--n,t+=8*(i+o)/(s.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"==typeof(e=navigator.connection.downlink)?e:5}());var s=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&hd(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>ld?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(n),clearTimeout(s)}}:null}(h,p)))return Wc=i,e.cancelPendingCommit=p(vu.bind(null,e,t,i,r,n,s,o,a,l,u,h,null,d,f)),void tu(e,i,o,!c)}vu(e,t,i,r,n,s,o,a,l)}function eu(e){for(var t=e;;){var r=t.tag;if((0===r||11===r||15===r)&&16384&t.flags&&(null!==(r=t.updateQueue)&&null!==(r=r.stores)))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Zr(i(),s))return!1}catch(o){return!1}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function tu(e,t,r,n){t&=~jc,t&=~Oc,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var s=t;0<s;){var i=31-_e(s),o=1<<i;n[i]=-1,s&=~o}0!==r&&Re(e,r,t)}function ru(){return!!(6&mc)||(Fu(0),!1)}function nu(){if(null!==vc){if(0===wc)var e=vc.return;else Ts=Cs=null,lo(e=vc),ci=null,ui=0,e=vc;for(;null!==e;)vl(e.alternate,e),e=e.return;vc=null}}function su(e,t){var r=e.timeoutHandle;-1!==r&&(e.timeoutHandle=-1,Ch(r)),null!==(r=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,r()),Wc=0,nu(),yc=e,vc=r=Un(e.current,null),bc=t,wc=0,xc=null,_c=!1,Sc=Pe(e,t),kc=!1,Ac=Pc=jc=Oc=Ec=Tc=0,Nc=Dc=null,Mc=!1,8&t&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var s=31-_e(n),i=1<<s;t|=e[s],n&=~i}return Cc=t,Dn(),r}function iu(e,t){Vi=null,L.H=ya,t===Zs||t===ti?(t=ai(),wc=3):t===ei?(t=ai(),wc=4):wc=t===Ma?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,xc=t,null===vc&&(Tc=1,ja(e,Kn(t,e.current)))}function ou(){var e=Mi.current;return null===e||((4194048&bc)===bc?null===Ri:!!((62914560&bc)===bc||536870912&bc)&&e===Ri)}function au(){var e=L.H;return L.H=ya,null===e?ya:e}function lu(){var e=L.A;return L.A=pc,e}function cu(){Tc=4,_c||(4194048&bc)!==bc&&null!==Mi.current||(Sc=!0),!(134217727&Ec)&&!(134217727&Oc)||null===yc||tu(yc,bc,Pc,!1)}function uu(e,t,r){var n=mc;mc|=2;var s=au(),i=lu();yc===e&&bc===t||($c=null,su(e,t)),t=!1;var o=Tc;e:for(;;)try{if(0!==wc&&null!==vc){var a=vc,l=xc;switch(wc){case 8:nu(),o=6;break e;case 3:case 2:case 9:case 6:null===Mi.current&&(t=!0);var c=wc;if(wc=0,xc=null,gu(e,a,l,c),r&&Sc){o=0;break e}break;default:c=wc,wc=0,xc=null,gu(e,a,l,c)}}hu(),o=Tc;break}catch(u){iu(e,u)}return t&&e.shellSuspendCounter++,Ts=Cs=null,mc=n,L.H=s,L.A=i,null===vc&&(yc=null,bc=0,Dn()),o}function hu(){for(;null!==vc;)fu(vc)}function du(){for(;null!==vc&&!le();)fu(vc)}function fu(e){var t=cl(e.alternate,e,Cc);e.memoizedProps=e.pendingProps,null===t?mu(e):vc=t}function pu(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Ya(r,t,t.pendingProps,t.type,void 0,bc);break;case 11:t=Ya(r,t,t.pendingProps,t.type.render,t.ref,bc);break;case 5:lo(t);default:vl(r,t),t=cl(r,t=vc=Wn(t,Cc),Cc)}e.memoizedProps=e.pendingProps,null===t?mu(e):vc=t}function gu(e,t,r,s){Ts=Cs=null,lo(t),ci=null,ui=0;var i=t.return;try{if(function(e,t,r,s,i){if(r.flags|=32768,null!==s&&"object"==typeof s&&"function"==typeof s.then){if(null!==(t=r.alternate)&&As(t,r,i,!0),null!==(r=Mi.current)){switch(r.tag){case 31:case 13:return null===Ri?cu():null===r.alternate&&0===Tc&&(Tc=3),r.flags&=-257,r.flags|=65536,r.lanes=i,s===ri?r.flags|=16384:(null===(t=r.updateQueue)?r.updateQueue=new Set([s]):t.add(s),Eu(e,s,i)),!1;case 22:return r.flags|=65536,s===ri?r.flags|=16384:(null===(t=r.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},r.updateQueue=t):null===(r=t.retryQueue)?t.retryQueue=new Set([s]):r.add(s),Eu(e,s,i)),!1}throw Error(n(435,r.tag))}return Eu(e,s,i),cu(),!1}if(fs)return null!==(t=Mi.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,s!==ms&&Ss(Kn(e=Error(n(422),{cause:s}),r))):(s!==ms&&Ss(Kn(t=Error(n(423),{cause:s}),r)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,s=Kn(s,r),Si(e,i=Aa(e.stateNode,s,i)),4!==Tc&&(Tc=2)),!1;var o=Error(n(520),{cause:s});if(o=Kn(o,r),null===Dc?Dc=[o]:Dc.push(o),4!==Tc&&(Tc=2),null===t)return!0;s=Kn(s,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=i&-i,r.lanes|=e,Si(r,e=Aa(r.stateNode,s,e)),!1;case 1:if(t=r.type,o=r.stateNode,!(128&r.flags||"function"!=typeof t.getDerivedStateFromError&&(null===o||"function"!=typeof o.componentDidCatch||null!==Fc&&Fc.has(o))))return r.flags|=65536,i&=-i,r.lanes|=i,Na(i=Da(i),e,r,s),Si(r,i),!1}r=r.return}while(null!==r);return!1}(e,i,t,r,bc))return Tc=1,ja(e,Kn(r,e.current)),void(vc=null)}catch(o){if(null!==i)throw vc=i,o;return Tc=1,ja(e,Kn(r,e.current)),void(vc=null)}32768&t.flags?(fs||1===s?e=!0:Sc||536870912&bc?e=!1:(_c=e=!0,(2===s||9===s||3===s||6===s)&&(null!==(s=Mi.current)&&13===s.tag&&(s.flags|=16384))),yu(t,e)):mu(t)}function mu(e){var t=e;do{if(32768&t.flags)return void yu(t,_c);e=t.return;var r=ml(t.alternate,t,Cc);if(null!==r)return void(vc=r);if(null!==(t=t.sibling))return void(vc=t);vc=t=e}while(null!==t);0===Tc&&(Tc=5)}function yu(e,t){do{var r=yl(e.alternate,e);if(null!==r)return r.flags&=32767,void(vc=r);if(null!==(r=e.return)&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&null!==(e=e.sibling))return void(vc=e);vc=e=r}while(null!==e);Tc=6,vc=null}function vu(e,t,r,s,i,o,a,l,c){e.cancelPendingCommit=null;do{Su()}while(0!==zc);if(6&mc)throw Error(n(327));if(null!==t){if(t===e.current)throw Error(n(177));if(o=t.lanes|t.childLanes,function(e,t,r,n,s,i){var o=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(r=o&~r;0<r;){var u=31-_e(r),h=1<<u;a[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}r&=~h}0!==n&&Re(e,n,0),0!==i&&0===s&&0!==e.tag&&(e.suspendedLanes|=i&~(o&~t))}(e,r,o|=An,a,l,c),e===yc&&(vc=yc=null,bc=0),Uc=t,Bc=e,Wc=r,Vc=o,Hc=i,Gc=s,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,oe(pe,function(){return ku(),null})):(e.callbackNode=null,e.callbackPriority=0),s=!!(13878&t.flags),13878&t.subtreeFlags||s){s=L.T,L.T=null,i=I.p,I.p=2,a=mc,mc|=4;try{!function(e,t){if(e=e.containerInfo,yh=_d,on(e=sn(e))){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var s=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(s&&0!==s.rangeCount){r=s.anchorNode;var i=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{r.nodeType,o.nodeType}catch(m){r=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==r||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==s&&3!==d.nodeType||(c=a+s),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===r&&++u===i&&(l=a),f===o&&++h===s&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(vh={focusedElem:e,selectionRange:r},_d=!1,Ll=t;null!==Ll;)if(e=(t=Ll).child,1028&t.subtreeFlags&&null!==e)e.return=t,Ll=e;else for(;null!==Ll;){switch(o=(t=Ll).alternate,e=t.flags,t.tag){case 0:if(4&e&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(r=0;r<e.length;r++)(i=e[r]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==o){e=void 0,r=t,i=o.memoizedProps,o=o.memoizedState,s=r.stateNode;try{var g=Ca(r.type,i);e=s.getSnapshotBeforeUpdate(g,o),s.__reactInternalSnapshotBeforeUpdate=e}catch(y){Tu(r,r.return,y)}}break;case 3:if(1024&e)if(9===(r=(e=t.stateNode.containerInfo).nodeType))Dh(e);else if(1===r)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Dh(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(n(163))}if(null!==(e=t.sibling)){e.return=t.return,Ll=e;break}Ll=t.return}}(e,t)}finally{mc=a,I.p=i,L.T=s}}zc=1,bu(),wu(),xu()}}function bu(){if(1===zc){zc=0;var e=Bc,t=Uc,r=!!(13878&t.flags);if(13878&t.subtreeFlags||r){r=L.T,L.T=null;var n=I.p;I.p=2;var s=mc;mc|=4;try{ql(t,e);var i=vh,o=sn(e.containerInfo),a=i.focusedElem,l=i.selectionRange;if(o!==a&&a&&a.ownerDocument&&nn(a.ownerDocument.documentElement,a)){if(null!==l&&on(a)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var h=a.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var f=d.getSelection(),p=a.textContent.length,g=Math.min(l.start,p),m=void 0===l.end?g:Math.min(l.end,p);!f.extend&&g>m&&(o=m,m=g,g=o);var y=rn(a,g),v=rn(a,m);if(y&&v&&(1!==f.rangeCount||f.anchorNode!==y.node||f.anchorOffset!==y.offset||f.focusNode!==v.node||f.focusOffset!==v.offset)){var b=h.createRange();b.setStart(y.node,y.offset),f.removeAllRanges(),g>m?(f.addRange(b),f.extend(v.node,v.offset)):(b.setEnd(v.node,v.offset),f.addRange(b))}}}}for(h=[],f=a;f=f.parentNode;)1===f.nodeType&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"==typeof a.focus&&a.focus(),a=0;a<h.length;a++){var w=h[a];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}_d=!!yh,vh=yh=null}finally{mc=s,I.p=n,L.T=r}}e.current=t,zc=2}}function wu(){if(2===zc){zc=0;var e=Bc,t=Uc,r=!!(8772&t.flags);if(8772&t.subtreeFlags||r){r=L.T,L.T=null;var n=I.p;I.p=2;var s=mc;mc|=4;try{Il(e,t.alternate,t)}finally{mc=s,I.p=n,L.T=r}}zc=3}}function xu(){if(4===zc||3===zc){zc=0,ce();var e=Bc,t=Uc,r=Wc,n=Gc;10256&t.subtreeFlags||10256&t.flags?zc=5:(zc=0,Uc=Bc=null,_u(e,e.pendingLanes));var s=e.pendingLanes;if(0===s&&(Fc=null),Fe(r),t=t.stateNode,we&&"function"==typeof we.onCommitFiberRoot)try{we.onCommitFiberRoot(be,t,void 0,!(128&~t.current.flags))}catch(l){}if(null!==n){t=L.T,s=I.p,I.p=2,L.T=null;try{for(var i=e.onRecoverableError,o=0;o<n.length;o++){var a=n[o];i(a.value,{componentStack:a.stack})}}finally{L.T=t,I.p=s}}3&Wc&&Su(),$u(e),s=e.pendingLanes,261930&r&&42&s?e===qc?Yc++:(Yc=0,qc=e):Yc=0,Fu(0)}}function _u(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Us(t)))}function Su(){return bu(),wu(),xu(),ku()}function ku(){if(5!==zc)return!1;var e=Bc,t=Vc;Vc=0;var r=Fe(Wc),s=L.T,i=I.p;try{I.p=32>r?32:r,L.T=null,r=Hc,Hc=null;var o=Bc,a=Wc;if(zc=0,Uc=Bc=null,Wc=0,6&mc)throw Error(n(331));var l=mc;if(mc|=4,hc(o.current),nc(o,o.current,a,r),mc=l,Fu(0,!1),we&&"function"==typeof we.onPostCommitFiberRoot)try{we.onPostCommitFiberRoot(be,o)}catch(c){}return!0}finally{I.p=i,L.T=s,_u(e,t)}}function Cu(e,t,r){t=Kn(r,t),null!==(e=xi(e,t=Aa(e.stateNode,t,2),2))&&(Me(e,2),$u(e))}function Tu(e,t,r){if(3===e.tag)Cu(e,e,r);else for(;null!==t;){if(3===t.tag){Cu(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Fc||!Fc.has(n))){e=Kn(r,e),null!==(n=xi(t,r=Da(2),2))&&(Na(r,n,t,e),Me(n,2),$u(n));break}}t=t.return}}function Eu(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new gc;var s=new Set;n.set(t,s)}else void 0===(s=n.get(t))&&(s=new Set,n.set(t,s));s.has(r)||(kc=!0,s.add(r),e=Ou.bind(null,e,t,r),t.then(e,e))}function Ou(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,yc===e&&(bc&r)===r&&(4===Tc||3===Tc&&(62914560&bc)===bc&&300>ue()-Rc?!(2&mc)&&su(e,0):jc|=r,Ac===bc&&(Ac=0)),$u(e)}function ju(e,t){0===t&&(t=De()),null!==(e=Rn(e,t))&&(Me(e,t),$u(e))}function Pu(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),ju(e,r)}function Au(e,t){var r=0;switch(e.tag){case 31:case 13:var s=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(n(314))}null!==s&&s.delete(t),ju(e,r)}var Du=null,Nu=null,Mu=!1,Ru=!1,Lu=!1,Iu=0;function $u(e){e!==Nu&&null===e.next&&(null===Nu?Du=Nu=e:Nu=Nu.next=e),Ru=!0,Mu||(Mu=!0,Eh(function(){6&mc?oe(de,zu):Bu()}))}function Fu(e,t){if(!Lu&&Ru){Lu=!0;do{for(var r=!1,n=Du;null!==n;){if(0!==e){var s=n.pendingLanes;if(0===s)var i=0;else{var o=n.suspendedLanes,a=n.pingedLanes;i=(1<<31-_e(42|e)+1)-1,i=201326741&(i&=s&~(o&~a))?201326741&i|1:i?2|i:0}0!==i&&(r=!0,Vu(n,i))}else i=bc,!(3&(i=je(n,n===yc?i:0,null!==n.cancelPendingCommit||-1!==n.timeoutHandle)))||Pe(n,i)||(r=!0,Vu(n,i));n=n.next}}while(r);Lu=!1}}function zu(){Bu()}function Bu(){Ru=Mu=!1;var e=0;0!==Iu&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Sh&&(Sh=e,!0);return Sh=null,!1}()&&(e=Iu);for(var t=ue(),r=null,n=Du;null!==n;){var s=n.next,i=Uu(n,t);0===i?(n.next=null,null===r?Du=s:r.next=s,null===s&&(Nu=r)):(r=n,(0!==e||3&i)&&(Ru=!0)),n=s}0!==zc&&5!==zc||Fu(e),0!==Iu&&(Iu=0)}function Uu(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var o=31-_e(i),a=1<<o,l=s[o];-1===l?0!==(a&r)&&0===(a&n)||(s[o]=Ae(a,t)):l<=t&&(e.expiredLanes|=a),i&=~a}if(r=bc,r=je(e,e===(t=yc)?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),n=e.callbackNode,0===r||e===t&&(2===wc||9===wc)||null!==e.cancelPendingCommit)return null!==n&&null!==n&&ae(n),e.callbackNode=null,e.callbackPriority=0;if(!(3&r)||Pe(e,r)){if((t=r&-r)===e.callbackPriority)return t;switch(null!==n&&ae(n),Fe(r)){case 2:case 8:r=fe;break;case 32:default:r=pe;break;case 268435456:r=me}return n=Wu.bind(null,e),r=oe(r,n),e.callbackPriority=t,e.callbackNode=r,t}return null!==n&&null!==n&&ae(n),e.callbackPriority=2,e.callbackNode=null,2}function Wu(e,t){if(0!==zc&&5!==zc)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Su()&&e.callbackNode!==r)return null;var n=bc;return 0===(n=je(e,e===yc?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Qc(e,n,t),Uu(e,ue()),null!=e.callbackNode&&e.callbackNode===r?Wu.bind(null,e):null)}function Vu(e,t){if(Su())return null;Qc(e,t,!0)}function Hu(){if(0===Iu){var e=Hs;0===e&&(e=Ce,!(261888&(Ce<<=1))&&(Ce=256)),Iu=e}return Iu}function Gu(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Nt(""+e)}function Yu(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}for(var qu=0;qu<Tn.length;qu++){var Xu=Tn[qu];En(Xu.toLowerCase(),"on"+(Xu[0].toUpperCase()+Xu.slice(1)))}En(vn,"onAnimationEnd"),En(bn,"onAnimationIteration"),En(wn,"onAnimationStart"),En("dblclick","onDoubleClick"),En("focusin","onFocus"),En("focusout","onBlur"),En(xn,"onTransitionRun"),En(_n,"onTransitionStart"),En(Sn,"onTransitionCancel"),En(kn,"onTransitionEnd"),ot("onMouseEnter",["mouseout","mouseover"]),ot("onMouseLeave",["mouseout","mouseover"]),ot("onPointerEnter",["pointerout","pointerover"]),ot("onPointerLeave",["pointerout","pointerover"]),it("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),it("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),it("onBeforeInput",["compositionend","keypress","textInput","paste"]),it("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ju=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ku));function Qu(e,t){t=!!(4&t);for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;i=a,s.currentTarget=c;try{i(s)}catch(u){On(u)}s.currentTarget=null,i=l}else for(o=0;o<n.length;o++){if(l=(a=n[o]).instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;i=a,s.currentTarget=c;try{i(s)}catch(u){On(u)}s.currentTarget=null,i=l}}}}function Zu(e,t){var r=t[Ge];void 0===r&&(r=t[Ge]=new Set);var n=e+"__bubble";r.has(n)||(nh(t,e,2,!1),r.add(n))}function eh(e,t,r){var n=0;t&&(n|=4),nh(r,e,n,t)}var th="_reactListening"+Math.random().toString(36).slice(2);function rh(e){if(!e[th]){e[th]=!0,nt.forEach(function(t){"selectionchange"!==t&&(Ju.has(t)||eh(t,!1,e),eh(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[th]||(t[th]=!0,eh("selectionchange",!1,t))}}function nh(e,t,r,n){switch(jd(t)){case 2:var s=Sd;break;case 8:s=kd;break;default:s=Cd}r=s.bind(null,t,r,e),s=void 0,!Vt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),n?void 0!==s?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):void 0!==s?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function sh(e,t,r,n,s){var o=n;if(!(1&t||2&t||null===n))e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var l=n.stateNode.containerInfo;if(l===s)break;if(4===a)for(a=n.return;null!==a;){var c=a.tag;if((3===c||4===c)&&a.stateNode.containerInfo===s)return;a=a.return}for(;null!==l;){if(null===(a=Qe(l)))return;if(5===(c=a.tag)||6===c||26===c||27===c){n=o=a;continue e}l=l.parentNode}}n=n.return}Bt(function(){var n=o,s=Lt(r),a=[];e:{var l=Cn.get(e);if(void 0!==l){var c=sr,u=e;switch(e){case"keypress":if(0===Kt(r))break e;case"keydown":case"keyup":c=br;break;case"focusin":u="focus",c=ur;break;case"focusout":u="blur",c=ur;break;case"beforeblur":case"afterblur":c=ur;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=lr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=cr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=xr;break;case vn:case bn:case wn:c=hr;break;case kn:c=_r;break;case"scroll":case"scrollend":c=or;break;case"wheel":c=Sr;break;case"copy":case"cut":case"paste":c=dr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=wr;break;case"toggle":case"beforetoggle":c=kr}var h=!!(4&t),d=!h&&("scroll"===e||"scrollend"===e),f=h?null!==l?l+"Capture":null:l;h=[];for(var p,g=n;null!==g;){var m=g;if(p=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===p||null===f||null!=(m=Ut(g,f))&&h.push(ih(g,m,p)),d)break;g=g.return}0<h.length&&(l=new c(l,u,null,r,s),a.push({event:l,listeners:h}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||r===Rt||!(u=r.relatedTarget||r.fromElement)||!Qe(u)&&!u[He])&&(c||l)&&(l=s.window===s?s:(l=s.ownerDocument)?l.defaultView||l.parentWindow:window,c?(c=n,null!==(u=(u=r.relatedTarget||r.toElement)?Qe(u):null)&&(d=i(u),h=u.tag,u!==d||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=n),c!==u)){if(h=lr,m="onMouseLeave",f="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(h=wr,m="onPointerLeave",f="onPointerEnter",g="pointer"),d=null==c?l:et(c),p=null==u?l:et(u),(l=new h(m,g+"leave",c,r,s)).target=d,l.relatedTarget=p,m=null,Qe(s)===n&&((h=new h(f,g+"enter",u,r,s)).target=p,h.relatedTarget=d,m=h),d=m,c&&u)e:{for(h=ah,g=u,p=0,m=f=c;m;m=h(m))p++;m=0;for(var y=g;y;y=h(y))m++;for(;0<p-m;)f=h(f),p--;for(;0<m-p;)g=h(g),m--;for(;p--;){if(f===g||null!==g&&f===g.alternate){h=f;break e}f=h(f),g=h(g)}h=null}else h=null;null!==c&&lh(a,l,c,h,!1),null!==u&&null!==d&&lh(a,d,u,h,!0)}if("select"===(c=(l=n?et(n):window).nodeName&&l.nodeName.toLowerCase())||"input"===c&&"file"===l.type)var v=Ur;else if(Lr(l))if(Wr)v=Qr;else{v=Kr;var b=Xr}else!(c=l.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==l.type&&"radio"!==l.type?n&&Pt(n.elementType)&&(v=Ur):v=Jr;switch(v&&(v=v(e,n))?Ir(a,v,r,s):(b&&b(e,l,n),"focusout"===e&&n&&"number"===l.type&&null!=n.memoizedProps.value&&_t(l,"number",l.value)),b=n?et(n):window,e){case"focusin":(Lr(b)||"true"===b.contentEditable)&&(ln=b,cn=n,un=null);break;case"focusout":un=cn=ln=null;break;case"mousedown":hn=!0;break;case"contextmenu":case"mouseup":case"dragend":hn=!1,dn(a,r,s);break;case"selectionchange":if(an)break;case"keydown":case"keyup":dn(a,r,s)}var w;if(Tr)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Mr?Dr(e,r)&&(x="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(x="onCompositionStart");x&&(jr&&"ko"!==r.locale&&(Mr||"onCompositionStart"!==x?"onCompositionEnd"===x&&Mr&&(w=Xt()):(Yt="value"in(Gt=s)?Gt.value:Gt.textContent,Mr=!0)),0<(b=oh(n,x)).length&&(x=new fr(x,e,null,r,s),a.push({event:x,listeners:b}),w?x.data=w:null!==(w=Nr(r))&&(x.data=w))),(w=Or?function(e,t){switch(e){case"compositionend":return Nr(t);case"keypress":return 32!==t.which?null:(Ar=!0,Pr);case"textInput":return(e=t.data)===Pr&&Ar?null:e;default:return null}}(e,r):function(e,t){if(Mr)return"compositionend"===e||!Tr&&Dr(e,t)?(e=Xt(),qt=Yt=Gt=null,Mr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(x=oh(n,"onBeforeInput")).length&&(b=new fr("onBeforeInput","beforeinput",null,r,s),a.push({event:b,listeners:x}),b.data=w)),function(e,t,r,n,s){if("submit"===t&&r&&r.stateNode===s){var i=Gu((s[Ve]||null).action),o=n.submitter;o&&null!==(t=(t=o[Ve]||null)?Gu(t.formAction):o.getAttribute("formAction"))&&(i=t,o=null);var a=new sr("action","action",null,n,s);e.push({event:a,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==Iu){var e=o?Yu(s,o):new FormData(s);na(r,{pending:!0,data:e,method:s.method,action:i},null,e)}}else"function"==typeof i&&(a.preventDefault(),e=o?Yu(s,o):new FormData(s),na(r,{pending:!0,data:e,method:s.method,action:i},i,e))},currentTarget:s}]})}}(a,e,n,r,s)}Qu(a,t)})}function ih(e,t,r){return{instance:e,listener:t,currentTarget:r}}function oh(e,t){for(var r=t+"Capture",n=[];null!==e;){var s=e,i=s.stateNode;if(5!==(s=s.tag)&&26!==s&&27!==s||null===i||(null!=(s=Ut(e,r))&&n.unshift(ih(e,s,i)),null!=(s=Ut(e,t))&&n.push(ih(e,s,i))),3===e.tag)return n;e=e.return}return[]}function ah(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function lh(e,t,r,n,s){for(var i=t._reactName,o=[];null!==r&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===n)break;5!==a&&26!==a&&27!==a||null===c||(l=c,s?null!=(c=Ut(r,i))&&o.unshift(ih(r,c,l)):s||null!=(c=Ut(r,i))&&o.push(ih(r,c,l))),r=r.return}0!==o.length&&e.push({event:t,listeners:o})}var ch=/\r\n?/g,uh=/\u0000|\uFFFD/g;function hh(e){return("string"==typeof e?e:""+e).replace(ch,"\n").replace(uh,"")}function dh(e,t){return t=hh(t),hh(e)===t}function fh(e,t,r,s,i,o){switch(r){case"children":"string"==typeof s?"body"===t||"textarea"===t&&""===s||Tt(e,s):("number"==typeof s||"bigint"==typeof s)&&"body"!==t&&Tt(e,""+s);break;case"className":ht(e,"class",s);break;case"tabIndex":ht(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":ht(e,r,s);break;case"style":jt(e,s,o);break;case"data":if("object"!==t){ht(e,"data",s);break}case"src":case"href":if(""===s&&("a"!==t||"href"!==r)){e.removeAttribute(r);break}if(null==s||"function"==typeof s||"symbol"==typeof s||"boolean"==typeof s){e.removeAttribute(r);break}s=Nt(""+s),e.setAttribute(r,s);break;case"action":case"formAction":if("function"==typeof s){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof o&&("formAction"===r?("input"!==t&&fh(e,t,"name",i.name,i,null),fh(e,t,"formEncType",i.formEncType,i,null),fh(e,t,"formMethod",i.formMethod,i,null),fh(e,t,"formTarget",i.formTarget,i,null)):(fh(e,t,"encType",i.encType,i,null),fh(e,t,"method",i.method,i,null),fh(e,t,"target",i.target,i,null))),null==s||"symbol"==typeof s||"boolean"==typeof s){e.removeAttribute(r);break}s=Nt(""+s),e.setAttribute(r,s);break;case"onClick":null!=s&&(e.onclick=Mt);break;case"onScroll":null!=s&&Zu("scroll",e);break;case"onScrollEnd":null!=s&&Zu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=s){if("object"!=typeof s||!("__html"in s))throw Error(n(61));if(null!=(r=s.__html)){if(null!=i.children)throw Error(n(60));e.innerHTML=r}}break;case"multiple":e.multiple=s&&"function"!=typeof s&&"symbol"!=typeof s;break;case"muted":e.muted=s&&"function"!=typeof s&&"symbol"!=typeof s;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==s||"function"==typeof s||"boolean"==typeof s||"symbol"==typeof s){e.removeAttribute("xlink:href");break}r=Nt(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=s&&"function"!=typeof s&&"symbol"!=typeof s?e.setAttribute(r,""+s):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&"function"!=typeof s&&"symbol"!=typeof s?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":!0===s?e.setAttribute(r,""):!1!==s&&null!=s&&"function"!=typeof s&&"symbol"!=typeof s?e.setAttribute(r,s):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&!isNaN(s)&&1<=s?e.setAttribute(r,s):e.removeAttribute(r);break;case"rowSpan":case"start":null==s||"function"==typeof s||"symbol"==typeof s||isNaN(s)?e.removeAttribute(r):e.setAttribute(r,s);break;case"popover":Zu("beforetoggle",e),Zu("toggle",e),ut(e,"popover",s);break;case"xlinkActuate":dt(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":dt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":dt(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":dt(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":dt(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":dt(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":dt(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":dt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":dt(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":ut(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<r.length)||"o"!==r[0]&&"O"!==r[0]||"n"!==r[1]&&"N"!==r[1])&&ut(e,r=At.get(r)||r,s)}}function ph(e,t,r,s,i,o){switch(r){case"style":jt(e,s,o);break;case"dangerouslySetInnerHTML":if(null!=s){if("object"!=typeof s||!("__html"in s))throw Error(n(61));if(null!=(r=s.__html)){if(null!=i.children)throw Error(n(60));e.innerHTML=r}}break;case"children":"string"==typeof s?Tt(e,s):("number"==typeof s||"bigint"==typeof s)&&Tt(e,""+s);break;case"onScroll":null!=s&&Zu("scroll",e);break;case"onScrollEnd":null!=s&&Zu("scrollend",e);break;case"onClick":null!=s&&(e.onclick=Mt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:st.hasOwnProperty(r)||("o"!==r[0]||"n"!==r[1]||(i=r.endsWith("Capture"),t=r.slice(2,i?r.length-7:void 0),"function"==typeof(o=null!=(o=e[Ve]||null)?o[r]:null)&&e.removeEventListener(t,o,i),"function"!=typeof s)?r in e?e[r]=s:!0===s?e.setAttribute(r,""):ut(e,r,s):("function"!=typeof o&&null!==o&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,s,i)))}}function gh(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Zu("error",e),Zu("load",e);var s,i=!1,o=!1;for(s in r)if(r.hasOwnProperty(s)){var a=r[s];if(null!=a)switch(s){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,t));default:fh(e,t,s,a,r,null)}}return o&&fh(e,t,"srcSet",r.srcSet,r,null),void(i&&fh(e,t,"src",r.src,r,null));case"input":Zu("invalid",e);var l=s=a=o=null,c=null,u=null;for(i in r)if(r.hasOwnProperty(i)){var h=r[i];if(null!=h)switch(i){case"name":o=h;break;case"type":a=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":s=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(n(137,t));break;default:fh(e,t,i,h,r,null)}}return void xt(e,s,l,c,u,a,o,!1);case"select":for(o in Zu("invalid",e),i=a=s=null,r)if(r.hasOwnProperty(o)&&null!=(l=r[o]))switch(o){case"value":s=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:fh(e,t,o,l,r,null)}return t=s,r=a,e.multiple=!!i,void(null!=t?St(e,!!i,t,!1):null!=r&&St(e,!!i,r,!0));case"textarea":for(a in Zu("invalid",e),s=o=i=null,r)if(r.hasOwnProperty(a)&&null!=(l=r[a]))switch(a){case"value":i=l;break;case"defaultValue":o=l;break;case"children":s=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(n(91));break;default:fh(e,t,a,l,r,null)}return void Ct(e,i,o,s);case"option":for(c in r)if(r.hasOwnProperty(c)&&null!=(i=r[c]))if("selected"===c)e.selected=i&&"function"!=typeof i&&"symbol"!=typeof i;else fh(e,t,c,i,r,null);return;case"dialog":Zu("beforetoggle",e),Zu("toggle",e),Zu("cancel",e),Zu("close",e);break;case"iframe":case"object":Zu("load",e);break;case"video":case"audio":for(i=0;i<Ku.length;i++)Zu(Ku[i],e);break;case"image":Zu("error",e),Zu("load",e);break;case"details":Zu("toggle",e);break;case"embed":case"source":case"link":Zu("error",e),Zu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in r)if(r.hasOwnProperty(u)&&null!=(i=r[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,t));default:fh(e,t,u,i,r,null)}return;default:if(Pt(t)){for(h in r)r.hasOwnProperty(h)&&(void 0!==(i=r[h])&&ph(e,t,h,i,r,void 0));return}}for(l in r)r.hasOwnProperty(l)&&(null!=(i=r[l])&&fh(e,t,l,i,r,null))}function mh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var yh=null,vh=null;function bh(e){return 9===e.nodeType?e:e.ownerDocument}function wh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function xh(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function _h(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Sh=null;var kh="function"==typeof setTimeout?setTimeout:void 0,Ch="function"==typeof clearTimeout?clearTimeout:void 0,Th="function"==typeof Promise?Promise:void 0,Eh="function"==typeof queueMicrotask?queueMicrotask:void 0!==Th?function(e){return Th.resolve(null).then(e).catch(Oh)}:kh;function Oh(e){setTimeout(function(){throw e})}function jh(e){return"head"===e}function Ph(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&8===s.nodeType)if("/$"===(r=s.data)||"/&"===r){if(0===n)return e.removeChild(s),void Yd(t);n--}else if("$"===r||"$?"===r||"$~"===r||"$!"===r||"&"===r)n++;else if("html"===r)Bh(e.ownerDocument.documentElement);else if("head"===r){Bh(r=e.ownerDocument.head);for(var i=r.firstChild;i;){var o=i.nextSibling,a=i.nodeName;i[Ke]||"SCRIPT"===a||"STYLE"===a||"LINK"===a&&"stylesheet"===i.rel.toLowerCase()||r.removeChild(i),i=o}}else"body"===r&&Bh(e.ownerDocument.body);r=s}while(r);Yd(t)}function Ah(e,t){var r=e;e=0;do{var n=r.nextSibling;if(1===r.nodeType?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",""===r.getAttribute("style")&&r.removeAttribute("style")):3===r.nodeType&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),n&&8===n.nodeType)if("/$"===(r=n.data)){if(0===e)break;e--}else"$"!==r&&"$?"!==r&&"$~"!==r&&"$!"!==r||e++;r=n}while(r)}function Dh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Dh(r),Je(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===r.rel.toLowerCase())continue}e.removeChild(r)}}function Nh(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Lh(e.nextSibling)))return null}return e}function Mh(e){return"$?"===e.data||"$~"===e.data}function Rh(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Lh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Ih=null;function $h(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r||"/&"===r){if(0===t)return Lh(e.nextSibling);t--}else"$"!==r&&"$!"!==r&&"$?"!==r&&"$~"!==r&&"&"!==r||t++}e=e.nextSibling}return null}function Fh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r||"$~"===r||"&"===r){if(0===t)return e;t--}else"/$"!==r&&"/&"!==r||t++}e=e.previousSibling}return null}function zh(e,t,r){switch(t=bh(r),e){case"html":if(!(e=t.documentElement))throw Error(n(452));return e;case"head":if(!(e=t.head))throw Error(n(453));return e;case"body":if(!(e=t.body))throw Error(n(454));return e;default:throw Error(n(451))}}function Bh(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Je(e)}var Uh=new Map,Wh=new Set;function Vh(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Hh=I.d;I.d={f:function(){var e=Hh.f(),t=ru();return e||t},r:function(e){var t=Ze(e);null!==t&&5===t.tag&&"form"===t.type?ia(t):Hh.r(e)},D:function(e){Hh.D(e),Yh("dns-prefetch",e,null)},C:function(e,t){Hh.C(e,t),Yh("preconnect",e,t)},L:function(e,t,r){Hh.L(e,t,r);var n=Gh;if(n&&e&&t){var s='link[rel="preload"][as="'+bt(t)+'"]';"image"===t&&r&&r.imageSrcSet?(s+='[imagesrcset="'+bt(r.imageSrcSet)+'"]',"string"==typeof r.imageSizes&&(s+='[imagesizes="'+bt(r.imageSizes)+'"]')):s+='[href="'+bt(e)+'"]';var i=s;switch(t){case"style":i=Xh(e);break;case"script":i=Qh(e)}Uh.has(i)||(e=u({rel:"preload",href:"image"===t&&r&&r.imageSrcSet?void 0:e,as:t},r),Uh.set(i,e),null!==n.querySelector(s)||"style"===t&&n.querySelector(Kh(i))||"script"===t&&n.querySelector(Zh(i))||(gh(t=n.createElement("link"),"link",e),rt(t),n.head.appendChild(t)))}},m:function(e,t){Hh.m(e,t);var r=Gh;if(r&&e){var n=t&&"string"==typeof t.as?t.as:"script",s='link[rel="modulepreload"][as="'+bt(n)+'"][href="'+bt(e)+'"]',i=s;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Qh(e)}if(!Uh.has(i)&&(e=u({rel:"modulepreload",href:e},t),Uh.set(i,e),null===r.querySelector(s))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Zh(i)))return}gh(n=r.createElement("link"),"link",e),rt(n),r.head.appendChild(n)}}},X:function(e,t){Hh.X(e,t);var r=Gh;if(r&&e){var n=tt(r).hoistableScripts,s=Qh(e),i=n.get(s);i||((i=r.querySelector(Zh(s)))||(e=u({src:e,async:!0},t),(t=Uh.get(s))&&nd(e,t),rt(i=r.createElement("script")),gh(i,"link",e),r.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},n.set(s,i))}},S:function(e,t,r){Hh.S(e,t,r);var n=Gh;if(n&&e){var s=tt(n).hoistableStyles,i=Xh(e);t=t||"default";var o=s.get(i);if(!o){var a={loading:0,preload:null};if(o=n.querySelector(Kh(i)))a.loading=5;else{e=u({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Uh.get(i))&&rd(e,r);var l=o=n.createElement("link");rt(l),gh(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,td(o,t,n)}o={type:"stylesheet",instance:o,count:1,state:a},s.set(i,o)}}},M:function(e,t){Hh.M(e,t);var r=Gh;if(r&&e){var n=tt(r).hoistableScripts,s=Qh(e),i=n.get(s);i||((i=r.querySelector(Zh(s)))||(e=u({src:e,async:!0,type:"module"},t),(t=Uh.get(s))&&nd(e,t),rt(i=r.createElement("script")),gh(i,"link",e),r.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},n.set(s,i))}}};var Gh="undefined"==typeof document?null:document;function Yh(e,t,r){var n=Gh;if(n&&"string"==typeof t&&t){var s=bt(t);s='link[rel="'+e+'"][href="'+s+'"]',"string"==typeof r&&(s+='[crossorigin="'+r+'"]'),Wh.has(s)||(Wh.add(s),e={rel:e,crossOrigin:r,href:t},null===n.querySelector(s)&&(gh(t=n.createElement("link"),"link",e),rt(t),n.head.appendChild(t)))}}function qh(e,t,r,s){var i,o,a,l,c=(c=q.current)?Vh(c):null;if(!c)throw Error(n(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof r.precedence&&"string"==typeof r.href?(t=Xh(r.href),(s=(r=tt(c).hoistableStyles).get(t))||(s={type:"style",instance:null,count:0,state:null},r.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===r.rel&&"string"==typeof r.href&&"string"==typeof r.precedence){e=Xh(r.href);var u=tt(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(Kh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),Uh.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Uh.set(e,r),u||(i=c,o=e,a=r,l=h.state,i.querySelector('link[rel="preload"][as="style"]['+o+"]")?l.loading=1:(o=i.createElement("link"),l.preload=o,o.addEventListener("load",function(){return l.loading|=1}),o.addEventListener("error",function(){return l.loading|=2}),gh(o,"link",a),rt(o),i.head.appendChild(o))))),t&&null===s)throw Error(n(528,""));return h}if(t&&null!==s)throw Error(n(529,""));return null;case"script":return t=r.async,"string"==typeof(r=r.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Qh(r),(s=(r=tt(c).hoistableScripts).get(t))||(s={type:"script",instance:null,count:0,state:null},r.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,e))}}function Xh(e){return'href="'+bt(e)+'"'}function Kh(e){return'link[rel="stylesheet"]['+e+"]"}function Jh(e){return u({},e,{"data-precedence":e.precedence,precedence:null})}function Qh(e){return'[src="'+bt(e)+'"]'}function Zh(e){return"script[async]"+e}function ed(e,t,r){if(t.count++,null===t.instance)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+bt(r.href)+'"]');if(s)return t.instance=s,rt(s),s;var i=u({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return rt(s=(e.ownerDocument||e).createElement("style")),gh(s,"style",i),td(s,r.precedence,e),t.instance=s;case"stylesheet":i=Xh(r.href);var o=e.querySelector(Kh(i));if(o)return t.state.loading|=4,t.instance=o,rt(o),o;s=Jh(r),(i=Uh.get(i))&&rd(s,i),rt(o=(e.ownerDocument||e).createElement("link"));var a=o;return a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),gh(o,"link",s),t.state.loading|=4,td(o,r.precedence,e),t.instance=o;case"script":return o=Qh(r.src),(i=e.querySelector(Zh(o)))?(t.instance=i,rt(i),i):(s=r,(i=Uh.get(o))&&nd(s=u({},r),i),rt(i=(e=e.ownerDocument||e).createElement("script")),gh(i,"link",s),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(n(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(s=t.instance,t.state.loading|=4,td(s,r.precedence,e));return t.instance}function td(e,t,r){for(var n=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=n.length?n[n.length-1]:null,i=s,o=0;o<n.length;o++){var a=n[o];if(a.dataset.precedence===t)i=a;else if(i!==s)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===r.nodeType?r.head:r).insertBefore(e,t.firstChild)}function rd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function nd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var sd=null;function id(e,t,r){if(null===sd){var n=new Map,s=sd=new Map;s.set(r,n)}else(n=(s=sd).get(r))||(n=new Map,s.set(r,n));if(n.has(e))return n;for(n.set(e,null),r=r.getElementsByTagName(e),s=0;s<r.length;s++){var i=r[s];if(!(i[Ke]||i[We]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var o=i.getAttribute(t)||"";o=e+o;var a=n.get(o);a?a.push(i):n.set(o,[i])}}return n}function od(e,t,r){(e=e.ownerDocument||e).head.insertBefore(r,"title"===t?e.querySelector("head > title"):null)}function ad(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var ld=0;function cd(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)hd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var ud=null;function hd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,ud=new Map,t.forEach(dd,e),ud=null,cd.call(e))}function dd(e,t){if(!(4&t.state.loading)){var r=ud.get(e);if(r)var n=r.get(null);else{r=new Map,ud.set(e,r);for(var s=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<s.length;i++){var o=s[i];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(r.set(o.dataset.precedence,o),n=o)}n&&r.set(null,n)}o=(s=t.instance).getAttribute("data-precedence"),(i=r.get(o)||n)===n&&r.set(null,s),r.set(o,s),this.count++,n=cd.bind(this),s.addEventListener("load",n),s.addEventListener("error",n),i?i.parentNode.insertBefore(s,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(s,e.firstChild),t.state.loading|=4}}var fd={$$typeof:w,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function pd(e,t,r,n,s,i,o,a,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ne(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ne(0),this.hiddenUpdates=Ne(null),this.identifierPrefix=n,this.onUncaughtError=s,this.onCaughtError=i,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function gd(e,t,r,n,s,i,o,a,l,c,u,h){return e=new pd(e,t,r,o,l,c,u,h,a),t=1,!0===i&&(t|=24),i=zn(3,null,null,t),e.current=i,i.stateNode=e,(t=Bs()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:n,isDehydrated:r,cache:t},vi(i),e}function md(e){return e?e=$n:$n}function yd(e,t,r,n,s,i){s=md(s),null===n.context?n.context=s:n.pendingContext=s,(n=wi(t)).payload={element:r},null!==(i=void 0===i?null:i)&&(n.callback=i),null!==(r=xi(e,n,t))&&(Jc(r,0,t),_i(r,e,t))}function vd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function bd(e,t){vd(e,t),(e=e.alternate)&&vd(e,t)}function wd(e){if(13===e.tag||31===e.tag){var t=Rn(e,67108864);null!==t&&Jc(t,0,67108864),bd(e,67108864)}}function xd(e){if(13===e.tag||31===e.tag){var t=Xc(),r=Rn(e,t=$e(t));null!==r&&Jc(r,0,t),bd(e,t)}}var _d=!0;function Sd(e,t,r,n){var s=L.T;L.T=null;var i=I.p;try{I.p=2,Cd(e,t,r,n)}finally{I.p=i,L.T=s}}function kd(e,t,r,n){var s=L.T;L.T=null;var i=I.p;try{I.p=8,Cd(e,t,r,n)}finally{I.p=i,L.T=s}}function Cd(e,t,r,n){if(_d){var s=Td(n);if(null===s)sh(e,t,n,Ed,r),$d(e,n);else if(function(e,t,r,n,s){switch(t){case"focusin":return Ad=Fd(Ad,e,t,r,n,s),!0;case"dragenter":return Dd=Fd(Dd,e,t,r,n,s),!0;case"mouseover":return Nd=Fd(Nd,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Md.set(i,Fd(Md.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Rd.set(i,Fd(Rd.get(i)||null,e,t,r,n,s)),!0}return!1}(s,e,t,r,n))n.stopPropagation();else if($d(e,n),4&t&&-1<Id.indexOf(e)){for(;null!==s;){var i=Ze(s);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var o=Oe(i.pendingLanes);if(0!==o){var a=i;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-_e(o);a.entanglements[1]|=l,o&=~l}$u(i),!(6&mc)&&(Ic=ue()+500,Fu(0))}}break;case 31:case 13:null!==(a=Rn(i,2))&&Jc(a,0,2),ru(),bd(i,2)}if(null===(i=Td(n))&&sh(e,t,n,Ed,r),i===s)break;s=i}null!==s&&n.stopPropagation()}else sh(e,t,n,null,r)}}function Td(e){return Od(e=Lt(e))}var Ed=null;function Od(e){if(Ed=null,null!==(e=Qe(e))){var t=i(e);if(null===t)e=null;else{var r=t.tag;if(13===r){if(null!==(e=o(t)))return e;e=null}else if(31===r){if(null!==(e=a(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ed=e,null}function jd(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(he()){case de:return 2;case fe:return 8;case pe:case ge:return 32;case me:return 268435456;default:return 32}default:return 32}}var Pd=!1,Ad=null,Dd=null,Nd=null,Md=new Map,Rd=new Map,Ld=[],Id="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $d(e,t){switch(e){case"focusin":case"focusout":Ad=null;break;case"dragenter":case"dragleave":Dd=null;break;case"mouseover":case"mouseout":Nd=null;break;case"pointerover":case"pointerout":Md.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rd.delete(t.pointerId)}}function Fd(e,t,r,n,s,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},null!==t&&(null!==(t=Ze(t))&&wd(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function zd(e){var t=Qe(e.target);if(null!==t){var r=i(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=o(r)))return e.blockedOn=t,void Be(e.priority,function(){xd(r)})}else if(31===t){if(null!==(t=a(r)))return e.blockedOn=t,void Be(e.priority,function(){xd(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Bd(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Td(e.nativeEvent);if(null!==r)return null!==(t=Ze(r))&&wd(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);Rt=n,r.target.dispatchEvent(n),Rt=null,t.shift()}return!0}function Ud(e,t,r){Bd(e)&&r.delete(t)}function Wd(){Pd=!1,null!==Ad&&Bd(Ad)&&(Ad=null),null!==Dd&&Bd(Dd)&&(Dd=null),null!==Nd&&Bd(Nd)&&(Nd=null),Md.forEach(Ud),Rd.forEach(Ud)}function Vd(t,r){t.blockedOn===r&&(t.blockedOn=null,Pd||(Pd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Wd)))}var Hd=null;function Gd(t){Hd!==t&&(Hd=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Hd===t&&(Hd=null);for(var e=0;e<t.length;e+=3){var r=t[e],n=t[e+1],s=t[e+2];if("function"!=typeof n){if(null===Od(n||r))continue;break}var i=Ze(r);null!==i&&(t.splice(e,3),e-=3,na(i,{pending:!0,data:s,method:r.method,action:n},n,s))}}))}function Yd(e){function t(t){return Vd(t,e)}null!==Ad&&Vd(Ad,e),null!==Dd&&Vd(Dd,e),null!==Nd&&Vd(Nd,e),Md.forEach(t),Rd.forEach(t);for(var r=0;r<Ld.length;r++){var n=Ld[r];n.blockedOn===e&&(n.blockedOn=null)}for(;0<Ld.length&&null===(r=Ld[0]).blockedOn;)zd(r),null===r.blockedOn&&Ld.shift();if(null!=(r=(e.ownerDocument||e).$$reactFormReplay))for(n=0;n<r.length;n+=3){var s=r[n],i=r[n+1],o=s[Ve]||null;if("function"==typeof i)o||Gd(r);else if(o){var a=null;if(i&&i.hasAttribute("formAction")){if(s=i,o=i[Ve]||null)a=o.formAction;else if(null!==Od(s))continue}else a=o.action;"function"==typeof a?r[n+1]=a:(r.splice(n,3),n-=3),Gd(r)}}}function qd(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return s=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==s&&(s(),s=null),n||setTimeout(r,20)}function r(){if(!n&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"==typeof navigation){var n=!1,s=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){n=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==s&&(s(),s=null)}}}function Xd(e){this._internalRoot=e}function Kd(e){this._internalRoot=e}Kd.prototype.render=Xd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(n(409));yd(t.current,Xc(),e,t,null,null)},Kd.prototype.unmount=Xd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;yd(e.current,2,null,e,null,null),ru(),t[He]=null}},Kd.prototype.unstable_scheduleHydration=function(e){if(e){var t=ze();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ld.length&&0!==t&&t<Ld[r].priority;r++);Ld.splice(r,0,e),0===r&&zd(e)}};var Jd=t.version;if("19.2.3"!==Jd)throw Error(n(527,Jd,"19.2.3"));I.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(n(188));throw e=Object.keys(e).join(","),Error(n(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=i(e)))throw Error(n(188));return t!==e?null:e}for(var r=e,s=t;;){var o=r.return;if(null===o)break;var a=o.alternate;if(null===a){if(null!==(s=o.return)){r=s;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===r)return l(o),e;if(a===s)return l(o),t;a=a.sibling}throw Error(n(188))}if(r.return!==s.return)r=o,s=a;else{for(var c=!1,u=o.child;u;){if(u===r){c=!0,r=o,s=a;break}if(u===s){c=!0,s=o,r=a;break}u=u.sibling}if(!c){for(u=a.child;u;){if(u===r){c=!0,r=a,s=o;break}if(u===s){c=!0,s=a,r=o;break}u=u.sibling}if(!c)throw Error(n(189))}}if(r.alternate!==s)throw Error(n(190))}if(3!==r.tag)throw Error(n(188));return r.stateNode.current===r?e:t}(t),e=null===(e=null!==e?c(e):null)?null:e.stateNode};var Qd={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.3"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zd.isDisabled&&Zd.supportsFiber)try{be=Zd.inject(Qd),we=Zd}catch(ef){}}return v.createRoot=function(e,t){if(!s(e))throw Error(n(299));var r=!1,i="",o=Ta,a=Ea,l=Oa;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(o=t.onUncaughtError),void 0!==t.onCaughtError&&(a=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=gd(e,1,!1,null,0,r,i,null,o,a,l,qd),e[He]=t.current,rh(e),new Xd(t)},v.hydrateRoot=function(e,t,r){if(!s(e))throw Error(n(299));var i=!1,o="",a=Ta,l=Ea,c=Oa,u=null;return null!=r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(o=r.identifierPrefix),void 0!==r.onUncaughtError&&(a=r.onUncaughtError),void 0!==r.onCaughtError&&(l=r.onCaughtError),void 0!==r.onRecoverableError&&(c=r.onRecoverableError),void 0!==r.formState&&(u=r.formState)),(t=gd(e,1,!0,t,0,i,o,u,a,l,c,qd)).context=md(null),r=t.current,(o=wi(i=$e(i=Xc()))).callback=null,xi(r,o,i),r=i,t.current.lanes=r,Me(t,r),$u(t),e[He]=t.current,rh(e),new Kd(t)},v.version="19.2.3",v}var A=(C||(C=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),y.exports=P()),y.exports);const D=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},N=(...e)=>e.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),M=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var R={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const L=f.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:o,...a},l)=>f.createElement("svg",{ref:l,...R,width:t,height:t,stroke:e,strokeWidth:n?24*Number(r)/Number(t):r,className:N("lucide",s),...!i&&!M(a)&&{"aria-hidden":"true"},...a},[...o.map(([e,t])=>f.createElement(e,t)),...Array.isArray(i)?i:[i]])),I=(e,t)=>{const r=f.forwardRef(({className:r,...n},s)=>{return f.createElement(L,{ref:s,iconNode:t,className:N(`lucide-${i=D(e),i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...n});var i});return r.displayName=D(e),r},$=I("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),F=I("cat",[["path",{d:"M12 5c.67 0 1.35.09 2 .26 1.78-2 5.03-2.84 6.42-2.26 1.4.58-.42 7-.42 7 .57 1.07 1 2.24 1 3.44C21 17.9 16.97 21 12 21s-9-3-9-7.56c0-1.25.5-2.4 1-3.44 0 0-1.89-6.42-.5-7 1.39-.58 4.72.23 6.5 2.23A9.04 9.04 0 0 1 12 5Z",key:"x6xyqk"}],["path",{d:"M8 14v.5",key:"1nzgdb"}],["path",{d:"M16 14v.5",key:"1lajdz"}],["path",{d:"M11.25 16.25h1.5L12 17l-.75-.75Z",key:"12kq1m"}]]),z=I("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),B=I("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),U=I("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),W=I("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),V=I("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),H=I("flower-2",[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]]),G=I("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),Y=I("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),q=I("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),X=I("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),K=I("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),J=I("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),Q=I("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Z=I("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),ee=I("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),te=I("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),re=I("waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),ne=I("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function se(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function ie(...e){return t=>{let r=!1;const n=e.map(e=>{const n=se(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){const r=n[t];"function"==typeof r?r():se(e[t],null)}}}}function oe(...e){return f.useCallback(ie(...e),e)}var ae=Symbol.for("react.lazy"),le=p[" use ".trim().toString()];function ce(e){return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===ae&&"_payload"in e&&("object"==typeof(t=e._payload)&&null!==t&&"then"in t);var t}function ue(e){const t=de(e),r=f.forwardRef((e,r)=>{let{children:n,...s}=e;ce(n)&&"function"==typeof le&&(n=le(n._payload));const i=f.Children.toArray(n),o=i.find(pe);if(o){const e=o.props.children,n=i.map(t=>t===o?f.Children.count(e)>1?f.Children.only(null):f.isValidElement(e)?e.props.children:null:t);return l.jsx(t,{...s,ref:r,children:f.isValidElement(e)?f.cloneElement(e,void 0,n):null})}return l.jsx(t,{...s,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}var he=ue("Slot");function de(e){const t=f.forwardRef((e,t)=>{let{children:r,...n}=e;if(ce(r)&&"function"==typeof le&&(r=le(r._payload)),f.isValidElement(r)){const e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;if(r)return e.ref;if(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r)return e.props.ref;return e.props.ref||e.ref}(r),s=function(e,t){const r={...t};for(const n in t){const s=e[n],i=t[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...e)=>{const t=i(...e);return s(...e),t}:s&&(r[n]=s):"style"===n?r[n]={...s,...i}:"className"===n&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==f.Fragment&&(s.ref=t?ie(t,e):e),f.cloneElement(r,s)}return f.Children.count(r)>1?f.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var fe=Symbol("radix.slottable");function pe(e){return f.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===fe}function ge(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=ge(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function me(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=ge(e))&&(n&&(n+=" "),n+=t);return n}const ye=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,ve=me,be=(e=new Map,t=null,r)=>({nextPart:e,validators:t,classGroupId:r}),we="-",xe=[],_e=e=>{const t=Ce(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:e=>{if(e.startsWith("[")&&e.endsWith("]"))return ke(e);const r=e.split(we),n=""===r[0]&&r.length>1?1:0;return Se(r,n,t)},getConflictingClassGroupIds:(e,t)=>{if(t){const t=n[e],s=r[e];return t?s?((e,t)=>{const r=new Array(e.length+t.length);for(let n=0;n<e.length;n++)r[n]=e[n];for(let n=0;n<t.length;n++)r[e.length+n]=t[n];return r})(s,t):t:s||xe}return r[e]||xe}}},Se=(e,t,r)=>{if(0===e.length-t)return r.classGroupId;const n=e[t],s=r.nextPart.get(n);if(s){const r=Se(e,t+1,s);if(r)return r}const i=r.validators;if(null===i)return;const o=0===t?e.join(we):e.slice(t).join(we),a=i.length;for(let l=0;l<a;l++){const e=i[l];if(e.validator(o))return e.classGroupId}},ke=e=>-1===e.slice(1,-1).indexOf(":")?void 0:(()=>{const t=e.slice(1,-1),r=t.indexOf(":"),n=t.slice(0,r);return n?"arbitrary.."+n:void 0})(),Ce=e=>{const{theme:t,classGroups:r}=e;return Te(r,t)},Te=(e,t)=>{const r=be();for(const n in e){const s=e[n];Ee(s,r,n,t)}return r},Ee=(e,t,r,n)=>{const s=e.length;for(let i=0;i<s;i++){const s=e[i];Oe(s,t,r,n)}},Oe=(e,t,r,n)=>{"string"!=typeof e?"function"!=typeof e?Ae(e,t,r,n):Pe(e,t,r,n):je(e,t,r)},je=(e,t,r)=>{(""===e?t:De(t,e)).classGroupId=r},Pe=(e,t,r,n)=>{Ne(e)?Ee(e(n),t,r,n):(null===t.validators&&(t.validators=[]),t.validators.push(((e,t)=>({classGroupId:e,validator:t}))(r,e)))},Ae=(e,t,r,n)=>{const s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[e,i]=s[o];Ee(i,De(t,e),r,n)}},De=(e,t)=>{let r=e;const n=t.split(we),s=n.length;for(let i=0;i<s;i++){const e=n[i];let t=r.nextPart.get(e);t||(t=be(),r.nextPart.set(e,t)),r=t}return r},Ne=e=>"isThemeGetter"in e&&!0===e.isThemeGetter,Me=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=Object.create(null),n=Object.create(null);const s=(s,i)=>{r[s]=i,t++,t>e&&(t=0,n=r,r=Object.create(null))};return{get(e){let t=r[e];return void 0!==t?t:void 0!==(t=n[e])?(s(e,t),t):void 0},set(e,t){e in r?r[e]=t:s(e,t)}}},Re=[],Le=(e,t,r,n,s)=>({modifiers:e,hasImportantModifier:t,baseClassName:r,maybePostfixModifierPosition:n,isExternal:s}),Ie=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=e=>{const t=[];let r,n=0,s=0,i=0;const o=e.length;for(let u=0;u<o;u++){const o=e[u];if(0===n&&0===s){if(":"===o){t.push(e.slice(i,u)),i=u+1;continue}if("/"===o){r=u;continue}}"["===o?n++:"]"===o?n--:"("===o?s++:")"===o&&s--}const a=0===t.length?e:e.slice(i);let l=a,c=!1;a.endsWith("!")?(l=a.slice(0,-1),c=!0):a.startsWith("!")&&(l=a.slice(1),c=!0);return Le(t,c,l,r&&r>i?r-i:void 0)};if(t){const e=t+":",r=n;n=t=>t.startsWith(e)?r(t.slice(e.length)):Le(Re,!1,t,void 0,!0)}if(r){const e=n;n=t=>r({className:t,parseClassName:e})}return n},$e=e=>{const t=new Map;return e.orderSensitiveModifiers.forEach((e,r)=>{t.set(e,1e6+r)}),e=>{const r=[];let n=[];for(let s=0;s<e.length;s++){const i=e[s],o="["===i[0],a=t.has(i);o||a?(n.length>0&&(n.sort(),r.push(...n),n=[]),r.push(i)):n.push(i)}return n.length>0&&(n.sort(),r.push(...n)),r}},Fe=/\s+/,ze=e=>{if("string"==typeof e)return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=ze(e[n]))&&(r&&(r+=" "),r+=t);return r},Be=(e,...t)=>{let r,n,s,i;const o=e=>{const t=n(e);if(t)return t;const i=((e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s,sortModifiers:i}=t,o=[],a=e.trim().split(Fe);let l="";for(let c=a.length-1;c>=0;c-=1){const e=a[c],{isExternal:t,modifiers:u,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:f}=r(e);if(t){l=e+(l.length>0?" "+l:l);continue}let p=!!f,g=n(p?d.substring(0,f):d);if(!g){if(!p){l=e+(l.length>0?" "+l:l);continue}if(g=n(d),!g){l=e+(l.length>0?" "+l:l);continue}p=!1}const m=0===u.length?"":1===u.length?u[0]:i(u).join(":"),y=h?m+"!":m,v=y+g;if(o.indexOf(v)>-1)continue;o.push(v);const b=s(g,p);for(let r=0;r<b.length;++r){const e=b[r];o.push(y+e)}l=e+(l.length>0?" "+l:l)}return l})(e,r);return s(e,i),i};return i=a=>{const l=t.reduce((e,t)=>t(e),e());return r=(e=>({cache:Me(e.cacheSize),parseClassName:Ie(e),sortModifiers:$e(e),..._e(e)}))(l),n=r.cache.get,s=r.cache.set,i=o,o(a)},(...e)=>i(((...e)=>{let t,r,n=0,s="";for(;n<e.length;)(t=e[n++])&&(r=ze(t))&&(s&&(s+=" "),s+=r);return s})(...e))},Ue=[],We=e=>{const t=t=>t[e]||Ue;return t.isThemeGetter=!0,t},Ve=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,He=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Ge=/^\d+\/\d+$/,Ye=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,qe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Xe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ke=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Je=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Qe=e=>Ge.test(e),Ze=e=>!!e&&!Number.isNaN(Number(e)),et=e=>!!e&&Number.isInteger(Number(e)),tt=e=>e.endsWith("%")&&Ze(e.slice(0,-1)),rt=e=>Ye.test(e),nt=()=>!0,st=e=>qe.test(e)&&!Xe.test(e),it=()=>!1,ot=e=>Ke.test(e),at=e=>Je.test(e),lt=e=>!ut(e)&&!mt(e),ct=e=>St(e,Et,it),ut=e=>Ve.test(e),ht=e=>St(e,Ot,st),dt=e=>St(e,jt,Ze),ft=e=>St(e,Ct,it),pt=e=>St(e,Tt,at),gt=e=>St(e,At,ot),mt=e=>He.test(e),yt=e=>kt(e,Ot),vt=e=>kt(e,Pt),bt=e=>kt(e,Ct),wt=e=>kt(e,Et),xt=e=>kt(e,Tt),_t=e=>kt(e,At,!0),St=(e,t,r)=>{const n=Ve.exec(e);return!!n&&(n[1]?t(n[1]):r(n[2]))},kt=(e,t,r=!1)=>{const n=He.exec(e);return!!n&&(n[1]?t(n[1]):r)},Ct=e=>"position"===e||"percentage"===e,Tt=e=>"image"===e||"url"===e,Et=e=>"length"===e||"size"===e||"bg-size"===e,Ot=e=>"length"===e,jt=e=>"number"===e,Pt=e=>"family-name"===e,At=e=>"shadow"===e,Dt=Be(()=>{const e=We("color"),t=We("font"),r=We("text"),n=We("font-weight"),s=We("tracking"),i=We("leading"),o=We("breakpoint"),a=We("container"),l=We("spacing"),c=We("radius"),u=We("shadow"),h=We("inset-shadow"),d=We("text-shadow"),f=We("drop-shadow"),p=We("blur"),g=We("perspective"),m=We("aspect"),y=We("ease"),v=We("animate"),b=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",mt,ut],w=()=>[mt,ut,l],x=()=>[Qe,"full","auto",...w()],_=()=>[et,"none","subgrid",mt,ut],S=()=>["auto",{span:["full",et,mt,ut]},et,mt,ut],k=()=>[et,"auto",mt,ut],C=()=>["auto","min","max","fr",mt,ut],T=()=>["auto",...w()],E=()=>[Qe,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...w()],O=()=>[e,mt,ut],j=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",bt,ft,{position:[mt,ut]}],P=()=>["auto","cover","contain",wt,ct,{size:[mt,ut]}],A=()=>[tt,yt,ht],D=()=>["","none","full",c,mt,ut],N=()=>["",Ze,yt,ht],M=()=>[Ze,tt,bt,ft],R=()=>["","none",p,mt,ut],L=()=>["none",Ze,mt,ut],I=()=>["none",Ze,mt,ut],$=()=>[Ze,mt,ut],F=()=>[Qe,"full",...w()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[rt],breakpoint:[rt],color:[nt],container:[rt],"drop-shadow":[rt],ease:["in","out","in-out"],font:[lt],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[rt],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[rt],shadow:[rt],spacing:["px",Ze],text:[rt],"text-shadow":[rt],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Qe,ut,mt,m]}],container:["container"],columns:[{columns:[Ze,ut,mt,a]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:b()}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:x()}],"inset-x":[{"inset-x":x()}],"inset-y":[{"inset-y":x()}],start:[{start:x()}],end:[{end:x()}],top:[{top:x()}],right:[{right:x()}],bottom:[{bottom:x()}],left:[{left:x()}],visibility:["visible","invisible","collapse"],z:[{z:[et,"auto",mt,ut]}],basis:[{basis:[Qe,"full","auto",a,...w()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ze,Qe,"auto","initial","none",ut]}],grow:[{grow:["",Ze,mt,ut]}],shrink:[{shrink:["",Ze,mt,ut]}],order:[{order:[et,"first","last","none",mt,ut]}],"grid-cols":[{"grid-cols":_()}],"col-start-end":[{col:S()}],"col-start":[{"col-start":k()}],"col-end":[{"col-end":k()}],"grid-rows":[{"grid-rows":_()}],"row-start-end":[{row:S()}],"row-start":[{"row-start":k()}],"row-end":[{"row-end":k()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":C()}],"auto-rows":[{"auto-rows":C()}],gap:[{gap:w()}],"gap-x":[{"gap-x":w()}],"gap-y":[{"gap-y":w()}],"justify-content":[{justify:["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe","normal"]}],"justify-items":[{"justify-items":["start","end","center","stretch","center-safe","end-safe","normal"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"align-items":[{items:["start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"align-self":[{self:["auto","start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"place-items":[{"place-items":["start","end","center","stretch","center-safe","end-safe","baseline"]}],"place-self":[{"place-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],p:[{p:w()}],px:[{px:w()}],py:[{py:w()}],ps:[{ps:w()}],pe:[{pe:w()}],pt:[{pt:w()}],pr:[{pr:w()}],pb:[{pb:w()}],pl:[{pl:w()}],m:[{m:T()}],mx:[{mx:T()}],my:[{my:T()}],ms:[{ms:T()}],me:[{me:T()}],mt:[{mt:T()}],mr:[{mr:T()}],mb:[{mb:T()}],ml:[{ml:T()}],"space-x":[{"space-x":w()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":w()}],"space-y-reverse":["space-y-reverse"],size:[{size:E()}],w:[{w:[a,"screen",...E()]}],"min-w":[{"min-w":[a,"screen","none",...E()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...E()]}],h:[{h:["screen","lh",...E()]}],"min-h":[{"min-h":["screen","lh","none",...E()]}],"max-h":[{"max-h":["screen","lh",...E()]}],"font-size":[{text:["base",r,yt,ht]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,mt,dt]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",tt,ut]}],"font-family":[{font:[vt,ut,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,mt,ut]}],"line-clamp":[{"line-clamp":[Ze,"none",mt,dt]}],leading:[{leading:[i,...w()]}],"list-image":[{"list-image":["none",mt,ut]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",mt,ut]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:O()}],"text-color":[{text:O()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","wavy"]}],"text-decoration-thickness":[{decoration:[Ze,"from-font","auto",mt,ht]}],"text-decoration-color":[{decoration:O()}],"underline-offset":[{"underline-offset":[Ze,"auto",mt,ut]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:w()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",mt,ut]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",mt,ut]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:j()}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:P()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},et,mt,ut],radial:["",mt,ut],conic:[et,mt,ut]},xt,pt]}],"bg-color":[{bg:O()}],"gradient-from-pos":[{from:A()}],"gradient-via-pos":[{via:A()}],"gradient-to-pos":[{to:A()}],"gradient-from":[{from:O()}],"gradient-via":[{via:O()}],"gradient-to":[{to:O()}],rounded:[{rounded:D()}],"rounded-s":[{"rounded-s":D()}],"rounded-e":[{"rounded-e":D()}],"rounded-t":[{"rounded-t":D()}],"rounded-r":[{"rounded-r":D()}],"rounded-b":[{"rounded-b":D()}],"rounded-l":[{"rounded-l":D()}],"rounded-ss":[{"rounded-ss":D()}],"rounded-se":[{"rounded-se":D()}],"rounded-ee":[{"rounded-ee":D()}],"rounded-es":[{"rounded-es":D()}],"rounded-tl":[{"rounded-tl":D()}],"rounded-tr":[{"rounded-tr":D()}],"rounded-br":[{"rounded-br":D()}],"rounded-bl":[{"rounded-bl":D()}],"border-w":[{border:N()}],"border-w-x":[{"border-x":N()}],"border-w-y":[{"border-y":N()}],"border-w-s":[{"border-s":N()}],"border-w-e":[{"border-e":N()}],"border-w-t":[{"border-t":N()}],"border-w-r":[{"border-r":N()}],"border-w-b":[{"border-b":N()}],"border-w-l":[{"border-l":N()}],"divide-x":[{"divide-x":N()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":N()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:["solid","dashed","dotted","double","hidden","none"]}],"divide-style":[{divide:["solid","dashed","dotted","double","hidden","none"]}],"border-color":[{border:O()}],"border-color-x":[{"border-x":O()}],"border-color-y":[{"border-y":O()}],"border-color-s":[{"border-s":O()}],"border-color-e":[{"border-e":O()}],"border-color-t":[{"border-t":O()}],"border-color-r":[{"border-r":O()}],"border-color-b":[{"border-b":O()}],"border-color-l":[{"border-l":O()}],"divide-color":[{divide:O()}],"outline-style":[{outline:["solid","dashed","dotted","double","none","hidden"]}],"outline-offset":[{"outline-offset":[Ze,mt,ut]}],"outline-w":[{outline:["",Ze,yt,ht]}],"outline-color":[{outline:O()}],shadow:[{shadow:["","none",u,_t,gt]}],"shadow-color":[{shadow:O()}],"inset-shadow":[{"inset-shadow":["none",h,_t,gt]}],"inset-shadow-color":[{"inset-shadow":O()}],"ring-w":[{ring:N()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:O()}],"ring-offset-w":[{"ring-offset":[Ze,ht]}],"ring-offset-color":[{"ring-offset":O()}],"inset-ring-w":[{"inset-ring":N()}],"inset-ring-color":[{"inset-ring":O()}],"text-shadow":[{"text-shadow":["none",d,_t,gt]}],"text-shadow-color":[{"text-shadow":O()}],opacity:[{opacity:[Ze,mt,ut]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ze]}],"mask-image-linear-from-pos":[{"mask-linear-from":M()}],"mask-image-linear-to-pos":[{"mask-linear-to":M()}],"mask-image-linear-from-color":[{"mask-linear-from":O()}],"mask-image-linear-to-color":[{"mask-linear-to":O()}],"mask-image-t-from-pos":[{"mask-t-from":M()}],"mask-image-t-to-pos":[{"mask-t-to":M()}],"mask-image-t-from-color":[{"mask-t-from":O()}],"mask-image-t-to-color":[{"mask-t-to":O()}],"mask-image-r-from-pos":[{"mask-r-from":M()}],"mask-image-r-to-pos":[{"mask-r-to":M()}],"mask-image-r-from-color":[{"mask-r-from":O()}],"mask-image-r-to-color":[{"mask-r-to":O()}],"mask-image-b-from-pos":[{"mask-b-from":M()}],"mask-image-b-to-pos":[{"mask-b-to":M()}],"mask-image-b-from-color":[{"mask-b-from":O()}],"mask-image-b-to-color":[{"mask-b-to":O()}],"mask-image-l-from-pos":[{"mask-l-from":M()}],"mask-image-l-to-pos":[{"mask-l-to":M()}],"mask-image-l-from-color":[{"mask-l-from":O()}],"mask-image-l-to-color":[{"mask-l-to":O()}],"mask-image-x-from-pos":[{"mask-x-from":M()}],"mask-image-x-to-pos":[{"mask-x-to":M()}],"mask-image-x-from-color":[{"mask-x-from":O()}],"mask-image-x-to-color":[{"mask-x-to":O()}],"mask-image-y-from-pos":[{"mask-y-from":M()}],"mask-image-y-to-pos":[{"mask-y-to":M()}],"mask-image-y-from-color":[{"mask-y-from":O()}],"mask-image-y-to-color":[{"mask-y-to":O()}],"mask-image-radial":[{"mask-radial":[mt,ut]}],"mask-image-radial-from-pos":[{"mask-radial-from":M()}],"mask-image-radial-to-pos":[{"mask-radial-to":M()}],"mask-image-radial-from-color":[{"mask-radial-from":O()}],"mask-image-radial-to-color":[{"mask-radial-to":O()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"]}],"mask-image-conic-pos":[{"mask-conic":[Ze]}],"mask-image-conic-from-pos":[{"mask-conic-from":M()}],"mask-image-conic-to-pos":[{"mask-conic-to":M()}],"mask-image-conic-from-color":[{"mask-conic-from":O()}],"mask-image-conic-to-color":[{"mask-conic-to":O()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:j()}],"mask-repeat":[{mask:["no-repeat",{repeat:["","x","y","space","round"]}]}],"mask-size":[{mask:P()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",mt,ut]}],filter:[{filter:["","none",mt,ut]}],blur:[{blur:R()}],brightness:[{brightness:[Ze,mt,ut]}],contrast:[{contrast:[Ze,mt,ut]}],"drop-shadow":[{"drop-shadow":["","none",f,_t,gt]}],"drop-shadow-color":[{"drop-shadow":O()}],grayscale:[{grayscale:["",Ze,mt,ut]}],"hue-rotate":[{"hue-rotate":[Ze,mt,ut]}],invert:[{invert:["",Ze,mt,ut]}],saturate:[{saturate:[Ze,mt,ut]}],sepia:[{sepia:["",Ze,mt,ut]}],"backdrop-filter":[{"backdrop-filter":["","none",mt,ut]}],"backdrop-blur":[{"backdrop-blur":R()}],"backdrop-brightness":[{"backdrop-brightness":[Ze,mt,ut]}],"backdrop-contrast":[{"backdrop-contrast":[Ze,mt,ut]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ze,mt,ut]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ze,mt,ut]}],"backdrop-invert":[{"backdrop-invert":["",Ze,mt,ut]}],"backdrop-opacity":[{"backdrop-opacity":[Ze,mt,ut]}],"backdrop-saturate":[{"backdrop-saturate":[Ze,mt,ut]}],"backdrop-sepia":[{"backdrop-sepia":["",Ze,mt,ut]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":w()}],"border-spacing-x":[{"border-spacing-x":w()}],"border-spacing-y":[{"border-spacing-y":w()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",mt,ut]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ze,"initial",mt,ut]}],ease:[{ease:["linear","initial",y,mt,ut]}],delay:[{delay:[Ze,mt,ut]}],animate:[{animate:["none",v,mt,ut]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,mt,ut]}],"perspective-origin":[{"perspective-origin":b()}],rotate:[{rotate:L()}],"rotate-x":[{"rotate-x":L()}],"rotate-y":[{"rotate-y":L()}],"rotate-z":[{"rotate-z":L()}],scale:[{scale:I()}],"scale-x":[{"scale-x":I()}],"scale-y":[{"scale-y":I()}],"scale-z":[{"scale-z":I()}],"scale-3d":["scale-3d"],skew:[{skew:$()}],"skew-x":[{"skew-x":$()}],"skew-y":[{"skew-y":$()}],transform:[{transform:[mt,ut,"","none","gpu","cpu"]}],"transform-origin":[{origin:b()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:F()}],"translate-x":[{"translate-x":F()}],"translate-y":[{"translate-y":F()}],"translate-z":[{"translate-z":F()}],"translate-none":["translate-none"],accent:[{accent:O()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:O()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",mt,ut]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":w()}],"scroll-mx":[{"scroll-mx":w()}],"scroll-my":[{"scroll-my":w()}],"scroll-ms":[{"scroll-ms":w()}],"scroll-me":[{"scroll-me":w()}],"scroll-mt":[{"scroll-mt":w()}],"scroll-mr":[{"scroll-mr":w()}],"scroll-mb":[{"scroll-mb":w()}],"scroll-ml":[{"scroll-ml":w()}],"scroll-p":[{"scroll-p":w()}],"scroll-px":[{"scroll-px":w()}],"scroll-py":[{"scroll-py":w()}],"scroll-ps":[{"scroll-ps":w()}],"scroll-pe":[{"scroll-pe":w()}],"scroll-pt":[{"scroll-pt":w()}],"scroll-pr":[{"scroll-pr":w()}],"scroll-pb":[{"scroll-pb":w()}],"scroll-pl":[{"scroll-pl":w()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",mt,ut]}],fill:[{fill:["none",...O()]}],"stroke-w":[{stroke:[Ze,yt,ht,dt]}],stroke:[{stroke:["none",...O()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function Nt(...e){return Dt(me(e))}const Mt=(Rt="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",Lt={variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}},e=>{var t;if(null==(null==Lt?void 0:Lt.variants))return ve(Rt,null==e?void 0:e.class,null==e?void 0:e.className);const{variants:r,defaultVariants:n}=Lt,s=Object.keys(r).map(t=>{const s=null==e?void 0:e[t],i=null==n?void 0:n[t];if(null===s)return null;const o=ye(s)||ye(i);return r[t][o]}),i=e&&Object.entries(e).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{}),o=null==Lt||null===(t=Lt.compoundVariants)||void 0===t?void 0:t.reduce((e,t)=>{let{class:r,className:s,...o}=t;return Object.entries(o).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...n,...i}[t]):{...n,...i}[t]===r})?[...e,r,s]:e},[]);return ve(Rt,s,o,null==e?void 0:e.class,null==e?void 0:e.className)});var Rt,Lt;function It({className:e,variant:t="default",size:r="default",asChild:n=!1,...s}){const i=n?he:"button";return l.jsx(i,{"code-path":"src/components/ui/button.tsx:52:5","data-slot":"button","data-variant":t,"data-size":r,className:Nt(Mt({variant:t,size:r,className:e})),...s})}function $t({className:e,type:t,...r}){return l.jsx("input",{"code-path":"src/components/ui/input.tsx:7:5",type:t,"data-slot":"input",className:Nt("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}function Ft(e,t,{checkForDefaultPrevented:r=!0}={}){return function(n){if(e?.(n),!1===r||!n.defaultPrevented)return t?.(n)}}function zt(...e){const t=e[0];if(1===e.length)return t;const r=()=>{const r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){const n=r.reduce((t,{useScope:r,scopeName:n})=>({...t,...r(e)[`__scope${n}`]}),{});return f.useMemo(()=>({[`__scope${t.scopeName}`]:n}),[n])}};return r.scopeName=t.scopeName,r}var Bt=globalThis?.document?f.useLayoutEffect:()=>{},Ut=p[" useId ".trim().toString()]||(()=>{}),Wt=0;function Vt(e){const[t,r]=f.useState(Ut());return Bt(()=>{r(e=>e??String(Wt++))},[e]),e||(t?`radix-${t}`:"")}var Ht=p[" useInsertionEffect ".trim().toString()]||Bt;function Gt({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,i,o]=function({defaultProp:e,onChange:t}){const[r,n]=f.useState(e),s=f.useRef(r),i=f.useRef(t);return Ht(()=>{i.current=t},[t]),f.useEffect(()=>{s.current!==r&&(i.current?.(r),s.current=r)},[r,s]),[r,n,i]}({defaultProp:t,onChange:r}),a=void 0!==e,l=a?e:s;{const t=f.useRef(void 0!==e);f.useEffect(()=>{const e=t.current;if(e!==a){const t=e?"controlled":"uncontrolled",r=a?"controlled":"uncontrolled";console.warn(`${n} is changing from ${t} to ${r}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=a},[a,n])}const c=f.useCallback(t=>{if(a){const r=function(e){return"function"==typeof e}(t)?t(e):t;r!==e&&o.current?.(r)}else i(t)},[a,e,i,o]);return[l,c]}var Yt=j();const qt=t(Yt);function Xt(e){const t=Kt(e),r=f.forwardRef((e,r)=>{const{children:n,...s}=e,i=f.Children.toArray(n),o=i.find(Qt);if(o){const e=o.props.children,n=i.map(t=>t===o?f.Children.count(e)>1?f.Children.only(null):f.isValidElement(e)?e.props.children:null:t);return l.jsx(t,{...s,ref:r,children:f.isValidElement(e)?f.cloneElement(e,void 0,n):null})}return l.jsx(t,{...s,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}function Kt(e){const t=f.forwardRef((e,t)=>{const{children:r,...n}=e;if(f.isValidElement(r)){const e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;if(r)return e.ref;if(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r)return e.props.ref;return e.props.ref||e.ref}(r),s=function(e,t){const r={...t};for(const n in t){const s=e[n],i=t[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...e)=>{const t=i(...e);return s(...e),t}:s&&(r[n]=s):"style"===n?r[n]={...s,...i}:"className"===n&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==f.Fragment&&(s.ref=t?ie(t,e):e),f.cloneElement(r,s)}return f.Children.count(r)>1?f.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Jt=Symbol("radix.slottable");function Qt(e){return f.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===Jt}var Zt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{const r=Xt(`Primitive.${t}`),n=f.forwardRef((e,n)=>{const{asChild:s,...i}=e,o=s?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),l.jsx(o,{...i,ref:n})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function er(e){const t=f.useRef(e);return f.useEffect(()=>{t.current=e}),f.useMemo(()=>(...e)=>t.current?.(...e),[])}var tr,rr="dismissableLayer.update",nr="dismissableLayer.pointerDownOutside",sr="dismissableLayer.focusOutside",ir=f.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),or=f.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...c}=e,u=f.useContext(ir),[h,d]=f.useState(null),p=h?.ownerDocument??globalThis?.document,[,g]=f.useState({}),m=oe(t,e=>d(e)),y=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=y.indexOf(v),w=h?y.indexOf(h):-1,x=u.layersWithOutsidePointerEventsDisabled.size>0,_=w>=b,S=function(e,t=globalThis?.document){const r=er(e),n=f.useRef(!1),s=f.useRef(()=>{});return f.useEffect(()=>{const e=e=>{if(e.target&&!n.current){let n=function(){lr(nr,r,i,{discrete:!0})};const i={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",s.current),s.current=n,t.addEventListener("click",s.current,{once:!0})):n()}else t.removeEventListener("click",s.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",e),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}(e=>{const t=e.target,r=[...u.branches].some(e=>e.contains(t));_&&!r&&(s?.(e),o?.(e),e.defaultPrevented||a?.())},p),k=function(e,t=globalThis?.document){const r=er(e),n=f.useRef(!1);return f.useEffect(()=>{const e=e=>{if(e.target&&!n.current){lr(sr,r,{originalEvent:e},{discrete:!1})}};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}(e=>{const t=e.target;[...u.branches].some(e=>e.contains(t))||(i?.(e),o?.(e),e.defaultPrevented||a?.())},p);return function(e,t=globalThis?.document){const r=er(e);f.useEffect(()=>{const e=e=>{"Escape"===e.key&&r(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[r,t])}(e=>{w===u.layers.size-1&&(n?.(e),!e.defaultPrevented&&a&&(e.preventDefault(),a()))},p),f.useEffect(()=>{if(h)return r&&(0===u.layersWithOutsidePointerEventsDisabled.size&&(tr=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(h)),u.layers.add(h),ar(),()=>{r&&1===u.layersWithOutsidePointerEventsDisabled.size&&(p.body.style.pointerEvents=tr)}},[h,p,r,u]),f.useEffect(()=>()=>{h&&(u.layers.delete(h),u.layersWithOutsidePointerEventsDisabled.delete(h),ar())},[h,u]),f.useEffect(()=>{const e=()=>g({});return document.addEventListener(rr,e),()=>document.removeEventListener(rr,e)},[]),l.jsx(Zt.div,{...c,ref:m,style:{pointerEvents:x?_?"auto":"none":void 0,...e.style},onFocusCapture:Ft(e.onFocusCapture,k.onFocusCapture),onBlurCapture:Ft(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:Ft(e.onPointerDownCapture,S.onPointerDownCapture)})});or.displayName="DismissableLayer";function ar(){const e=new CustomEvent(rr);document.dispatchEvent(e)}function lr(e,t,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?function(e,t){e&&Yt.flushSync(()=>e.dispatchEvent(t))}(s,i):s.dispatchEvent(i)}f.forwardRef((e,t)=>{const r=f.useContext(ir),n=f.useRef(null),s=oe(t,n);return f.useEffect(()=>{const e=n.current;if(e)return r.branches.add(e),()=>{r.branches.delete(e)}},[r.branches]),l.jsx(Zt.div,{...e,ref:s})}).displayName="DismissableLayerBranch";var cr="focusScope.autoFocusOnMount",ur="focusScope.autoFocusOnUnmount",hr={bubbles:!1,cancelable:!0},dr=f.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=e,[a,c]=f.useState(null),u=er(s),h=er(i),d=f.useRef(null),p=oe(t,e=>c(e)),g=f.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;f.useEffect(()=>{if(n){let e=function(e){if(g.paused||!a)return;const t=e.target;a.contains(t)?d.current=t:mr(d.current,{select:!0})},t=function(e){if(g.paused||!a)return;const t=e.relatedTarget;null!==t&&(a.contains(t)||mr(d.current,{select:!0}))},r=function(e){if(document.activeElement===document.body)for(const t of e)t.removedNodes.length>0&&mr(a)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);const n=new MutationObserver(r);return a&&n.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),n.disconnect()}}},[n,a,g.paused]),f.useEffect(()=>{if(a){yr.add(g);const t=document.activeElement;if(!a.contains(t)){const r=new CustomEvent(cr,hr);a.addEventListener(cr,u),a.dispatchEvent(r),r.defaultPrevented||(!function(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(mr(n,{select:t}),document.activeElement!==r)return}((e=fr(a),e.filter(e=>"A"!==e.tagName)),{select:!0}),document.activeElement===t&&mr(a))}return()=>{a.removeEventListener(cr,u),setTimeout(()=>{const e=new CustomEvent(ur,hr);a.addEventListener(ur,h),a.dispatchEvent(e),e.defaultPrevented||mr(t??document.body,{select:!0}),a.removeEventListener(ur,h),yr.remove(g)},0)}}var e},[a,u,h,g]);const m=f.useCallback(e=>{if(!r&&!n)return;if(g.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,s=document.activeElement;if(t&&s){const t=e.currentTarget,[n,i]=function(e){const t=fr(e),r=pr(t,e),n=pr(t.reverse(),e);return[r,n]}(t);n&&i?e.shiftKey||s!==i?e.shiftKey&&s===n&&(e.preventDefault(),r&&mr(i,{select:!0})):(e.preventDefault(),r&&mr(n,{select:!0})):s===t&&e.preventDefault()}},[r,n,g.paused]);return l.jsx(Zt.div,{tabIndex:-1,...o,ref:p,onKeyDown:m})});function fr(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function pr(e,t){for(const r of e)if(!gr(r,{upTo:t}))return r}function gr(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function mr(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}dr.displayName="FocusScope";var yr=function(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=vr(e,t),e.unshift(t)},remove(t){e=vr(e,t),e[0]?.resume()}}}();function vr(e,t){const r=[...e],n=r.indexOf(t);return-1!==n&&r.splice(n,1),r}var br=f.forwardRef((e,t)=>{const{container:r,...n}=e,[s,i]=f.useState(!1);Bt(()=>i(!0),[]);const o=r||s&&globalThis?.document?.body;return o?qt.createPortal(l.jsx(Zt.div,{...n,ref:t}),o):null});br.displayName="Portal";var wr=e=>{const{present:t,children:r}=e,n=function(e){const[t,r]=f.useState(),n=f.useRef(null),s=f.useRef(e),i=f.useRef("none"),o=e?"mounted":"unmounted",[a,l]=function(e,t){return f.useReducer((e,r)=>t[e][r]??e,e)}(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return f.useEffect(()=>{const e=xr(n.current);i.current="mounted"===a?e:"none"},[a]),Bt(()=>{const t=n.current,r=s.current;if(r!==e){const n=i.current,o=xr(t);if(e)l("MOUNT");else if("none"===o||"none"===t?.display)l("UNMOUNT");else{l(r&&n!==o?"ANIMATION_OUT":"UNMOUNT")}s.current=e}},[e,l]),Bt(()=>{if(t){let e;const r=t.ownerDocument.defaultView??window,o=i=>{const o=xr(n.current).includes(CSS.escape(i.animationName));if(i.target===t&&o&&(l("ANIMATION_END"),!s.current)){const n=t.style.animationFillMode;t.style.animationFillMode="forwards",e=r.setTimeout(()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=n)})}},a=e=>{e.target===t&&(i.current=xr(n.current))};return t.addEventListener("animationstart",a),t.addEventListener("animationcancel",o),t.addEventListener("animationend",o),()=>{r.clearTimeout(e),t.removeEventListener("animationstart",a),t.removeEventListener("animationcancel",o),t.removeEventListener("animationend",o)}}l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:f.useCallback(e=>{n.current=e?getComputedStyle(e):null,r(e)},[])}}(t),s="function"==typeof r?r({present:n.isPresent}):f.Children.only(r),i=oe(n.ref,function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;if(r)return e.ref;if(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r)return e.props.ref;return e.props.ref||e.ref}(s));return"function"==typeof r||n.isPresent?f.cloneElement(s,{ref:i}):null};function xr(e){return e?.animationName||"none"}wr.displayName="Presence";var _r=0;function Sr(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var kr=function(){return kr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},kr.apply(this,arguments)};function Cr(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r}function Tr(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{l(n.next(e))}catch(Xa){i(Xa)}}function a(e){try{l(n.throw(e))}catch(Xa){i(Xa)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;var Er="right-scroll-bar-position",Or="width-before-scroll-bar";function jr(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}var Pr="undefined"!=typeof window?f.useLayoutEffect:f.useEffect,Ar=new WeakMap;function Dr(e,t){var r,n,s,i=(r=null,n=function(t){return e.forEach(function(e){return jr(e,t)})},(s=f.useState(function(){return{value:r,callback:n,facade:{get current(){return s.value},set current(e){var t=s.value;t!==e&&(s.value=e,s.callback(e,t))}}}})[0]).callback=n,s.facade);return Pr(function(){var t=Ar.get(i);if(t){var r=new Set(t),n=new Set(e),s=i.current;r.forEach(function(e){n.has(e)||jr(e,null)}),n.forEach(function(e){r.has(e)||jr(e,s)})}Ar.set(i,e)},[e]),i}function Nr(e){return e}var Mr=function(e){var t=e.sideCar,r=Cr(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return f.createElement(n,kr({},r))};Mr.isSideCarExport=!0;var Rr=function(e){void 0===e&&(e={});var t=function(e,t){void 0===t&&(t=Nr);var r=[],n=!1;return{read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(e){var s=t(e,n);return r.push(s),function(){r=r.filter(function(e){return e!==s})}},assignSyncMedium:function(e){for(n=!0;r.length;){var t=r;r=[],t.forEach(e)}r={push:function(t){return e(t)},filter:function(){return r}}},assignMedium:function(e){n=!0;var t=[];if(r.length){var s=r;r=[],s.forEach(e),t=r}var i=function(){var r=t;t=[],r.forEach(e)},o=function(){return Promise.resolve().then(i)};o(),r={push:function(e){t.push(e),o()},filter:function(e){return t=t.filter(e),r}}}}}(null);return t.options=kr({async:!0,ssr:!1},e),t}(),Lr=function(){},Ir=f.forwardRef(function(e,t){var r=f.useRef(null),n=f.useState({onScrollCapture:Lr,onWheelCapture:Lr,onTouchMoveCapture:Lr}),s=n[0],i=n[1],o=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,h=e.shards,d=e.sideCar,p=e.noRelative,g=e.noIsolation,m=e.inert,y=e.allowPinchZoom,v=e.as,b=void 0===v?"div":v,w=e.gapMode,x=Cr(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=d,S=Dr([r,t]),k=kr(kr({},x),s);return f.createElement(f.Fragment,null,u&&f.createElement(_,{sideCar:Rr,removeScrollBar:c,shards:h,noRelative:p,noIsolation:g,inert:m,setCallbacks:i,allowPinchZoom:!!y,lockRef:r,gapMode:w}),o?f.cloneElement(f.Children.only(a),kr(kr({},k),{ref:S})):f.createElement(b,kr({},k,{className:l,ref:S}),a))});Ir.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Ir.classNames={fullWidth:Or,zeroRight:Er};function $r(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=function(){if("undefined"!=typeof __webpack_nonce__)return __webpack_nonce__}();return t&&e.setAttribute("nonce",t),e}var Fr=function(){var e=0,t=null;return{add:function(r){var n,s;0==e&&(t=$r())&&(s=r,(n=t).styleSheet?n.styleSheet.cssText=s:n.appendChild(document.createTextNode(s)),function(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}(t)),e++},remove:function(){! --e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},zr=function(){var e,t=(e=Fr(),function(t,r){f.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])});return function(e){var r=e.styles,n=e.dynamic;return t(r,n),null}},Br={left:0,top:0,right:0,gap:0},Ur=function(e){return parseInt(e||"",10)||0},Wr=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return Br;var t=function(e){var t=window.getComputedStyle(document.body),r=t["padding"===e?"paddingLeft":"marginLeft"],n=t["padding"===e?"paddingTop":"marginTop"],s=t["padding"===e?"paddingRight":"marginRight"];return[Ur(r),Ur(n),Ur(s)]}(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Vr=zr(),Hr="data-scroll-locked",Gr=function(e,t,r,n){var s=e.left,i=e.top,o=e.right,a=e.gap;return void 0===r&&(r="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(n,";\n   padding-right: ").concat(a,"px ").concat(n,";\n  }\n  body[").concat(Hr,"] {\n    overflow: hidden ").concat(n,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(n,";"),"margin"===r&&"\n    padding-left: ".concat(s,"px;\n    padding-top: ").concat(i,"px;\n    padding-right: ").concat(o,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(a,"px ").concat(n,";\n    "),"padding"===r&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(Er," {\n    right: ").concat(a,"px ").concat(n,";\n  }\n  \n  .").concat(Or," {\n    margin-right: ").concat(a,"px ").concat(n,";\n  }\n  \n  .").concat(Er," .").concat(Er," {\n    right: 0 ").concat(n,";\n  }\n  \n  .").concat(Or," .").concat(Or," {\n    margin-right: 0 ").concat(n,";\n  }\n  \n  body[").concat(Hr,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(a,"px;\n  }\n")},Yr=function(){var e=parseInt(document.body.getAttribute(Hr)||"0",10);return isFinite(e)?e:0},qr=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=void 0===n?"margin":n;f.useEffect(function(){return document.body.setAttribute(Hr,(Yr()+1).toString()),function(){var e=Yr()-1;e<=0?document.body.removeAttribute(Hr):document.body.setAttribute(Hr,e.toString())}},[]);var i=f.useMemo(function(){return Wr(s)},[s]);return f.createElement(Vr,{styles:Gr(i,!t,s,r?"":"!important")})},Xr=!1;if("undefined"!=typeof window)try{var Kr=Object.defineProperty({},"passive",{get:function(){return Xr=!0,!0}});window.addEventListener("test",Kr,Kr),window.removeEventListener("test",Kr,Kr)}catch(Vg){Xr=!1}var Jr=!!Xr&&{passive:!1},Qr=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return"hidden"!==r[t]&&!(r.overflowY===r.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===r[t])},Zr=function(e,t){var r=t.ownerDocument,n=t;do{if("undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot&&(n=n.host),en(e,n)){var s=tn(e,n);if(s[1]>s[2])return!0}n=n.parentNode}while(n&&n!==r.body);return!1},en=function(e,t){return"v"===e?function(e){return Qr(e,"overflowY")}(t):function(e){return Qr(e,"overflowX")}(t)},tn=function(e,t){return"v"===e?[(r=t).scrollTop,r.scrollHeight,r.clientHeight]:function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t);var r},rn=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},nn=function(e){return[e.deltaX,e.deltaY]},sn=function(e){return e&&"current"in e?e.current:e},on=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},an=0,ln=[];function cn(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const un=(hn=function(e){var t=f.useRef([]),r=f.useRef([0,0]),n=f.useRef(),s=f.useState(an++)[0],i=f.useState(zr)[0],o=f.useRef(e);f.useEffect(function(){o.current=e},[e]),f.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var t=function(e,t,r){if(r||2===arguments.length)for(var n,s=0,i=t.length;s<i;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}([e.lockRef.current],(e.shards||[]).map(sn),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var a=f.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!o.current.allowPinchZoom;var s,i=rn(e),a=r.current,l="deltaX"in e?e.deltaX:a[0]-i[0],c="deltaY"in e?e.deltaY:a[1]-i[1],u=e.target,h=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===h&&"range"===u.type)return!1;var d=window.getSelection(),f=d&&d.anchorNode;if(f&&(f===u||f.contains(u)))return!1;var p=Zr(h,u);if(!p)return!0;if(p?s=h:(s="v"===h?"h":"v",p=Zr(h,u)),!p)return!1;if(!n.current&&"changedTouches"in e&&(l||c)&&(n.current=s),!s)return!0;var g=n.current||s;return function(e,t,r,n){var s=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),i=s*n,o=r.target,a=t.contains(o),l=!1,c=i>0,u=0,h=0;do{if(!o)break;var d=tn(e,o),f=d[0],p=d[1]-d[2]-s*f;(f||p)&&en(e,o)&&(u+=p,h+=f);var g=o.parentNode;o=g&&g.nodeType===Node.DOCUMENT_FRAGMENT_NODE?g.host:g}while(!a&&o!==document.body||a&&(t.contains(o)||t===o));return(c&&Math.abs(u)<1||!c&&Math.abs(h)<1)&&(l=!0),l}(g,t,e,"h"===g?l:c)},[]),l=f.useCallback(function(e){var r=e;if(ln.length&&ln[ln.length-1]===i){var n="deltaY"in r?nn(r):rn(r),s=t.current.filter(function(e){return e.name===r.type&&(e.target===r.target||r.target===e.shadowParent)&&(t=e.delta,s=n,t[0]===s[0]&&t[1]===s[1]);var t,s})[0];if(s&&s.should)r.cancelable&&r.preventDefault();else if(!s){var l=(o.current.shards||[]).map(sn).filter(Boolean).filter(function(e){return e.contains(r.target)});(l.length>0?a(r,l[0]):!o.current.noIsolation)&&r.cancelable&&r.preventDefault()}}},[]),c=f.useCallback(function(e,r,n,s){var i={name:e,delta:r,target:n,should:s,shadowParent:cn(n)};t.current.push(i),setTimeout(function(){t.current=t.current.filter(function(e){return e!==i})},1)},[]),u=f.useCallback(function(e){r.current=rn(e),n.current=void 0},[]),h=f.useCallback(function(t){c(t.type,nn(t),t.target,a(t,e.lockRef.current))},[]),d=f.useCallback(function(t){c(t.type,rn(t),t.target,a(t,e.lockRef.current))},[]);f.useEffect(function(){return ln.push(i),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:d}),document.addEventListener("wheel",l,Jr),document.addEventListener("touchmove",l,Jr),document.addEventListener("touchstart",u,Jr),function(){ln=ln.filter(function(e){return e!==i}),document.removeEventListener("wheel",l,Jr),document.removeEventListener("touchmove",l,Jr),document.removeEventListener("touchstart",u,Jr)}},[]);var p=e.removeScrollBar,g=e.inert;return f.createElement(f.Fragment,null,g?f.createElement(i,{styles:on(s)}):null,p?f.createElement(qr,{noRelative:e.noRelative,gapMode:e.gapMode}):null)},Rr.useMedium(hn),Mr);var hn,dn=f.forwardRef(function(e,t){return f.createElement(Ir,kr({},e,{ref:t,sideCar:un}))});dn.classNames=Ir.classNames;var fn=new WeakMap,pn=new WeakMap,gn={},mn=0,yn=function(e){return e&&(e.host||yn(e.parentNode))},vn=function(e,t,r,n){var s=function(e,t){return t.map(function(t){if(e.contains(t))return t;var r=yn(t);return r&&e.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)}).filter(function(e){return Boolean(e)})}(t,Array.isArray(e)?e:[e]);gn[r]||(gn[r]=new WeakMap);var i=gn[r],o=[],a=new Set,l=new Set(s),c=function(e){e&&!a.has(e)&&(a.add(e),c(e.parentNode))};s.forEach(c);var u=function(e){e&&!l.has(e)&&Array.prototype.forEach.call(e.children,function(e){if(a.has(e))u(e);else try{var t=e.getAttribute(n),s=null!==t&&"false"!==t,l=(fn.get(e)||0)+1,c=(i.get(e)||0)+1;fn.set(e,l),i.set(e,c),o.push(e),1===l&&s&&pn.set(e,!0),1===c&&e.setAttribute(r,"true"),s||e.setAttribute(n,"true")}catch(Xa){console.error("aria-hidden: cannot operate on ",e,Xa)}})};return u(t),a.clear(),mn++,function(){o.forEach(function(e){var t=fn.get(e)-1,s=i.get(e)-1;fn.set(e,t),i.set(e,s),t||(pn.has(e)||e.removeAttribute(n),pn.delete(e)),s||e.removeAttribute(r)}),--mn||(fn=new WeakMap,fn=new WeakMap,pn=new WeakMap,gn={})}},bn=function(e,t,r){void 0===r&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=function(e){return"undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body}(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),vn(n,s,r,"aria-hidden")):function(){return null}};function wn(e){const t=xn(e),r=f.forwardRef((e,r)=>{const{children:n,...s}=e,i=f.Children.toArray(n),o=i.find(Sn);if(o){const e=o.props.children,n=i.map(t=>t===o?f.Children.count(e)>1?f.Children.only(null):f.isValidElement(e)?e.props.children:null:t);return l.jsx(t,{...s,ref:r,children:f.isValidElement(e)?f.cloneElement(e,void 0,n):null})}return l.jsx(t,{...s,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}function xn(e){const t=f.forwardRef((e,t)=>{const{children:r,...n}=e;if(f.isValidElement(r)){const e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;if(r)return e.ref;if(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r)return e.props.ref;return e.props.ref||e.ref}(r),s=function(e,t){const r={...t};for(const n in t){const s=e[n],i=t[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...e)=>{const t=i(...e);return s(...e),t}:s&&(r[n]=s):"style"===n?r[n]={...s,...i}:"className"===n&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==f.Fragment&&(s.ref=t?ie(t,e):e),f.cloneElement(r,s)}return f.Children.count(r)>1?f.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var _n=Symbol("radix.slottable");function Sn(e){return f.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===_n}var kn="Dialog",[Cn]=function(e,t=[]){let r=[];const n=()=>{const t=r.map(e=>f.createContext(e));return function(r){const n=r?.[e]||t;return f.useMemo(()=>({[`__scope${e}`]:{...r,[e]:n}}),[r,n])}};return n.scopeName=e,[function(t,n){const s=f.createContext(n),i=r.length;r=[...r,n];const o=t=>{const{scope:r,children:n,...o}=t,a=r?.[e]?.[i]||s,c=f.useMemo(()=>o,Object.values(o));return l.jsx(a.Provider,{value:c,children:n})};return o.displayName=t+"Provider",[o,function(r,o){const a=o?.[e]?.[i]||s,l=f.useContext(a);if(l)return l;if(void 0!==n)return n;throw new Error(`\`${r}\` must be used within \`${t}\``)}]},zt(n,...t)]}(kn),[Tn,En]=Cn(kn),On=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:o=!0}=e,a=f.useRef(null),c=f.useRef(null),[u,h]=Gt({prop:n,defaultProp:s??!1,onChange:i,caller:kn});return l.jsx(Tn,{scope:t,triggerRef:a,contentRef:c,contentId:Vt(),titleId:Vt(),descriptionId:Vt(),open:u,onOpenChange:h,onOpenToggle:f.useCallback(()=>h(e=>!e),[h]),modal:o,children:r})};On.displayName=kn;var jn="DialogTrigger";f.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=En(jn,r),i=oe(t,s.triggerRef);return l.jsx(Zt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":qn(s.open),...n,ref:i,onClick:Ft(e.onClick,s.onOpenToggle)})}).displayName=jn;var Pn="DialogPortal",[An,Dn]=Cn(Pn,{forceMount:void 0}),Nn=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,i=En(Pn,t);return l.jsx(An,{scope:t,forceMount:r,children:f.Children.map(n,e=>l.jsx(wr,{present:r||i.open,children:l.jsx(br,{asChild:!0,container:s,children:e})}))})};Nn.displayName=Pn;var Mn="DialogOverlay",Rn=f.forwardRef((e,t)=>{const r=Dn(Mn,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,i=En(Mn,e.__scopeDialog);return i.modal?l.jsx(wr,{present:n||i.open,children:l.jsx(In,{...s,ref:t})}):null});Rn.displayName=Mn;var Ln=wn("DialogOverlay.RemoveScroll"),In=f.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=En(Mn,r);return l.jsx(dn,{as:Ln,allowPinchZoom:!0,shards:[s.contentRef],children:l.jsx(Zt.div,{"data-state":qn(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),$n="DialogContent",Fn=f.forwardRef((e,t)=>{const r=Dn($n,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,i=En($n,e.__scopeDialog);return l.jsx(wr,{present:n||i.open,children:i.modal?l.jsx(zn,{...s,ref:t}):l.jsx(Bn,{...s,ref:t})})});Fn.displayName=$n;var zn=f.forwardRef((e,t)=>{const r=En($n,e.__scopeDialog),n=f.useRef(null),s=oe(t,r.contentRef,n);return f.useEffect(()=>{const e=n.current;if(e)return bn(e)},[]),l.jsx(Un,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ft(e.onCloseAutoFocus,e=>{e.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Ft(e.onPointerDownOutside,e=>{const t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;(2===t.button||r)&&e.preventDefault()}),onFocusOutside:Ft(e.onFocusOutside,e=>e.preventDefault())})}),Bn=f.forwardRef((e,t)=>{const r=En($n,e.__scopeDialog),n=f.useRef(!1),s=f.useRef(!1);return l.jsx(Un,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(n.current||r.triggerRef.current?.focus(),t.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(n.current=!0,"pointerdown"===t.detail.originalEvent.type&&(s.current=!0));const i=t.target,o=r.triggerRef.current?.contains(i);o&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&s.current&&t.preventDefault()}})}),Un=f.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=e,a=En($n,r),c=f.useRef(null),u=oe(t,c);return f.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Sr()),document.body.insertAdjacentElement("beforeend",e[1]??Sr()),_r++,()=>{1===_r&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),_r--}},[]),l.jsxs(l.Fragment,{children:[l.jsx(dr,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:l.jsx(or,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":qn(a.open),...o,ref:u,onDismiss:()=>a.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(Qn,{titleId:a.titleId}),l.jsx(Zn,{contentRef:c,descriptionId:a.descriptionId})]})]})}),Wn="DialogTitle",Vn=f.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=En(Wn,r);return l.jsx(Zt.h2,{id:s.titleId,...n,ref:t})});Vn.displayName=Wn;var Hn="DialogDescription";f.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=En(Hn,r);return l.jsx(Zt.p,{id:s.descriptionId,...n,ref:t})}).displayName=Hn;var Gn="DialogClose",Yn=f.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=En(Gn,r);return l.jsx(Zt.button,{type:"button",...n,ref:t,onClick:Ft(e.onClick,()=>s.onOpenChange(!1))})});function qn(e){return e?"open":"closed"}Yn.displayName=Gn;var Xn="DialogTitleWarning",[Kn,Jn]=function(e,t){const r=f.createContext(t),n=e=>{const{children:t,...n}=e,s=f.useMemo(()=>n,Object.values(n));return l.jsx(r.Provider,{value:s,children:t})};return n.displayName=e+"Provider",[n,function(n){const s=f.useContext(r);if(s)return s;if(void 0!==t)return t;throw new Error(`\`${n}\` must be used within \`${e}\``)}]}(Xn,{contentName:$n,titleName:Wn,docsSlug:"dialog"}),Qn=({titleId:e})=>{const t=Jn(Xn),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.\n\nIf you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return f.useEffect(()=>{if(e){document.getElementById(e)||console.error(r)}},[r,e]),null},Zn=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Jn("DialogDescriptionWarning").contentName}}.`;return f.useEffect(()=>{const n=e.current?.getAttribute("aria-describedby");if(t&&n){document.getElementById(t)||console.warn(r)}},[r,e,t]),null},es=On,ts=Nn,rs=Rn,ns=Fn,ss=Vn,is=Yn;function os({...e}){return l.jsx(es,{"code-path":"src/components/ui/dialog.tsx:10:10","data-slot":"dialog",...e})}function as({...e}){return l.jsx(ts,{"code-path":"src/components/ui/dialog.tsx:22:10","data-slot":"dialog-portal",...e})}function ls({className:e,...t}){return l.jsx(rs,{"code-path":"src/components/ui/dialog.tsx:36:5","data-slot":"dialog-overlay",className:Nt("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function cs({className:e,children:t,showCloseButton:r=!0,...n}){return l.jsxs(as,{"code-path":"src/components/ui/dialog.tsx:56:5","data-slot":"dialog-portal",children:[l.jsx(ls,{"code-path":"src/components/ui/dialog.tsx:57:7"}),l.jsxs(ns,{"code-path":"src/components/ui/dialog.tsx:58:7","data-slot":"dialog-content",className:Nt("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg",e),...n,children:[t,r&&l.jsxs(is,{"code-path":"src/components/ui/dialog.tsx:68:11","data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[l.jsx(ne,{"code-path":"src/components/ui/dialog.tsx:72:13"}),l.jsx("span",{"code-path":"src/components/ui/dialog.tsx:73:13",className:"sr-only",children:"Close"})]})]})]})}function us({className:e,...t}){return l.jsx("div",{"code-path":"src/components/ui/dialog.tsx:83:5","data-slot":"dialog-header",className:Nt("flex flex-col gap-2 text-center sm:text-left",e),...t})}function hs({className:e,...t}){return l.jsx(ss,{"code-path":"src/components/ui/dialog.tsx:109:5","data-slot":"dialog-title",className:Nt("text-lg leading-none font-semibold",e),...t})}function ds({isOpen:e,onClose:t,onLogin:r}){const[n,s]=f.useState(""),[i,o]=f.useState(""),[a,c]=f.useState(""),[u,h]=f.useState(!1);return l.jsx(os,{"code-path":"src/components/LoginModal.tsx:43:5",open:e,onOpenChange:t,children:l.jsxs(cs,{"code-path":"src/components/LoginModal.tsx:44:7",className:"sm:max-w-md bg-gradient-to-br from-pink-50 to-purple-50 border-2 border-pink-200",children:[l.jsx(us,{"code-path":"src/components/LoginModal.tsx:45:9",children:l.jsxs(hs,{"code-path":"src/components/LoginModal.tsx:46:11",className:"text-center text-2xl font-bold bg-gradient-to-r from-pink-500 to-purple-600 bg-clip-text text-transparent flex items-center justify-center gap-2",children:[l.jsx(G,{"code-path":"src/components/LoginModal.tsx:47:13",className:"w-6 h-6 text-pink-500 animate-pulse"}),"Login Memory",l.jsx(G,{"code-path":"src/components/LoginModal.tsx:49:13",className:"w-6 h-6 text-pink-500 animate-pulse"})]})}),l.jsxs("form",{"code-path":"src/components/LoginModal.tsx:53:9",onSubmit:e=>{e.preventDefault(),c(""),h(!0),setTimeout(()=>{r(n,i)?(s(""),o(""),t()):c("Nomor HP atau password salah!"),h(!1)},500)},className:"space-y-4 mt-4",children:[l.jsxs("div",{"code-path":"src/components/LoginModal.tsx:54:11",className:"space-y-2",children:[l.jsxs("label",{"code-path":"src/components/LoginModal.tsx:55:13",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[l.jsx(K,{"code-path":"src/components/LoginModal.tsx:56:15",className:"w-4 h-4 text-pink-500"}),"Nomor HP"]}),l.jsx($t,{"code-path":"src/components/LoginModal.tsx:59:13",type:"tel",placeholder:"Masukkan nomor HP",value:n,onChange:e=>s(e.target.value),className:"border-pink-200 focus:border-pink-400 focus:ring-pink-400"})]}),l.jsxs("div",{"code-path":"src/components/LoginModal.tsx:68:11",className:"space-y-2",children:[l.jsxs("label",{"code-path":"src/components/LoginModal.tsx:69:13",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[l.jsx(q,{"code-path":"src/components/LoginModal.tsx:70:15",className:"w-4 h-4 text-pink-500"}),"Password"]}),l.jsx($t,{"code-path":"src/components/LoginModal.tsx:73:13",type:"password",placeholder:"Masukkan password",value:i,onChange:e=>o(e.target.value),className:"border-pink-200 focus:border-pink-400 focus:ring-pink-400"})]}),a&&l.jsx("div",{"code-path":"src/components/LoginModal.tsx:83:13",className:"text-red-500 text-sm text-center bg-red-50 p-2 rounded-lg",children:a}),l.jsx(It,{"code-path":"src/components/LoginModal.tsx:88:11",type:"submit",disabled:u,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-semibold py-2 rounded-xl transition-all duration-300 transform hover:scale-105",children:u?"Memuat...":"Login"}),l.jsx("p",{"code-path":"src/components/LoginModal.tsx:96:11",className:"text-xs text-center text-gray-500 mt-2",children:"Hint: Nomor HP: 082339503532 atau 085339951848"})]})]})})}function fs({years:e,selectedYear:t,onSelectYear:r,onAddMedia:n,onRemoveMedia:s,getMediaByYear:i,isAuthenticated:o,onLoginClick:a}){const c=f.useRef(null),u=f.useRef(null),[h,d]=f.useState(null),p=e=>{if(c.current){const t=200;c.current.scrollBy({left:"left"===e?-t:t,behavior:"smooth"})}};return l.jsxs("div",{"code-path":"src/components/YearSlider.tsx:72:5",className:"relative w-full max-w-4xl mx-auto",children:[l.jsx("input",{"code-path":"src/components/YearSlider.tsx:73:7",ref:u,type:"file",accept:"image/*,video/*",onChange:e=>{e.preventDefault(),e.stopPropagation();const t=e.target.files?.[0];t&&h&&(console.log(" File selected:",t.name,t.size,t.type),n(h,t),d(null),u.current&&(u.current.value=""))},className:"hidden",capture:"environment"}),l.jsx("button",{"code-path":"src/components/YearSlider.tsx:83:7",onClick:()=>p("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 w-10 h-10 bg-white/80 backdrop-blur-sm rounded-full shadow-lg flex items-center justify-center hover:bg-white transition-all duration-300 hover:scale-110",children:l.jsx(z,{"code-path":"src/components/YearSlider.tsx:87:9",className:"w-6 h-6 text-pink-500"})}),l.jsx("button",{"code-path":"src/components/YearSlider.tsx:90:7",onClick:()=>p("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 w-10 h-10 bg-white/80 backdrop-blur-sm rounded-full shadow-lg flex items-center justify-center hover:bg-white transition-all duration-300 hover:scale-110",children:l.jsx(B,{"code-path":"src/components/YearSlider.tsx:94:9",className:"w-6 h-6 text-pink-500"})}),l.jsx("div",{"code-path":"src/components/YearSlider.tsx:98:7",ref:c,className:"flex gap-4 overflow-x-auto scrollbar-hide px-12 py-4 scroll-smooth",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:e.map(e=>{const n=i(e),c=t===e;return l.jsx("div",{"code-path":"src/components/YearSlider.tsx:108:13",className:"flex-shrink-0 w-48 transition-all duration-500 "+(c?"scale-105":"scale-100 opacity-80"),children:l.jsxs("div",{"code-path":"src/components/YearSlider.tsx:114:15",onClick:()=>r(e),className:"relative cursor-pointer rounded-2xl overflow-hidden shadow-xl transition-all duration-300 "+(c?"ring-4 ring-pink-400 ring-offset-2":"hover:shadow-2xl"),children:[l.jsxs("div",{"code-path":"src/components/YearSlider.tsx:123:17",className:"h-32 bg-gradient-to-br from-pink-400 via-purple-500 to-indigo-600 flex items-center justify-center relative overflow-hidden",children:[l.jsxs("div",{"code-path":"src/components/YearSlider.tsx:125:19",className:"absolute inset-0 opacity-30",children:[l.jsx("div",{"code-path":"src/components/YearSlider.tsx:126:21",className:"absolute top-2 left-2 w-8 h-8 bg-white/20 rounded-full"}),l.jsx("div",{"code-path":"src/components/YearSlider.tsx:127:21",className:"absolute bottom-4 right-4 w-12 h-12 bg-white/10 rounded-full"}),l.jsx("div",{"code-path":"src/components/YearSlider.tsx:128:21",className:"absolute top-1/2 left-1/4 w-4 h-4 bg-white/15 rounded-full"})]}),l.jsx("span",{"code-path":"src/components/YearSlider.tsx:131:19",className:"text-4xl font-bold text-white drop-shadow-lg",children:e}),l.jsx("button",{"code-path":"src/components/YearSlider.tsx:136:19",onClick:t=>{t.stopPropagation(),(e=>{o?(d(e),u.current?.click()):a()})(e)},className:"absolute bottom-2 right-2 w-8 h-8 bg-white/90 rounded-full flex items-center justify-center hover:bg-white transition-all duration-300 hover:scale-110 shadow-lg",children:l.jsx(Q,{"code-path":"src/components/YearSlider.tsx:143:21",className:"w-5 h-5 text-pink-500"})})]}),n.length>0&&l.jsx("div",{"code-path":"src/components/YearSlider.tsx:149:19",className:"p-2 bg-white",children:l.jsxs("div",{"code-path":"src/components/YearSlider.tsx:150:21",className:"flex gap-1 overflow-x-auto",children:[n.slice(0,3).map(t=>l.jsxs("div",{"code-path":"src/components/YearSlider.tsx:152:25",className:"relative flex-shrink-0",children:["photo"===t.type?l.jsx("img",{"code-path":"src/components/YearSlider.tsx:154:29",src:t.url,alt:"Memory",className:"w-12 h-12 object-cover rounded-lg"}):l.jsx("div",{"code-path":"src/components/YearSlider.tsx:160:29",className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:l.jsx("span",{"code-path":"src/components/YearSlider.tsx:161:31",className:"text-xs text-gray-500",children:""})}),o&&l.jsx("button",{"code-path":"src/components/YearSlider.tsx:165:29",onClick:r=>{r.stopPropagation(),((e,t)=>{o&&s(e,t)})(e,t.id)},className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center hover:bg-red-600",children:l.jsx(te,{"code-path":"src/components/YearSlider.tsx:172:31",className:"w-2 h-2 text-white"})})]},t.id)),n.length>3&&l.jsx("div",{"code-path":"src/components/YearSlider.tsx:178:25",className:"flex-shrink-0 w-12 h-12 bg-pink-100 rounded-lg flex items-center justify-center",children:l.jsxs("span",{"code-path":"src/components/YearSlider.tsx:179:27",className:"text-xs text-pink-600 font-bold",children:["+",n.length-3]})})]})}),0===n.length&&l.jsx("div",{"code-path":"src/components/YearSlider.tsx:189:19",className:"p-3 bg-white text-center",children:l.jsx("p",{"code-path":"src/components/YearSlider.tsx:190:21",className:"text-xs text-gray-400",children:"Belum ada foto"})})]})},e)})})]})}function ps({media:e,isAuthenticated:t,onRemoveMedia:r,maxItems:n={top:5,bottom:6}}){const[s,i]=f.useState(null),o=e.slice(0,n.top),a=e.slice(n.top,n.top+n.bottom),c=e=>{t&&(r(e.year,e.id),s?.id===e.id&&i(null))};return l.jsxs("div",{"code-path":"src/components/Gallery.tsx:38:5",className:"w-full space-y-4",children:[l.jsx("div",{"code-path":"src/components/Gallery.tsx:40:7",className:"flex flex-wrap justify-center gap-3",children:o.map((e,r)=>l.jsxs("div",{"code-path":"src/components/Gallery.tsx:42:11",className:"relative group cursor-pointer",onClick:()=>i(e),style:{animationDelay:100*r+"ms"},children:[l.jsx("div",{"code-path":"src/components/Gallery.tsx:50:13",className:"w-24 h-24 sm:w-28 sm:h-28 md:w-32 md:h-32 rounded-2xl overflow-hidden shadow-lg transition-all duration-300 group-hover:scale-110 group-hover:shadow-2xl border-2 border-white/50",children:"photo"===e.type?l.jsx("img",{"code-path":"src/components/Gallery.tsx:52:17",src:e.url,alt:"Memory",className:"w-full h-full object-cover"}):l.jsx("div",{"code-path":"src/components/Gallery.tsx:58:17",className:"w-full h-full bg-gradient-to-br from-pink-400 to-purple-600 flex items-center justify-center",children:l.jsx(J,{"code-path":"src/components/Gallery.tsx:59:19",className:"w-8 h-8 text-white"})})}),l.jsx("div",{"code-path":"src/components/Gallery.tsx:65:13",className:"absolute inset-0 bg-black/50 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:l.jsx(G,{"code-path":"src/components/Gallery.tsx:66:15",className:"w-6 h-6 text-white"})}),t&&l.jsx("button",{"code-path":"src/components/Gallery.tsx:71:15",onClick:t=>{t.stopPropagation(),c(e)},className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 hover:bg-red-600 shadow-lg",children:l.jsx(te,{"code-path":"src/components/Gallery.tsx:78:17",className:"w-3 h-3 text-white"})})]},e.id))}),l.jsx("div",{"code-path":"src/components/Gallery.tsx:86:7",className:"flex flex-wrap justify-center gap-3",children:a.map((e,r)=>l.jsxs("div",{"code-path":"src/components/Gallery.tsx:88:11",className:"relative group cursor-pointer",onClick:()=>i(e),style:{animationDelay:100*(r+n.top)+"ms"},children:[l.jsx("div",{"code-path":"src/components/Gallery.tsx:96:13",className:"w-20 h-20 sm:w-24 sm:h-24 md:w-28 md:h-28 rounded-2xl overflow-hidden shadow-lg transition-all duration-300 group-hover:scale-110 group-hover:shadow-2xl border-2 border-white/50",children:"photo"===e.type?l.jsx("img",{"code-path":"src/components/Gallery.tsx:98:17",src:e.url,alt:"Memory",className:"w-full h-full object-cover"}):l.jsx("div",{"code-path":"src/components/Gallery.tsx:104:17",className:"w-full h-full bg-gradient-to-br from-purple-400 to-pink-600 flex items-center justify-center",children:l.jsx(J,{"code-path":"src/components/Gallery.tsx:105:19",className:"w-6 h-6 text-white"})})}),l.jsx("div",{"code-path":"src/components/Gallery.tsx:111:13",className:"absolute inset-0 bg-black/50 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:l.jsx(G,{"code-path":"src/components/Gallery.tsx:112:15",className:"w-5 h-5 text-white"})}),t&&l.jsx("button",{"code-path":"src/components/Gallery.tsx:117:15",onClick:t=>{t.stopPropagation(),c(e)},className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 hover:bg-red-600 shadow-lg",children:l.jsx(te,{"code-path":"src/components/Gallery.tsx:124:17",className:"w-3 h-3 text-white"})})]},e.id))}),l.jsx(os,{"code-path":"src/components/Gallery.tsx:132:7",open:!!s,onOpenChange:()=>i(null),children:l.jsxs(cs,{"code-path":"src/components/Gallery.tsx:133:9",className:"max-w-4xl w-full p-0 bg-black/90 border-none",children:[l.jsx(hs,{"code-path":"src/components/Gallery.tsx:135:11",className:"sr-only",children:"photo"===s?.type?"Photo Viewer":"Video Viewer"}),s&&l.jsxs("div",{"code-path":"src/components/Gallery.tsx:140:13",className:"relative",children:["photo"===s.type?l.jsx("img",{"code-path":"src/components/Gallery.tsx:142:17",src:s.url,alt:"Memory",className:"w-full max-h-[80vh] object-contain"}):l.jsx("video",{"code-path":"src/components/Gallery.tsx:148:17",src:s.url,controls:!0,className:"w-full max-h-[80vh]"}),l.jsx("button",{"code-path":"src/components/Gallery.tsx:155:15",onClick:()=>i(null),className:"absolute top-4 right-4 w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white/30 transition-colors",children:l.jsx(ne,{"code-path":"src/components/Gallery.tsx:159:17",className:"w-6 h-6 text-white"})}),t&&l.jsx("button",{"code-path":"src/components/Gallery.tsx:163:17",onClick:()=>c(s),className:"absolute top-4 left-4 w-10 h-10 bg-red-500/80 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-red-600 transition-colors",children:l.jsx(te,{"code-path":"src/components/Gallery.tsx:167:19",className:"w-5 h-5 text-white"})})]})]})})]})}function gs({theme:e}){const t=()=>{switch(e){case"love":return"from-pink-100 to-rose-100 border-rose-200";case"love-sea":return"from-cyan-100 to-blue-100 border-cyan-200";case"sakura":return"from-pink-50 to-purple-50 border-pink-200";case"space":return"from-indigo-100 to-purple-100 border-indigo-200";case"cat":return"from-orange-100 to-yellow-100 border-orange-200";default:return"from-gray-100 to-slate-100 border-gray-200"}};return l.jsxs("div",{"code-path":"src/components/StorySection.tsx:59:5",className:"w-full max-w-4xl mx-auto px-4 py-8",children:[l.jsxs("div",{"code-path":"src/components/StorySection.tsx:60:7",className:"text-center mb-8",children:[l.jsxs("h2",{"code-path":"src/components/StorySection.tsx:61:9",className:"text-3xl font-bold bg-gradient-to-r from-pink-500 to-purple-600 bg-clip-text text-transparent flex items-center justify-center gap-3",children:[l.jsx(ee,{"code-path":"src/components/StorySection.tsx:62:11",className:"w-6 h-6 text-yellow-500"}),"Our Love Story",l.jsx(ee,{"code-path":"src/components/StorySection.tsx:64:11",className:"w-6 h-6 text-yellow-500"})]}),l.jsx("p",{"code-path":"src/components/StorySection.tsx:66:9",className:"text-gray-500 mt-2",children:"Perjalanan cinta kita dari waktu ke waktu"})]}),l.jsx("div",{"code-path":"src/components/StorySection.tsx:69:7",className:"space-y-6",children:[{year:2021,title:"Awal Pertemuan",content:"Di tahun 2021, kisah indah kita dimulai. Dua jiwa yang tak sengaja bertemu, namun saling melengkapi. Nak Pungut dan Nak Soa, nama yang kini selalu bersama dalam setiap doa."},{year:2022,title:"Mengenal Lebih Dekat",content:"Tahun 2022 menjadi saksi bagaimana kita saling mengenal lebih dalam. Setiap tawa, setiap air mata, semua menjadi bagian dari perjalanan cinta kita."},{year:2023,title:"Bersama Melangkah",content:"Di tahun 2023, kita belajar bahwa cinta bukan hanya tentang kata-kata manis, tapi juga tentang bersama-sama menghadapi setiap tantangan."},{year:2024,title:"Membangun Mimpi",content:"Tahun 2024 adalah tahun di mana kita mulai membangun mimpi-mimpi bersama. Setiap rencana, setiap harapan, kita ukir bersama-sama."},{year:2025,title:"Semakin Kuat",content:"Di tahun 2025, ikatan kita semakin kuat. Kita belajar bahwa cinta sejati adalah tentang menerima kekurangan dan menyempurnakan kelebihan satu sama lain."},{year:2026,title:"Menuju Masa Depan",content:"Tahun 2026 dan seterusnya, kita melangkah menuju masa depan yang penuh harapan. Bersama-sama, kita akan menulis kisah cinta yang abadi."}].map((e,r)=>l.jsxs("div",{"code-path":"src/components/StorySection.tsx:71:11",className:`relative p-6 rounded-2xl bg-gradient-to-br ${t()} border-2 shadow-lg transition-all duration-500 hover:shadow-xl hover:scale-[1.02]`,style:{animationDelay:150*r+"ms"},children:[l.jsx("div",{"code-path":"src/components/StorySection.tsx:77:13",className:"absolute -top-3 left-6 px-4 py-1 bg-gradient-to-r from-pink-500 to-purple-600 text-white text-sm font-bold rounded-full shadow-lg",children:e.year}),l.jsxs("div",{"code-path":"src/components/StorySection.tsx:81:13",className:"mt-2",children:[l.jsxs("h3",{"code-path":"src/components/StorySection.tsx:82:15",className:"text-xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:[l.jsx(G,{"code-path":"src/components/StorySection.tsx:83:17",className:"w-5 h-5 text-pink-500"}),e.title]}),l.jsx("p",{"code-path":"src/components/StorySection.tsx:86:15",className:"text-gray-600 leading-relaxed",children:e.content})]}),l.jsx("div",{"code-path":"src/components/StorySection.tsx:92:13",className:"absolute bottom-2 right-2 opacity-20",children:l.jsx(G,{"code-path":"src/components/StorySection.tsx:93:15",className:"w-8 h-8 text-pink-400"})})]},e.year))})]})}const ms=[{id:"love",name:"Love",icon:l.jsx(G,{"code-path":"src/components/ThemeSelector.tsx:20:11",className:"w-5 h-5"}),color:"from-pink-400 to-rose-500"},{id:"love-sea",name:"Love Sea",icon:l.jsx(re,{"code-path":"src/components/ThemeSelector.tsx:26:11",className:"w-5 h-5"}),color:"from-cyan-400 to-blue-500"},{id:"sakura",name:"Sakura",icon:l.jsx(H,{"code-path":"src/components/ThemeSelector.tsx:32:11",className:"w-5 h-5"}),color:"from-pink-300 to-purple-400"},{id:"space",name:"Space",icon:l.jsx(Z,{"code-path":"src/components/ThemeSelector.tsx:38:11",className:"w-5 h-5"}),color:"from-indigo-400 to-purple-500"},{id:"cat",name:"Cat",icon:l.jsx(F,{"code-path":"src/components/ThemeSelector.tsx:44:11",className:"w-5 h-5"}),color:"from-orange-400 to-yellow-500"},{id:"original",name:"Elegant",icon:l.jsx(ee,{"code-path":"src/components/ThemeSelector.tsx:50:11",className:"w-5 h-5"}),color:"from-slate-400 to-purple-500"}];function ys({currentTheme:e,onSelectTheme:t}){return l.jsx("div",{"code-path":"src/components/ThemeSelector.tsx:57:5",className:"flex flex-wrap justify-center gap-2 p-4",children:ms.map(r=>l.jsxs("button",{"code-path":"src/components/ThemeSelector.tsx:59:9",onClick:()=>t(r.id),className:"relative px-4 py-2 rounded-full font-medium text-sm transition-all duration-300 flex items-center gap-2 "+(e===r.id?`bg-gradient-to-r ${r.color} text-white shadow-lg scale-105`:"bg-white/80 text-gray-600 hover:bg-white hover:shadow-md"),children:[r.icon,l.jsx("span",{"code-path":"src/components/ThemeSelector.tsx:69:11",children:r.name}),e===r.id&&l.jsx("span",{"code-path":"src/components/ThemeSelector.tsx:72:13",className:"absolute inset-0 rounded-full bg-white/20 animate-pulse"})]},r.id))})}function vs({onCapture:e,onClose:t}){const r=f.useRef(null),n=f.useRef(null),s=f.useRef(null),[i,o]=f.useState(null),[a,c]=f.useState(""),[u,h]=f.useState(!1),[d,p]=f.useState(0);f.useEffect(()=>{let e=!0,t=null;return(async()=>{try{const n=performance.now();console.log(" [Camera] Requesting camera permission...");const i=[{video:!0,audio:!1},{video:{facingMode:{ideal:"environment"}},audio:!1},{video:{facingMode:{ideal:"environment"},width:{max:640},height:{max:480}},audio:!1}];let a=null,l="";for(let e=0;e<i.length;e++)try{console.log(` [Camera] Attempt ${e+1} of ${i.length}...`),a=await Promise.race([navigator.mediaDevices.getUserMedia(i[e]),new Promise((e,t)=>setTimeout(()=>t(new Error("getUserMedia timeout")),5e3))]),l=`Attempt ${e+1}`,console.log(` [Camera] SUCCESS with ${l}`);break}catch(Vg){const r=Vg instanceof Error?Vg.message:"Unknown error";console.log(`  [Camera] Attempt ${e+1} failed: ${r}`);continue}if(!a)throw new Error("Unable to access camera with any configuration. Please check permissions.");const c=a.getVideoTracks();if(0===c.length)throw new Error("Camera stream obtained but no video track available");if(console.log(" [Camera] Got video track:",{enabled:c[0].enabled,readyState:c[0].readyState,width:c[0].getSettings?.().width,height:c[0].getSettings?.().height}),e&&r.current){console.log(" [Camera] Attaching stream to video element..."),r.current.srcObject=a,s.current=a,o(!0);const i=performance.now()-n;p(i),console.log(` [Camera] Stream attached (${i.toFixed(0)}ms)`);const l=()=>{const e=r.current;if(!e)return console.log(" [Camera] Video element missing"),!1;const t=e.videoWidth>0,n=e.videoHeight>0,s=e.readyState>=2,i=c[0]?.enabled??!1;return console.log(" [Camera] Readiness check:",{videoWidth:e.videoWidth,videoHeight:e.videoHeight,readyState:e.readyState,trackEnabled:i,paused:e.paused}),!(!i||!(t&&n||s))&&(console.log(" [Camera] Video ready - frames detected"),!0)};if(l())e&&h(!0);else{let r=0;const n=setInterval(()=>{r++,e?(l()&&(clearInterval(n),h(!0),console.log(` [Camera] Ready after ${200*r}ms`)),r>=10&&(clearInterval(n),console.log(" [Camera] Forcing ready after max attempts"),h(!0))):clearInterval(n)},200);t=setTimeout(()=>{clearInterval(n),e&&(console.log(" [Camera] Safety timeout - forcing ready"),h(!0))},2500)}}}catch(Vg){if(e){console.error(" [Camera] Error:",Vg);const e=Vg instanceof Error?Vg.message:"Failed to access camera";c(e),o(!1)}}})(),()=>{e=!1,s.current&&(s.current.getTracks().forEach(e=>{e.stop(),console.log(" [Camera] Stopped track:",e.kind)}),s.current=null),r.current&&(r.current.srcObject=null),t&&clearTimeout(t)}},[]);return l.jsx("div",{"code-path":"src/components/CameraCapture.tsx:271:5",className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:272:7",className:"bg-white rounded-lg w-full max-w-2xl overflow-hidden",children:[l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:274:9",className:"bg-gradient-to-r from-pink-500 to-purple-600 p-4 text-white flex items-center justify-between",children:[l.jsx("h2",{"code-path":"src/components/CameraCapture.tsx:275:11",className:"text-xl font-bold",children:" Camera"}),l.jsx("button",{"code-path":"src/components/CameraCapture.tsx:276:11",onClick:t,className:"p-1 hover:bg-white/20 rounded transition",disabled:null===i,children:l.jsx(ne,{"code-path":"src/components/CameraCapture.tsx:281:13",className:"w-6 h-6"})})]}),l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:286:9",className:"p-6 space-y-4",children:[null===i&&l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:288:13",className:"text-center py-12",children:[l.jsx("div",{"code-path":"src/components/CameraCapture.tsx:289:15",className:"inline-block animate-spin mb-4",children:l.jsx($,{"code-path":"src/components/CameraCapture.tsx:290:17",className:"w-8 h-8 text-pink-500"})}),l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:292:15",className:"text-gray-600 font-medium",children:"Initializing camera..."}),l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:293:15",className:"text-gray-500 text-sm mt-2",children:"Requesting device access..."}),l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:294:15",className:"text-gray-400 text-xs mt-4",children:"This may take a few seconds"})]}),!1===i&&l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:299:13",className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:300:15",className:"text-red-800 font-semibold mb-2",children:" Camera Access Denied"}),l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:301:15",className:"text-red-700 text-sm mb-4",children:a}),l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:302:15",className:"text-red-700 text-xs mb-4",children:"Please allow camera access in your browser settings to use Photobox."}),l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:305:15",className:"text-left text-xs text-red-600 bg-red-100 p-3 rounded mb-4 space-y-1",children:[l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:306:17",className:"font-semibold",children:"How to fix:"}),l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:307:17",children:"1. Look for the lock or camera icon in your address bar"}),l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:308:17",children:"2. Click and allow camera permissions"}),l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:309:17",children:"3. Refresh and try again"})]}),l.jsx(It,{"code-path":"src/components/CameraCapture.tsx:311:15",onClick:t,variant:"outline",children:"Close"})]}),!0===i&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:320:15",className:"bg-black rounded-lg overflow-hidden relative",children:[l.jsx("video",{"code-path":"src/components/CameraCapture.tsx:321:17",ref:r,autoPlay:!0,playsInline:!0,muted:!0,onLoadedMetadata:()=>{console.log(" [Camera] Video stream ready to capture (onLoadedMetadata)"),h(!0)},onCanPlay:()=>{console.log(" [Camera] Video can play (onCanPlay)"),h(!0)},onPlay:()=>{console.log(" [Camera] Video playing (onPlay)"),h(!0)},onLoadedData:()=>{console.log(" [Camera] Loaded data (onLoadedData)"),h(!0)},className:"w-full aspect-video object-cover",style:{transform:"scaleX(-1)"}}),!u&&l.jsx("div",{"code-path":"src/components/CameraCapture.tsx:336:19",className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:337:21",className:"text-center",children:[l.jsx("div",{"code-path":"src/components/CameraCapture.tsx:338:23",className:"inline-block animate-spin mb-2",children:l.jsx($,{"code-path":"src/components/CameraCapture.tsx:339:25",className:"w-6 h-6 text-white"})}),l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:341:23",className:"text-white text-sm",children:"Preparing camera..."})]})})]}),l.jsx("canvas",{"code-path":"src/components/CameraCapture.tsx:348:15",ref:n,className:"hidden"}),l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:351:15",className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-900",children:[l.jsx("p",{"code-path":"src/components/CameraCapture.tsx:352:17",className:"font-semibold mb-1",children:" Tips:"}),l.jsxs("ul",{"code-path":"src/components/CameraCapture.tsx:353:17",className:"text-xs space-y-1",children:[l.jsx("li",{"code-path":"src/components/CameraCapture.tsx:354:19",children:" Good lighting = better photos"}),l.jsx("li",{"code-path":"src/components/CameraCapture.tsx:355:19",children:" Keep the camera steady"}),l.jsx("li",{"code-path":"src/components/CameraCapture.tsx:356:19",children:" Make sure you're centered in frame"})]})]}),l.jsxs("div",{"code-path":"src/components/CameraCapture.tsx:361:15",className:"flex gap-3 justify-end",children:[l.jsx(It,{"code-path":"src/components/CameraCapture.tsx:362:17",onClick:t,variant:"outline",disabled:!u,children:"Cancel"}),l.jsxs(It,{"code-path":"src/components/CameraCapture.tsx:369:17",onClick:()=>{if(r.current&&n.current)try{const t=n.current,s=r.current,i=t.getContext("2d",{willReadFrequently:!0});if(!i)return;const o=s.videoWidth||640,a=s.videoHeight||480;t.width=o,t.height=a;const l=function(e,t){return{quality:Math.min(.95,.85+Math.min(e,640)/1280*.1),maxWidth:Math.min(e,1920),maxHeight:Math.min(t,1080)}}(o,a);i.drawImage(s,0,0,t.width,t.height);const c=t.toDataURL("image/jpeg",l.quality);console.log(" [Camera] Photo captured successfully",{width:t.width,height:t.height,size:c.length,quality:l.quality.toFixed(2),loadTime:d.toFixed(0)+"ms"}),e(c)}catch(t){console.error(" [Camera] Capture failed:",t),c("Failed to capture photo. Please try again.")}},className:"bg-gradient-to-r from-pink-500 to-purple-600 text-white hover:from-pink-600 hover:to-purple-700 disabled:opacity-50",disabled:!u,children:[l.jsx($,{"code-path":"src/components/CameraCapture.tsx:374:19",className:"w-4 h-4 mr-2"}),"Take Photo"]})]})]})]})]})})}function bs(e,t,r){return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e;var n}class ws{constructor(){bs(this,"browserShadowBlurConstant",1),bs(this,"DPI",96),bs(this,"devicePixelRatio","undefined"!=typeof window?window.devicePixelRatio:1),bs(this,"perfLimitSizeTotal",2097152),bs(this,"maxCacheSideLimit",4096),bs(this,"minCacheSideLimit",256),bs(this,"disableStyleCopyPaste",!1),bs(this,"enableGLFiltering",!0),bs(this,"textureSize",4096),bs(this,"forceGLPutImageData",!1),bs(this,"cachesBoundsOfCurve",!1),bs(this,"fontPaths",{}),bs(this,"NUM_FRACTION_DIGITS",4)}}const xs=new class extends ws{constructor(e){super(),this.configure(e)}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,e)}addFonts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.fontPaths={...this.fontPaths,...e}}removeFonts(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(e=>{delete this.fontPaths[e]})}clearFonts(){this.fontPaths={}}restoreDefaults(e){const t=new ws,r=(null==e?void 0:e.reduce((e,r)=>(e[r]=t[r],e),{}))||t;this.configure(r)}},_s=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return console[e]("fabric",...r)};class Ss extends Error{constructor(e,t){super(`fabric: ${e}`,t)}}class ks extends Ss{constructor(e){super(`${e} 'options.signal' is in 'aborted' state`)}}class Cs{}class Ts extends Cs{testPrecision(e,t){const r=`precision ${t} float;\nvoid main(){}`,n=e.createShader(e.FRAGMENT_SHADER);return!!n&&(e.shaderSource(n,r),e.compileShader(n),!!e.getShaderParameter(n,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(e=>this.testPrecision(t,e)),t.getExtension("WEBGL_lose_context").loseContext(),_s("log",`WebGL: max texture size ${this.maxTextureSize}`))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const Es={};let Os;const js=()=>Os||(Os={document:document,window:window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new Ts,dispose(){},copyPasteData:Es}),Ps=()=>js().document,As=()=>js().window,Ds=()=>{var e;return Math.max(null!==(e=xs.devicePixelRatio)&&void 0!==e?e:As().devicePixelRatio,1)},Ns=new class{constructor(){bs(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(e){let{fontFamily:t,fontStyle:r,fontWeight:n}=e;t=t.toLowerCase();const s=this.charWidthsCache;s.has(t)||s.set(t,new Map);const i=s.get(t),o=`${r.toLowerCase()}_${(n+"").toLowerCase()}`;return i.has(o)||i.set(o,new Map),i.get(o)}clearFontCache(e){e?this.charWidthsCache.delete((e||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(e){const{perfLimitSizeTotal:t}=xs,r=Math.sqrt(t*e);return[Math.floor(r),Math.floor(t/r)]}},Ms="7.1.0";function Rs(){}const Ls=Math.PI/2,Is=Math.PI/4,$s=2*Math.PI,Fs=Math.PI/180,zs=Object.freeze([1,0,0,1,0,0]),Bs=16,Us=.4477152502,Ws="center",Vs="left",Hs="top",Gs="bottom",Ys="right",qs="none",Xs=/\r?\n/,Ks="moving",Js="scaling",Qs="rotating",Zs="rotate",ei="skewing",ti="resizing",ri="modifyPoly",ni="modifyPath",si="changed",ii="scale",oi="scaleX",ai="scaleY",li="skewX",ci="skewY",ui="fill",hi="stroke",di="modified",fi="ltr",pi="rtl",gi="normal",mi="json",yi="svg",vi=new class{constructor(){this[mi]=new Map,this[yi]=new Map}has(e){return this[mi].has(e)}getClass(e){const t=this[mi].get(e);if(!t)throw new Ss(`No class registered for ${e}`);return t}setClass(e,t){t?this[mi].set(t,e):(this[mi].set(e.type,e),this[mi].set(e.type.toLowerCase(),e))}getSVGClass(e){return this[yi].get(e)}setSVGClass(e,t){this[yi].set(null!=t?t:e.type.toLowerCase(),e)}},bi=new class extends Array{remove(e){const t=this.indexOf(e);t>-1&&this.splice(t,1)}cancelAll(){const e=this.splice(0);return e.forEach(e=>e.abort()),e}cancelByCanvas(e){if(!e)return[];const t=this.filter(t=>{var r;return t.target===e||"object"==typeof t.target&&(null===(r=t.target)||void 0===r?void 0:r.canvas)===e});return t.forEach(e=>e.abort()),t}cancelByTarget(e){if(!e)return[];const t=this.filter(t=>t.target===e);return t.forEach(e=>e.abort()),t}};class wi{constructor(){bs(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),"object"==typeof e)return Object.entries(e).forEach(e=>{let[t,r]=e;this.on(t,r)}),()=>this.off(e);if(t){const r=e;return this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(t),()=>this.off(r,t)}return()=>!1}once(e,t){if("object"==typeof e){const t=[];return Object.entries(e).forEach(e=>{let[r,n]=e;t.push(this.once(r,n))}),()=>t.forEach(e=>e())}if(t){const r=this.on(e,function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];t.call(this,...n),r()});return r}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const r=this.__eventListeners[e],n=r.indexOf(t);n>-1&&r.splice(n,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(void 0===e)for(const r in this.__eventListeners)this._removeEventListener(r);else"object"==typeof e?Object.entries(e).forEach(e=>{let[t,r]=e;this._removeEventListener(t,r)}):this._removeEventListener(e,t)}fire(e,t){var r;if(!this.__eventListeners)return;const n=null===(r=this.__eventListeners[e])||void 0===r?void 0:r.concat();if(n)for(let s=0;s<n.length;s++)n[s].call(this,t||{})}}const xi=(e,t)=>{const r=e.indexOf(t);return-1!==r&&e.splice(r,1),e},_i=e=>{if(0===e)return 1;switch(Math.abs(e)/Ls){case 1:case 3:return 0;case 2:return-1}return Math.cos(e)},Si=e=>{if(0===e)return 0;const t=e/Ls,r=Math.sign(e);switch(t){case 1:return r;case 2:return 0;case 3:return-r}return Math.sin(e)};class ki{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"object"==typeof e?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new ki(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new ki(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new ki(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new ki(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new ki(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new ki(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new ki(this.x/e.x,this.y/e.y)}scalarDivide(e){return new ki(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new ki(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)}midPointFrom(e){return this.lerp(e)}min(e){return new ki(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new ki(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return`${this.x},${this.y}`}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,r=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=r}clone(){return new ki(this.x,this.y)}rotate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ci;const r=Si(e),n=_i(e),s=this.subtract(t);return new ki(s.x*n-s.y*r,s.x*r+s.y*n).add(t)}transform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new ki(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const Ci=new ki(0,0),Ti=e=>!!e&&Array.isArray(e._objects);function Ei(e){class t extends e{constructor(){super(...arguments),bs(this,"_objects",[])}_onObjectAdded(e){}_onObjectRemoved(e){}_onStackOrderChanged(e){}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=this._objects.push(...t);return t.forEach(e=>this._onObjectAdded(e)),n}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this._objects.splice(e,0,...r),r.forEach(e=>this._onObjectAdded(e)),this._objects.length}remove(){const e=this._objects,t=[];for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return n.forEach(r=>{const n=e.indexOf(r);-1!==n&&(e.splice(n,1),t.push(r),this._onObjectRemoved(r))}),t}forEachObject(e){this.getObjects().forEach((t,r,n)=>e(t,r,n))}getObjects(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?[...this._objects]:this._objects.filter(e=>e.isType(...t))}item(e){return this._objects[e]}isEmpty(){return 0===this._objects.length}size(){return this._objects.length}contains(e,r){return!!this._objects.includes(e)||!!r&&this._objects.some(r=>r instanceof t&&r.contains(e,!0))}complexity(){return this._objects.reduce((e,t)=>e+(t.complexity?t.complexity():0),0)}sendObjectToBack(e){return!(!e||e===this._objects[0]||(xi(this._objects,e),this._objects.unshift(e),this._onStackOrderChanged(e),0))}bringObjectToFront(e){return!(!e||e===this._objects[this._objects.length-1]||(xi(this._objects,e),this._objects.push(e),this._onStackOrderChanged(e),0))}sendObjectBackwards(e,t){if(!e)return!1;const r=this._objects.indexOf(e);if(0!==r){const n=this.findNewLowerIndex(e,r,t);return xi(this._objects,e),this._objects.splice(n,0,e),this._onStackOrderChanged(e),!0}return!1}bringObjectForward(e,t){if(!e)return!1;const r=this._objects.indexOf(e);if(r!==this._objects.length-1){const n=this.findNewUpperIndex(e,r,t);return xi(this._objects,e),this._objects.splice(n,0,e),this._onStackOrderChanged(e),!0}return!1}moveObjectTo(e,t){return e!==this._objects[t]&&(xi(this._objects,e),this._objects.splice(t,0,e),this._onStackOrderChanged(e),!0)}findNewLowerIndex(e,t,r){let n;if(r){n=t;for(let r=t-1;r>=0;--r)if(e.isOverlapping(this._objects[r])){n=r;break}}else n=t-1;return n}findNewUpperIndex(e,t,r){let n;if(r){n=t;for(let r=t+1;r<this._objects.length;++r)if(e.isOverlapping(this._objects[r])){n=r;break}}else n=t+1;return n}collectObjects(e){let{left:t,top:r,width:n,height:s}=e,{includeIntersecting:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=[],a=new ki(t,r),l=a.add(new ki(n,s));for(let c=this._objects.length-1;c>=0;c--){const e=this._objects[c];e.selectable&&e.visible&&(i&&e.intersectsWithRect(a,l)||e.isContainedWithinRect(a,l)||i&&e.containsPoint(a)||i&&e.containsPoint(l))&&o.push(e)}return o}}return t}class Oi extends wi{_setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return"object"==typeof e?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return"boolean"==typeof t&&this.set(e,!t),this}get(e){return this[e]}}function ji(e){return As().requestAnimationFrame(e)}let Pi=0;const Ai=()=>Pi++,Di=()=>{const e=Ps().createElement("canvas");if(!e||void 0===e.getContext)throw new Ss("Failed to create `canvas` element");return e},Ni=e=>{const t=Di();return t.width=e.width,t.height=e.height,t},Mi=(e,t,r)=>e.toDataURL(`image/${t}`,r),Ri=(e,t,r)=>new Promise((n,s)=>{e.toBlob(n,`image/${t}`,r)}),Li=e=>e*Fs,Ii=e=>e/Fs,$i=(e,t,r)=>new ki(e).transform(t,r),Fi=e=>{const t=1/(e[0]*e[3]-e[1]*e[2]),r=[t*e[3],-t*e[1],-t*e[2],t*e[0],0,0],{x:n,y:s}=new ki(e[4],e[5]).transform(r,!0);return r[4]=-n,r[5]=-s,r},zi=(e,t,r)=>[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],r?0:e[0]*t[4]+e[2]*t[5]+e[4],r?0:e[1]*t[4]+e[3]*t[5]+e[5]],Bi=(e,t)=>e.reduceRight((e,r)=>r&&e?zi(r,e,t):r||e,void 0)||zs.concat(),Ui=e=>{let[t,r]=e;return Math.atan2(r,t)},Wi=e=>{const t=Ui(e),r=Math.pow(e[0],2)+Math.pow(e[1],2),n=Math.sqrt(r),s=(e[0]*e[3]-e[2]*e[1])/n,i=Math.atan2(e[0]*e[2]+e[1]*e[3],r);return{angle:Ii(t),scaleX:n,scaleY:s,skewX:Ii(i),skewY:0,translateX:e[4]||0,translateY:e[5]||0}},Vi=function(e){return[1,0,0,1,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0]};function Hi(){let{angle:e=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{x:t=0,y:r=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Li(e),s=_i(n),i=Si(n);return[s,i,-i,s,t?t-(s*t-i*r):0,r?r-(i*t+s*r):0]}const Gi=function(e){return[e,0,0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,0,0]},Yi=e=>Math.tan(Li(e)),qi=e=>[1,0,Yi(e),1,0,0],Xi=e=>[1,Yi(e),0,1,0,0],Ki=e=>{let{scaleX:t=1,scaleY:r=1,flipX:n=!1,flipY:s=!1,skewX:i=0,skewY:o=0}=e,a=Gi(n?-t:t,s?-r:r);return i&&(a=zi(a,qi(i),!0)),o&&(a=zi(a,Xi(o),!0)),a},Ji=e=>{const{translateX:t=0,translateY:r=0,angle:n=0}=e;let s=Vi(t,r);n&&(s=zi(s,Hi({angle:n})));const i=Ki(e);return(e=>e.every((e,t)=>e===zs[t]))(i)||(s=zi(s,i)),s},Qi=function(e){let{signal:t,crossOrigin:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,s){if(t&&t.aborted)return s(new ks("loadImage"));const i=Ps().createElement("img");let o;t&&(o=function(e){i.src="",s(e)},t.addEventListener("abort",o,{once:!0}));const a=function(){i.onload=i.onerror=null,o&&(null==t||t.removeEventListener("abort",o)),n(i)};e?(i.onload=a,i.onerror=function(){o&&(null==t||t.removeEventListener("abort",o)),s(new Ss(`Error loading ${i.src}`))},r&&(i.crossOrigin=r),i.src=e):a()})},Zi=function(e){let{signal:t,reviver:r=Rs}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((n,s)=>{const i=[];t&&t.addEventListener("abort",s,{once:!0}),Promise.all(e.map(e=>vi.getClass(e.type).fromObject(e,{signal:t}).then(t=>(r(e,t),i.push(t),t)))).then(n).catch(e=>{i.forEach(e=>{e.dispose&&e.dispose()}),s(e)}).finally(()=>{t&&t.removeEventListener("abort",s)})})},eo=function(e){let{signal:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((r,n)=>{const s=[];t&&t.addEventListener("abort",n,{once:!0});const i=Object.values(e).map(e=>e&&e.type&&vi.has(e.type)?Zi([e],{signal:t}).then(e=>{let[t]=e;return s.push(t),t}):e),o=Object.keys(e);Promise.all(i).then(e=>e.reduce((e,t,r)=>(e[o[r]]=t,e),{})).then(r).catch(e=>{s.forEach(e=>{e.dispose&&e.dispose()}),n(e)}).finally(()=>{t&&t.removeEventListener("abort",n)})})},to=function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).reduce((t,r)=>(r in e&&(t[r]=e[r]),t),{})},ro=(e,t)=>Object.keys(e).reduce((r,n)=>(t(e[n],n,e)&&(r[n]=e[n]),r),{}),no=(e,t)=>parseFloat(Number(e).toFixed(t)),so=e=>"matrix("+e.map(e=>no(e,xs.NUM_FRACTION_DIGITS)).join(" ")+")",io=e=>!!e&&void 0!==e.toLive,oo=e=>!!e&&"function"==typeof e.toObject,ao=e=>!!e&&void 0!==e.offsetX&&"source"in e,lo=e=>!!e&&"multiSelectionStacking"in e;function co(e){const t=e&&uo(e);let r=0,n=0;if(!e||!t)return{left:r,top:n};let s=e;const i=t.documentElement,o=t.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===t?(r=o.scrollLeft||i.scrollLeft||0,n=o.scrollTop||i.scrollTop||0):(r+=s.scrollLeft||0,n+=s.scrollTop||0),1!==s.nodeType||"fixed"!==s.style.position););return{left:r,top:n}}const uo=e=>e.ownerDocument||null,ho=e=>{var t;return(null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView)||null},fo=function(e,t,r){let{width:n,height:s}=r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;e.width=n,e.height=s,i>1&&(e.setAttribute("width",(n*i).toString()),e.setAttribute("height",(s*i).toString()),t.scale(i,i))},po=(e,t)=>{let{width:r,height:n}=t;r&&(e.style.width="number"==typeof r?`${r}px`:r),n&&(e.style.height="number"==typeof n?`${n}px`:n)};function go(e){return void 0!==e.onselectstart&&(e.onselectstart=()=>!1),e.style.userSelect=qs,e}class mo{constructor(e){bs(this,"_originalCanvasStyle",void 0),bs(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(r=e)&&void 0!==r.getContext?e:e&&Ps().getElementById(e)||Di();var r;if(t.hasAttribute("data-fabric"))throw new Ss("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:r}=e;const{el:n}=this.lower;n.classList.remove("lower-canvas"),n.removeAttribute("data-fabric"),n.setAttribute("width",`${t}`),n.setAttribute("height",`${r}`),n.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:r,ctx:n}=this.lower;fo(r,n,e,t)}setCSSDimensions(e){po(this.lower.el,e)}calcOffset(){return function(e){var t;const r=e&&uo(e),n={left:0,top:0};if(!r)return n;const s=(null===(t=ho(e))||void 0===t?void 0:t.getComputedStyle(e,null))||{};n.left+=parseInt(s.borderLeftWidth,10)||0,n.top+=parseInt(s.borderTopWidth,10)||0,n.left+=parseInt(s.paddingLeft,10)||0,n.top+=parseInt(s.paddingTop,10)||0;let i={left:0,top:0};const o=r.documentElement;void 0!==e.getBoundingClientRect&&(i=e.getBoundingClientRect());const a=co(e);return{left:i.left+a.left-(o.clientLeft||0)+n.left,top:i.top+a.top-(o.clientTop||0)+n.top}}(this.lower.el)}dispose(){js().dispose(this.lower.el),delete this.lower}}const yo={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...zs],patternQuality:"best"};class vo extends(Ei(Oi)){get lowerCanvasEl(){var e;return null===(e=this.elements.lower)||void 0===e?void 0:e.el}get contextContainer(){var e;return null===(e=this.elements.lower)||void 0===e?void 0:e.ctx}static getDefaults(){return vo.ownDefaults}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new mo(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const s=super.insertAt(e,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(_s("warn","Canvas is trying to add an object that belongs to a different canvas.\nResulting to default behavior: removing object from previous canvas and adding to new canvas"),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?Ds():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t){const t={width:this.width,height:this.height,...e};this.elements.setDimensions(t,this.getRetinaScaling()),this.hasLostContext=!0,this.width=t.width,this.height=t.height}r||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const r=e,n=[...this.viewportTransform],s=$i(e,Fi(n));n[0]=t,n[3]=t;const i=$i(s,n);n[4]+=r.x-i.x,n[5]+=r.y-i.y,this.setViewportTransform(n)}setZoom(e){this.zoomToPoint(new ki(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new ki(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=ji(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,r=Fi(this.viewportTransform),n=$i({x:0,y:0},r),s=$i({x:e,y:t},r),i=n.min(s),o=n.max(s);return this.vptCoords={tl:i,tr:new ki(o.x,i.y),bl:new ki(i.x,o.y),br:o}}cancelRequestedRender(){var e;this.nextRenderHandle&&(e=this.nextRenderHandle,As().cancelAnimationFrame(e),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const r=this.viewportTransform,n=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality=this.patternQuality,this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),n&&(n._set("canvas",this),n.shouldCache(),n._transformDone=!0,n.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,n)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const r=this.viewportTransform;e.save(),e.transform(...r),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let r=0,n=t.length;r<n;++r)t[r]&&t[r].render(e)}_renderBackgroundOrOverlay(e,t){const r=this[`${t}Color`],n=this[`${t}Image`],s=this.viewportTransform,i=this[`${t}Vpt`];if(!r&&!n)return;const o=io(r);if(r){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=o?r.toLive(e):r,i&&e.transform(...s),o){e.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);const t=r.gradientTransform||r.patternTransform;t&&e.transform(...t)}e.fill(),e.restore()}if(n){e.save();const{skipOffscreen:t}=this;this.skipOffscreen=i,i&&e.transform(...s),n.render(e),this.skipOffscreen=t,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenterPoint(){return new ki(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new ki(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new ki(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new ki(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new ki(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return $i(this.getCenterPoint(),Fi(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Ws,Ws),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const r=this.clipPath,n=r&&!r.excludeFromExport?this._toObject(r,e,t):null;return{version:Ms,...to(this,t),objects:this._objects.filter(e=>!e.excludeFromExport).map(r=>this._toObject(r,e,t)),...this.__serializeBgOverlay(e,t),...n?{clipPath:n}:null}}_toObject(e,t,r){let n;this.includeDefaultValues||(n=e.includeDefaultValues,e.includeDefaultValues=!1);const s=e[t](r);return this.includeDefaultValues||(e.includeDefaultValues=!!n),s}__serializeBgOverlay(e,t){const r={},n=this.backgroundImage,s=this.overlayImage,i=this.backgroundColor,o=this.overlayColor;return io(i)?i.excludeFromExport||(r.background=i.toObject(t)):i&&(r.background=i),io(o)?o.excludeFromExport||(r.overlay=o.toObject(t)):o&&(r.overlay=o),n&&!n.excludeFromExport&&(r.backgroundImage=this._toObject(n,e,t)),s&&!s.excludeFromExport&&(r.overlayImage=this._toObject(s,e,t)),r}toSVG(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const r=[];return this._setSVGPreamble(r,e),this._setSVGHeader(r,e),this.clipPath&&r.push(`<g clip-path="url(#${this.clipPath.clipPathId})" >\n`),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",t),this._setSVGObjects(r,t),this.clipPath&&r.push("</g>\n"),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",t),r.push("</svg>"),r.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')}_setSVGHeader(e,t){const r=t.width||`${this.width}`,n=t.height||`${this.height}`,s=xs.NUM_FRACTION_DIGITS,i=t.viewBox;let o;if(i)o=`viewBox="${i.x} ${i.y} ${i.width} ${i.height}" `;else if(this.svgViewportTransformation){const e=this.viewportTransform;o=`viewBox="${no(-e[4]/e[0],s)} ${no(-e[5]/e[3],s)} ${no(this.width/e[0],s)} ${no(this.height/e[3],s)}" `}else o=`viewBox="0 0 ${this.width} ${this.height}" `;e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',n,'" ',o,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",Ms,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),"</defs>\n")}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId=`CLIPPATH_${Ai()}`,`<clipPath id="${t.clipPathId}" >\n${t.toClipPathSVG(e.reviver)}</clipPath>\n`):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this[`${e}Color`];if(io(t)){const r=this[`${e}Vpt`],n=this.viewportTransform,s={isType:()=>!1,width:this.width/(r?n[0]:1),height:this.height/(r?n[3]:1)};return t.toSVG(s,{additionalTransform:r?so(n):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},r=xs.fontPaths;this._objects.forEach(function t(r){e.push(r),Ti(r)&&r._objects.forEach(t)}),e.forEach(e=>{if(!(n=e)||"function"!=typeof n._renderText)return;var n;const{styles:s,fontFamily:i}=e;!t[i]&&r[i]&&(t[i]=!0,s&&Object.values(s).forEach(e=>{Object.values(e).forEach(e=>{let{fontFamily:n=""}=e;!t[n]&&r[n]&&(t[n]=!0)})}))});const n=Object.keys(t).map(e=>`\t\t@font-face {\n\t\t\tfont-family: '${e}';\n\t\t\tsrc: url('${r[e]}');\n\t\t}\n`).join("");return n?`\t<style type="text/css"><![CDATA[\n${n}]]></style>\n`:""}_setSVGObjects(e,t){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(e,r,t)})}_setSVGObject(e,t,r){e.push(t.toSVG(r))}_setSVGBgOverlayImage(e,t,r){const n=this[t];n&&!n.excludeFromExport&&n.toSVG&&e.push(n.toSVG(r))}_setSVGBgOverlayColor(e,t){const r=this[`${t}Color`];if(r)if(io(r)){const n=r.repeat||"",s=this.width,i=this.height,o=this[`${t}Vpt`]?so(Fi(this.viewportTransform)):"";e.push(`<rect transform="${o} translate(${s/2},${i/2})" x="${r.offsetX-s/2}" y="${r.offsetY-i/2}" width="${"repeat-y"!==n&&"no-repeat"!==n||!ao(r)?s:r.source.width}" height="${"repeat-x"!==n&&"no-repeat"!==n||!ao(r)?i:r.source.height}" fill="url(#SVGID_${r.id})"></rect>\n`)}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',"></rect>\n")}loadFromJSON(e,t){let{signal:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return Promise.reject(new Ss("`json` is undefined"));const{objects:n=[],...s}="string"==typeof e?JSON.parse(e):e,{backgroundImage:i,background:o,overlayImage:a,overlay:l,clipPath:c}=s,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Zi(n,{reviver:t,signal:r}),eo({backgroundImage:i,backgroundColor:o,overlayImage:a,overlayColor:l,clipPath:c},{signal:r})]).then(e=>{let[t,r]=e;return this.clear(),this.add(...t),this.set(s),this.set(r),this.renderOnAddRemove=u,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=Ni(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{format:t="png",quality:r=1,multiplier:n=1,enableRetinaScaling:s=!1}=e,i=n*(s?this.getRetinaScaling():1);return Mi(this.toCanvasElement(i,e),t,r)}toBlob(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{format:t="png",quality:r=1,multiplier:n=1,enableRetinaScaling:s=!1}=e,i=n*(s?this.getRetinaScaling():1);return Ri(this.toCanvasElement(i,e),t,r)}toCanvasElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,{width:t,height:r,left:n,top:s,filter:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=(t||this.width)*e,a=(r||this.height)*e,l=this.getZoom(),c=this.width,u=this.height,h=this.skipControlsDrawing,d=l*e,f=this.viewportTransform,p=[d,0,0,d,(f[4]-(n||0))*e,(f[5]-(s||0))*e],g=this.enableRetinaScaling,m=Ni({width:o,height:a}),y=i?this._objects.filter(e=>i(e)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=p,this.width=o,this.height=a,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(m.getContext("2d"),y),this.viewportTransform=f,this.width=c,this.height=u,this.calcViewportBoundaries(),this.enableRetinaScaling=g,this.skipControlsDrawing=h,m}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),bi.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const r=()=>{this.destroy(),e(!0)};r.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return`#<Canvas (${this.complexity()}): { objects: ${this._objects.length} }>`}}bs(vo,"ownDefaults",yo);const bo=["touchstart","touchmove","touchend"],wo=e=>bo.includes(e.type)||"touch"===e.pointerType,xo=e=>{e.preventDefault(),e.stopPropagation()},_o=e=>{let t=0,r=0,n=0,s=0;for(let i=0,o=e.length;i<o;i++){const{x:o,y:a}=e[i];(o>n||!i)&&(n=o),(o<t||!i)&&(t=o),(a>s||!i)&&(s=a),(a<r||!i)&&(r=a)}return{left:t,top:r,width:n-t,height:s-r}},So=(e,t)=>{const{translateX:r,translateY:n,scaleX:s,scaleY:i,...o}=Wi(t),a=new ki(r,n);e.flipX=!1,e.flipY=!1,Object.assign(e,o),e.set({scaleX:s,scaleY:i}),e.setPositionByOrigin(a,Ws,Ws)},ko=e=>({scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,angle:e.angle,left:e.left,flipX:e.flipX,flipY:e.flipY,top:e.top}),Co=(e,t,r)=>{const n=e/2,s=t/2,i=[new ki(-n,-s),new ki(n,-s),new ki(-n,s),new ki(n,s)].map(e=>e.transform(r)),o=_o(i);return new ki(o.width,o.height)},To=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zs;return zi(Fi(arguments.length>1&&void 0!==arguments[1]?arguments[1]:zs),e)},Eo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zs,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zs;return e.transform(To(t,r))},Oo={left:-.5,top:-.5,center:0,bottom:.5,right:.5},jo=e=>"string"==typeof e?Oo[e]:e-.5,Po=new ki(1,0),Ao=new ki,Do=(e,t)=>e.rotate(t),No=(e,t)=>new ki(t).subtract(e),Mo=e=>e.distanceFrom(Ao),Ro=(e,t)=>Math.atan2(Fo(e,t),zo(e,t)),Lo=e=>Ro(Po,e),Io=e=>e.eq(Ao)?e:e.scalarDivide(Mo(e)),$o=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Io(new ki(-e.y,e.x).scalarMultiply(t?1:-1))},Fo=(e,t)=>e.x*t.y-e.y*t.x,zo=(e,t)=>e.x*t.x+e.y*t.y,Bo=(e,t,r)=>{if(e.eq(t)||e.eq(r))return!0;const n=Fo(t,r),s=Fo(t,e),i=Fo(r,e);return n>=0?s>=0&&i<=0:!(s<=0&&i>=0)},Uo="not-allowed";function Wo(e){return jo(e.originX)===jo(Ws)&&jo(e.originY)===jo(Ws)}function Vo(e){return.5-jo(e)}const Ho=(e,t)=>e[t],Go=(e,t,r,n)=>({e:e,transform:t,pointer:new ki(r,n)});function Yo(e,t,r){const n=r,s=Eo(e.getCenterPoint(),e.canvas.viewportTransform,void 0),i=Lo(No(s,n))+$s;return Math.round(i%$s/Is)}function qo(e,t,r,n,s){var i;let{target:o,corner:a}=e;const l=o.controls[a],c=(null===(i=o.canvas)||void 0===i?void 0:i.getZoom())||1,u=o.padding/c,h=function(e,t,r,n){const s=e.getRelativeCenterPoint(),i=void 0!==r&&void 0!==n?e.translateToGivenOrigin(s,Ws,Ws,r,n):new ki(e.left,e.top);return(e.angle?t.rotate(-Li(e.angle),s):t).subtract(i)}(o,new ki(n,s),t,r);return h.x>=u&&(h.x-=u),h.x<=-u&&(h.x+=u),h.y>=u&&(h.y-=u),h.y<=u&&(h.y+=u),h.x-=l.offsetX,h.y-=l.offsetY,h}const Xo=e=>e.replace(/\s+/g," "),Ko={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Jo=(e,t,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e),Qo=(e,t,r,n)=>{e/=255,t/=255,r/=255;const s=Math.max(e,t,r),i=Math.min(e,t,r);let o,a;const l=(s+i)/2;if(s===i)o=a=0;else{const n=s-i;switch(a=l>.5?n/(2-s-i):n/(s+i),s){case e:o=(t-r)/n+(t<r?6:0);break;case t:o=(r-e)/n+2;break;case r:o=(e-t)/n+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*l),n]},Zo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1";return parseFloat(e)/(e.endsWith("%")?100:1)},ea=e=>Math.min(Math.round(e),255).toString(16).toUpperCase().padStart(2,"0"),ta=e=>{let[t,r,n,s=1]=e;const i=Math.round(.3*t+.59*r+.11*n);return[i,i,i,s]};class ra{constructor(e){if(bs(this,"isUnrecognised",!1),e)if(e instanceof ra)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,r,n,s=1]=e;this.setSource([t,r,n,s])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in Ko&&(e=Ko[e]),"transparent"===e?[255,255,255,0]:ra.sourceFromHex(e)||ra.sourceFromRgb(e)||ra.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,r]=this.getSource();return`rgb(${e},${t},${r})`}toRgba(){return`rgba(${this.getSource().join(",")})`}toHsl(){const[e,t,r]=Qo(...this.getSource());return`hsl(${e},${t}%,${r}%)`}toHsla(){const[e,t,r,n]=Qo(...this.getSource());return`hsla(${e},${t}%,${r}%,${n})`}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,r,n]=this.getSource();return`${ea(e)}${ea(t)}${ea(r)}${ea(Math.round(255*n))}`}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(ta(this.getSource())),this}toBlackWhite(e){const[t,,,r]=ta(this.getSource()),n=t<(e||127)?0:255;return this.setSource([n,n,n,r]),this}overlayWith(e){e instanceof ra||(e=new ra(e));const t=this.getSource(),r=e.getSource(),[n,s,i]=t.map((e,t)=>Math.round(.5*e+.5*r[t]));return this.setSource([n,s,i,t[3]]),this}static fromRgb(e){return ra.fromRgba(e)}static fromRgba(e){return new ra(ra.sourceFromRgb(e))}static sourceFromRgb(e){const t=Xo(e).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(t){const[e,r,n]=t.slice(1,4).map(e=>{const t=parseFloat(e);return e.endsWith("%")?Math.round(2.55*t):t});return[e,r,n,Zo(t[4])]}}static fromHsl(e){return ra.fromHsla(e)}static fromHsla(e){return new ra(ra.sourceFromHsl(e))}static sourceFromHsl(e){const t=Xo(e).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!t)return;const r=(ra.parseAngletoDegrees(t[1])%360+360)%360/360,n=parseFloat(t[2])/100,s=parseFloat(t[3])/100;let i,o,a;if(0===n)i=o=a=s;else{const e=s<=.5?s*(n+1):s+n-s*n,t=2*s-e;i=Jo(t,e,r+1/3),o=Jo(t,e,r),a=Jo(t,e,r-1/3)}return[Math.round(255*i),Math.round(255*o),Math.round(255*a),Zo(t[4])]}static fromHex(e){return new ra(ra.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let r;r=t.length<=4?t.split("").map(e=>e+e):t.match(/.{2}/g);const[n,s,i,o=255]=r.map(e=>parseInt(e,16));return[n,s,i,o/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),r=parseFloat(t);return t.includes("rad")?Ii(r):t.includes("turn")?360*r:r}}const na=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bs;const r=/\D{0,2}$/.exec(e),n=parseFloat(e),s=xs.DPI;switch(null==r?void 0:r[0]){case"mm":return n*s/25.4;case"cm":return n*s/2.54;case"in":return n*s;case"pt":return n*s/72;case"pc":return n*s/72*12;case"em":return n*t;default:return n}},sa=function(e,t){let r,n,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t)if(t.toLive)r=`url(#SVGID_${t.id})`;else{const e=new ra(t),s=e.getAlpha();r=e.toRgb(),1!==s&&(n=s.toString())}else r="none";return s?`${e}: ${r}; ${n?`${e}-opacity: ${n}; `:""}`:`${e}="${r}" ${n?`${e}-opacity="${n}" `:""}`};class ia{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):qs,s=this.strokeDashOffset?this.strokeDashOffset:"0",i=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",l=void 0!==this.opacity?this.opacity:"1",c=this.visible?"":" visibility: hidden;",u=e?"":this.getSvgFilter(),h=sa(ui,this.fill);return[sa(hi,this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",i,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",a,"; ",h,"fill-rule: ",t,"; ","opacity: ",l,";",u,c].join("")}getSvgFilter(){return this.shadow?`filter: url(#SVGID_${this.shadow.id});`:""}getSvgCommons(){return[this.id?`id="${this.id}" `:"",this.clipPath?`clip-path="url(#${this.clipPath.clipPathId})" `:""].join("")}getSvgTransform(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const r=e?this.calcTransformMatrix():this.calcOwnMatrix();return`transform="${so(r)}${t}" `}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:r=""}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),s=e.indexOf("COMMON_PARTS");return e[s]=n,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:r,withShadow:n,additionalTransform:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=t?"":`style="${this.getSvgStyles()}" `,o=n?`style="${this.getSvgFilter()}" `:"",a=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=a&&a.absolutePositioned,u=this.stroke,h=this.fill,d=this.shadow,f=[],p=e.indexOf("COMMON_PARTS");let g;a&&(a.clipPathId=`CLIPPATH_${Ai()}`,g=`<clipPath id="${a.clipPathId}" >\n${a.toClipPathSVG(r)}</clipPath>\n`),c&&f.push("<g ",o,this.getSvgCommons()," >\n"),f.push("<g ",this.getSvgTransform(!1),c?"":o+this.getSvgCommons()," >\n");const m=[i,l,t?"":this.addPaintOrder()," ",s?`transform="${s}" `:""].join("");return e[p]=m,io(h)&&f.push(h.toSVG(this)),io(u)&&f.push(u.toSVG(this)),d&&f.push(d.toSVG(this)),a&&f.push(g),f.push(e.join("")),f.push("</g>\n"),c&&f.push("</g>\n"),r?r(f.join("")):f.join("")}addPaintOrder(){return this.paintFirst!==ui?` paint-order="${this.paintFirst}" `:""}}function oa(e){return new RegExp("^("+e.join("|")+")\\b","i")}const aa="textDecorationThickness",la=["fontSize","fontWeight","fontFamily","fontStyle"],ca=["underline","overline","linethrough"],ua=[...la,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],ha=[...ua,...ca,"textBackgroundColor","direction",aa],da=[...la,...ca,hi,"strokeWidth",ui,"deltaY","textBackgroundColor",aa],fa={_reNewline:Xs,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:gi,fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Vs,fontStyle:gi,lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Vs,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:fi,CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[aa]:66.667},pa="justify",ga="justify-left",ma="justify-right",ya="justify-center",va=String.raw`[-+]?(?:\d*\.\d+|\d+\.?)(?:[eE][-+]?\d+)?`,ba=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+va+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+va+"))?\\s+(.*)"),wa={cx:Vs,x:Vs,r:"radius",cy:Hs,y:Hs,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":aa},xa="font-size",_a="clip-path";oa(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),oa(["symbol","image","marker","pattern","view","svg"]);const Sa=oa(["symbol","g","a","svg","clipPath","defs"]),ka="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",Ca=new RegExp("(?:\\s|^)"+ka+ka+"("+va+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Ta{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t="string"==typeof e?Ta.parseShadow(e):e;Object.assign(this,Ta.ownDefaults,t),this.id=Ai()}static parseShadow(e){const t=e.trim(),[,r=0,n=0,s=0]=(Ca.exec(t)||[]).map(e=>parseFloat(e)||0);return{color:(t.replace(Ca,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:n,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=Do(new ki(this.offsetX,this.offsetY),Li(-e.angle)),r=new ra(this.color);let n=40,s=40;return e.width&&e.height&&(n=100*no((Math.abs(t.x)+this.blur)/e.width,xs.NUM_FRACTION_DIGITS)+20,s=100*no((Math.abs(t.y)+this.blur)/e.height,xs.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),`<filter id="SVGID_${this.id}" y="-${s}%" height="${100+2*s}%" x="-${n}%" width="${100+2*n}%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="${no(this.blur?this.blur/2:0,xs.NUM_FRACTION_DIGITS)}"></feGaussianBlur>\n\t<feOffset dx="${no(t.x,xs.NUM_FRACTION_DIGITS)}" dy="${no(t.y,xs.NUM_FRACTION_DIGITS)}" result="oBlur" ></feOffset>\n\t<feFlood flood-color="${r.toRgb()}" flood-opacity="${r.getAlpha()}"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n`}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=Ta.ownDefaults;return this.includeDefaultValues?e:ro(e,(e,r)=>e!==t[r])}static async fromObject(e){return new this(e)}}bs(Ta,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),bs(Ta,"type","shadow"),vi.setClass(Ta,"shadow");const Ea=(e,t,r)=>Math.max(e,Math.min(t,r)),Oa=[Hs,Vs,oi,ai,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",li,ci],ja=[ui,hi,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],Pa={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Ws,originY:Ws,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:ui,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},Aa=(e,t,r,n)=>-r*Math.cos(e/n*Ls)+r+t,Da=()=>!1;class Na{constructor(e){let{startValue:t,byValue:r,duration:n=500,delay:s=0,easing:i=Aa,onStart:o=Rs,onChange:a=Rs,onComplete:l=Rs,abort:c=Da,target:u}=e;bs(this,"_state","pending"),bs(this,"durationProgress",0),bs(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=n,this.delay=s,this.easing=i,this._onStart=o,this._onChange=a,this._onComplete=l,this._abort=c,this.target=u,this.startValue=t,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return"aborted"===this._state||"completed"===this._state}start(){const e=e=>{"pending"===this._state&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>ji(e),this.delay):ji(e)}tick(e){const t=(e||+new Date)-this.startTime,r=Math.min(t,this.duration);this.durationProgress=r/this.duration;const{value:n,valueProgress:s}=this.calculate(r);this.value=Object.freeze(n),this.valueProgress=s,"aborted"!==this._state&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),ji(this.tick)))}register(){bi.push(this)}unregister(){bi.remove(this)}abort(){this._state="aborted",this.unregister()}}class Ma extends Na{constructor(e){let{startValue:t=0,endValue:r=100,...n}=e;super({...n,startValue:t,byValue:r-t})}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}class Ra extends Na{constructor(e){let{startValue:t=[0],endValue:r=[100],...n}=e;super({...n,startValue:t,byValue:r.map((e,r)=>e-t[r])})}calculate(e){const t=this.startValue.map((t,r)=>this.easing(e,t,this.byValue[r],this.duration,r));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const La=(e,t,r,n)=>t+r*(1-Math.cos(e/n*Ls)),Ia=e=>e&&((t,r,n)=>e(new ra(t).toRgba(),r,n));class $a extends Na{constructor(e){let{startValue:t,endValue:r,easing:n=La,onChange:s,onComplete:i,abort:o,...a}=e;const l=new ra(t).getSource(),c=new ra(r).getSource();super({...a,startValue:l,byValue:c.map((e,t)=>e-l[t]),easing:n,onChange:Ia(s),onComplete:Ia(i),abort:Ia(o)})}calculate(e){const[t,r,n,s]=this.startValue.map((t,r)=>this.easing(e,t,this.byValue[r],this.duration,r)),i=[...[t,r,n].map(Math.round),Ea(0,s,1)];return{value:i,valueProgress:i.map((e,t)=>0!==this.byValue[t]?Math.abs((e-this.startValue[t])/this.byValue[t]):0).find(e=>0!==e)||0}}}function Fa(e){const t=(r=e,Array.isArray(r.startValue)||Array.isArray(r.endValue)?new Ra(e):new Ma(e));var r;return t.start(),t}class za{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.points=this.points.concat(t.filter(e=>!this.includes(e))),this}static isPointContained(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.eq(r))return e.eq(t);if(t.x===r.x)return e.x===t.x&&(n||e.y>=Math.min(t.y,r.y)&&e.y<=Math.max(t.y,r.y));if(t.y===r.y)return e.y===t.y&&(n||e.x>=Math.min(t.x,r.x)&&e.x<=Math.max(t.x,r.x));{const s=No(t,r),i=No(t,e).divide(s);return n?Math.abs(i.x)===Math.abs(i.y):i.x===i.y&&i.x>=0&&i.x<=1}}static isPointInPolygon(e,t){const r=new ki(e).setX(Math.min(e.x-1,...t.map(e=>e.x)));let n=0;for(let s=0;s<t.length;s++){const i=this.intersectSegmentSegment(t[s],t[(s+1)%t.length],e,r);if(i.includes(e))return!0;n+=Number("Intersection"===i.status)}return n%2==1}static intersectLineLine(e,t,r,n){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const o=t.x-e.x,a=t.y-e.y,l=n.x-r.x,c=n.y-r.y,u=e.x-r.x,h=e.y-r.y,d=l*h-c*u,f=o*h-a*u,p=c*o-l*a;if(0!==p){const t=d/p,r=f/p;return(s||0<=t&&t<=1)&&(i||0<=r&&r<=1)?new za("Intersection").append(new ki(e.x+t*o,e.y+t*a)):new za}if(0===d||0===f){const o=s||i||za.isPointContained(e,r,n)||za.isPointContained(t,r,n)||za.isPointContained(r,e,t)||za.isPointContained(n,e,t);return new za(o?"Coincident":void 0)}return new za("Parallel")}static intersectSegmentLine(e,t,r,n){return za.intersectLineLine(e,t,r,n,!1,!0)}static intersectSegmentSegment(e,t,r,n){return za.intersectLineLine(e,t,r,n,!1,!1)}static intersectLinePolygon(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const s=new za,i=r.length;for(let o,a,l,c=0;c<i;c++){if(o=r[c],a=r[(c+1)%i],l=za.intersectLineLine(e,t,o,a,n,!1),"Coincident"===l.status)return l;s.append(...l.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(e,t,r){return za.intersectLinePolygon(e,t,r,!1)}static intersectPolygonPolygon(e,t){const r=new za,n=e.length,s=[];for(let i=0;i<n;i++){const o=e[i],a=e[(i+1)%n],l=za.intersectSegmentPolygon(o,a,t);"Coincident"===l.status?(s.push(l),r.append(o,a)):r.append(...l.points)}return s.length>0&&s.length===e.length?new za("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(e,t,r){const n=t.min(r),s=t.max(r),i=new ki(s.x,n.y),o=new ki(n.x,s.y);return za.intersectPolygonPolygon(e,[n,i,s,o])}}class Ba extends Oi{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?$i(e,this.group.calcTransformMatrix()):e}setXY(e,t,r){this.group&&(e=$i(e,Fi(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,r)}getRelativeXY(){return new ki(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.originX,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.originY;this.setPositionByOrigin(e,t,r)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:r,bl:n}=this.aCoords||(this.aCoords=this.calcACoords()),s=[e,t,r,n];if(this.group){const e=this.group.calcTransformMatrix();return s.map(t=>$i(t,e))}return s}intersectsWithRect(e,t){return"Intersection"===za.intersectPolygonRectangle(this.getCoords(),e,t).status}intersectsWithObject(e){const t=za.intersectPolygonPolygon(this.getCoords(),e.getCoords());return"Intersection"===t.status||"Coincident"===t.status||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:r,top:n,width:s,height:i}=this.getBoundingRect();return r>=e.x&&r+s<=t.x&&n>=e.y&&n+i<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return za.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(r=>r.x<=t.x&&r.x>=e.x&&r.y<=t.y&&r.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.intersectsWithRect(e,t)||this.getCoords().every(r=>(r.x>=t.x||r.x<=e.x)&&(r.y>=t.y||r.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return _o(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(oi,e),this._set(ai,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return(null===(e=this.canvas)||void 0===e?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?Ii(Ui(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return(null===(e=this.canvas)||void 0===e?void 0:e.viewportTransform)||zs.concat()}calcACoords(){const e=Hi({angle:this.angle}),{x:t,y:r}=this.getRelativeCenterPoint(),n=Vi(t,r),s=zi(n,e),i=this._getTransformedDimensions(),o=i.x/2,a=i.y/2;return{tl:$i({x:-o,y:-a},s),tr:$i({x:o,y:-a},s),bl:$i({x:-o,y:a},s),br:$i({x:o,y:a},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,jo(this.originX),jo(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const r=this.transformMatrixKey(e),n=this.matrixCache;return n&&n.key.every((e,t)=>e===r[t])?n.value:(this.group&&(t=zi(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:r,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key.every((t,r)=>t===e[r]))return t.value;const r=this.getRelativeCenterPoint(),n={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=Ji(n);return this.ownMatrixCache={key:e,value:s},s}_getNonTransformedDimensions(){return new ki(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth,...e},r=t.strokeWidth;let n=r,s=0;this.strokeUniform&&(n=0,s=r);const i=t.width+n,o=t.height+n;let a;return a=0===t.skewX&&0===t.skewY?new ki(i*t.scaleX,o*t.scaleY):Co(i,o,Ki(t)),a.scalarAdd(s)}translateToGivenOrigin(e,t,r,n,s){let i=e.x,o=e.y;const a=jo(n)-jo(t),l=jo(s)-jo(r);if(a||l){const e=this._getTransformedDimensions();i+=a*e.x,o+=l*e.y}return new ki(i,o)}translateToCenterPoint(e,t,r){if(t===Ws&&r===Ws)return e;const n=this.translateToGivenOrigin(e,t,r,Ws,Ws);return this.angle?n.rotate(Li(this.angle),e):n}translateToOriginPoint(e,t,r){const n=this.translateToGivenOrigin(e,Ws,Ws,t,r);return this.angle?n.rotate(Li(this.angle),e):n}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?$i(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new ki(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.getPositionByOrigin(e,t)}getPositionByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,r){const n=this.translateToCenterPoint(e,t,r),s=this.translateToOriginPoint(n,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.getPositionByOrigin(Vs,Hs)}positionByLeftTop(e){return this.setPositionByOrigin(e,Vs,Hs)}}let Ua=class e extends Ba{static getDefaults(){return e.ownDefaults}get type(){const e=this.constructor.type;return"FabricObject"===e?"object":e.toLowerCase()}set type(e){_s("warn","Setting type has no effect",e)}constructor(t){super(),bs(this,"_cacheContext",null),Object.assign(this,e.ownDefaults),this.setOptions(t)}_createCacheCanvas(){this._cacheCanvas=Di(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,r=e.height,n=xs.maxCacheSideLimit,s=xs.minCacheSideLimit;if(t<=n&&r<=n&&t*r<=xs.perfLimitSizeTotal)return t<s&&(e.width=s),r<s&&(e.height=s),e;const i=t/r,[o,a]=Ns.limitDimsByArea(i),l=Ea(s,o,n),c=Ea(s,a,n);return t>l&&(e.zoomX/=t/l,e.width=l,e.capped=!0),r>c&&(e.zoomY/=r/c,e.height=c,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),r=t.x*e.x/this.scaleX,n=t.y*e.y/this.scaleY;return{width:Math.ceil(r+2),height:Math.ceil(n+2),zoomX:e.x,zoomY:e.y,x:r,y:n}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:r,height:n,zoomX:s,zoomY:i,x:o,y:a}=this._limitCacheSize(this._getCacheCanvasDimensions()),l=r!==e.width||n!==e.height,c=this.zoomX!==s||this.zoomY!==i;if(!e||!t)return!1;if(l||c){r!==e.width||n!==e.height?(e.width=r,e.height=n):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const l=o/2,c=a/2;return this.cacheTranslationX=Math.round(e.width/2-l)+l,this.cacheTranslationY=Math.round(e.height/2-c)+c,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(s,i),this.zoomX=s,this.zoomY=i,!0}return!1}setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,r=this.calcTransformMatrix(!t);e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}getObjectScaling(){if(!this.group)return new ki(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Wi(this.calcTransformMatrix());return new ki(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return e.scalarMultiply(t*r)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:0===e?1e-4:e}_set(e,t){e!==oi&&e!==ai||(t=this._constrainScale(t)),e===oi&&t<0?(this.flipX=!this.flipX,t*=-1):"scaleY"===e&&t<0?(this.flipY=!this.flipY,t*=-1):"shadow"!==e||!t||t instanceof Ta||(t=new Ta(t));const r=this[e]!==t;return this[e]=t,r&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||r&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:r,cacheTranslationX:n,cacheTranslationY:s}=this,{width:i,height:o}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:r,cacheTranslationX:n,cacheTranslationY:s,width:i,height:o,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return!!this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth}hasFill(){return!!this.fill&&"transparent"!==this.fill}needsItsOwnCache(){return!!(this.paintFirst===hi&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)}drawClipPathOnCache(e,t,r){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(r,0,0),e.restore()}drawObject(e,t,r){const n=this.fill,s=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,r),this.fill=n,this.stroke=s}createClipPathLayer(e,t){const r=Ni(t),n=r.getContext("2d");if(n.translate(t.cacheTranslationX,t.cacheTranslationY),n.scale(t.zoomX,t.zoomY),e._cacheCanvas=r,t.parentClipPaths.forEach(e=>{e.transform(n)}),t.parentClipPaths.push(e),e.absolutePositioned){const e=Fi(this.calcTransformMatrix());n.transform(e[0],e[1],e[2],e[3],e[4],e[5])}return e.transform(n),e.drawObject(n,!0,t),r}_drawClipPath(e,t,r){if(!t)return;t._transformDone=!0;const n=this.createClipPathLayer(t,r);this.drawClipPathOnCache(e,t,n)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,r=this._cacheContext;return!(!t||!r||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&r&&!e&&(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,t.width,t.height),r.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const r=t.stroke;r&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,io(r)?"percentage"===r.gradientUnits||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(e,r):(e.strokeStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:r}=t;r&&(io(r)?(e.fillStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.fillStyle=r)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&0!==t.length&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,r=this.canvas,n=this.getCanvasRetinaScaling(),[s,,,i]=(null==r?void 0:r.viewportTransform)||zs,o=s*n,a=i*n,l=t.nonScaling?new ki(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*xs.browserShadowBlurConstant*(o+a)*(l.x+l.y)/4,e.shadowOffsetX=t.offsetX*o*l.x,e.shadowOffsetY=t.offsetY*a*l.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!io(t))return{offsetX:0,offsetY:0};const r=t.gradientTransform||t.patternTransform,n=-this.width/2+t.offsetX||0,s=-this.height/2+t.offsetY||0;return"percentage"===t.gradientUnits?e.transform(this.width,0,0,this.height,n,s):e.transform(1,0,0,1,n,s),r&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:n,offsetY:s}}_renderPaintInOrder(e){this.paintFirst===hi?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),"evenodd"===this.fillRule?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var r;const n=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),i=n.x/this.scaleX/s,o=n.y/this.scaleY/s,a=Ni({width:Math.ceil(i),height:Math.ceil(o)}),l=a.getContext("2d");l&&(l.beginPath(),l.moveTo(0,0),l.lineTo(i,0),l.lineTo(i,o),l.lineTo(0,o),l.closePath(),l.translate(i/2,o/2),l.scale(n.zoomX/this.scaleX/s,n.zoomY/this.scaleY/s),this._applyPatternGradientTransform(l,t),l.fillStyle=t.toLive(e),l.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(s*this.scaleX/n.zoomX,s*this.scaleY/n.zoomY),e.strokeStyle=null!==(r=l.createPattern(a,"no-repeat"))&&void 0!==r?r:"")}_findCenterFromElement(){return new ki(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(vi.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=ko(this),r=this.group,n=this.shadow,s=Math.abs,i=e.enableRetinaScaling?Ds():1,o=(e.multiplier||1)*i,a=e.canvasProvider||(e=>new vo(e,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&(e=>{e.scaleX=1,e.scaleY=1,e.skewX=0,e.skewY=0,e.flipX=!1,e.flipY=!1,e.rotate(0)})(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&((e,t,r)=>{const n=To(t,r);So(e,zi(n,e.calcOwnMatrix()))})(this,this.getViewportTransform()),this.setCoords();const l=Di(),c=this.getBoundingRect(),u=this.shadow,h=new ki;if(u){const e=u.blur,t=u.nonScaling?new ki(1,1):this.getObjectScaling();h.x=2*Math.round(s(u.offsetX)+e)*s(t.x),h.y=2*Math.round(s(u.offsetY)+e)*s(t.y)}const d=c.width+h.x,f=c.height+h.y;l.width=Math.ceil(d),l.height=Math.ceil(f);const p=a(l);"jpeg"===e.format&&(p.backgroundColor="#fff"),this.setPositionByOrigin(new ki(p.width/2,p.height/2),Ws,Ws);const g=this.canvas;p._objects=[this],this.set("canvas",p),this.setCoords();const m=p.toCanvasElement(o||1,e);return this.set("canvas",g),this.shadow=n,r&&(this.group=r),this.set(t),this.setCoords(),p._objects=[],p.destroy(),m}toDataURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Mi(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ri(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:r,originY:n}=this;if(t){const{x:e,y:t}=this.getRelativeCenterPoint();this.originX=Ws,this.originY=Ws,this.left=e,this.top=t}if(this.set("angle",e),t){const{x:e,y:t}=this.getPositionByOrigin(r,n);this.left=e,this.top=t,this.originX=r,this.originY=n}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){bi.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&js().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((e,r)=>{let[n,s]=r;return e[n]=this._animate(n,s,t),e},{})}_animate(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=e.split("."),s=this.constructor.colorProperties.includes(n[n.length-1]),{abort:i,startValue:o,onChange:a,onComplete:l}=r,c={...r,target:this,startValue:null!=o?o:n.reduce((e,t)=>e[t],this),endValue:t,abort:null==i?void 0:i.bind(this),onChange:(e,t,r)=>{n.reduce((t,r,s)=>(s===n.length-1&&(t[r]=e),t[r]),this),a&&a(e,t,r)},onComplete:(e,t,r)=>{this.setCoords(),l&&l(e,t,r)}};return s?function(e){const t=new $a(e);return t.start(),t}(c):Fa(c)}isDescendantOf(e){const{parent:t,group:r}=this;return t===e||r===e||!!t&&t.isDescendantOf(e)||!!r&&r!==t&&r.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do{t=t.parent,t&&e.push(t)}while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),r=e.getAncestors();if(0===t.length&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[e,...r.slice(0,r.length-1)],common:[this]};for(let n,s=0;s<t.length;s++){if(n=t[s],n===e)return{fork:[this,...t.slice(0,s)],otherFork:[],common:t.slice(s)};for(let i=0;i<r.length;i++){if(this===r[i])return{fork:[],otherFork:[e,...r.slice(0,i)],common:[this,...t]};if(n===r[i])return{fork:[this,...t.slice(0,s)],otherFork:[e,...r.slice(0,i)],common:t.slice(s)}}}return{fork:[this,...t],otherFork:[e,...r],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const r=t.common[0]||this.canvas;if(!r)return;const n=t.fork.pop(),s=t.otherFork.pop(),i=r._objects.indexOf(n),o=r._objects.indexOf(s);return i>-1&&i>o}toObject(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).concat(e.customProperties,this.constructor.customProperties||[]);let r;const n=xs.NUM_FRACTION_DIGITS,{clipPath:s,fill:i,stroke:o,shadow:a,strokeDashArray:l,left:c,top:u,originX:h,originY:d,width:f,height:p,strokeWidth:g,strokeLineCap:m,strokeDashOffset:y,strokeLineJoin:v,strokeUniform:b,strokeMiterLimit:w,scaleX:x,scaleY:_,angle:S,flipX:k,flipY:C,opacity:T,visible:E,backgroundColor:O,fillRule:j,paintFirst:P,globalCompositeOperation:A,skewX:D,skewY:N}=this;s&&!s.excludeFromExport&&(r=s.toObject(t.concat("inverted","absolutePositioned")));const M=e=>no(e,n),R={...to(this,t),type:this.constructor.type,version:Ms,originX:h,originY:d,left:M(c),top:M(u),width:M(f),height:M(p),fill:oo(i)?i.toObject():i,stroke:oo(o)?o.toObject():o,strokeWidth:M(g),strokeDashArray:l?l.concat():l,strokeLineCap:m,strokeDashOffset:y,strokeLineJoin:v,strokeUniform:b,strokeMiterLimit:M(w),scaleX:M(x),scaleY:M(_),angle:M(S),flipX:k,flipY:C,opacity:M(T),shadow:a?a.toObject():a,visible:E,backgroundColor:O,fillRule:j,paintFirst:P,globalCompositeOperation:A,skewX:M(D),skewY:M(N),...r?{clipPath:r}:null};return this.includeDefaultValues?R:this._removeDefaultValues(R)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),r=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return ro(e,(e,t)=>{if(t===Vs||t===Hs||"type"===t)return!0;const n=r[t];return e!==n&&!(Array.isArray(e)&&Array.isArray(n)&&0===e.length&&0===n.length)})}toString(){return`#<${this.constructor.type}>`}static _fromObject(e){let{type:t,...r}=e,{extraParam:n,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return eo(r,s).then(e=>n?(delete e[n],new this(r[n],e)):new this(e))}static fromObject(e,t){return this._fromObject(e,t)}};bs(Ua,"stateProperties",Oa),bs(Ua,"cacheProperties",ja),bs(Ua,"ownDefaults",Pa),bs(Ua,"type","FabricObject"),bs(Ua,"colorProperties",[ui,hi,"backgroundColor"]),bs(Ua,"customProperties",[]),vi.setClass(Ua),vi.setClass(Ua,"object");const Wa=(e,t)=>{var r;const{transform:{target:n}}=t;null===(r=n.canvas)||void 0===r||r.fire(`object:${e}`,{...t,target:n}),n.fire(e,t)},Va=(e,t,r)=>(n,s,i,o)=>{const a=t(n,s,i,o);return a&&Wa(e,{...Go(n,s,i,o),...r}),a};function Ha(e){return(t,r,n,s)=>{const{target:i,originX:o,originY:a}=r,l=i.getPositionByOrigin(o,a),c=e(t,r,n,s);return i.setPositionByOrigin(l,r.originX,r.originY),c}}const Ga=(qa="width",Xa="originX",Ka="x",Ja="scaleX",(e,t,r,n)=>{const s=qo(t,t.originX,t.originY,r,n)[Ka],i=jo(t[Xa]);if(0===i||i>0&&s<0||i<0&&s>0){const{target:e}=t,r=e.strokeWidth/(e.strokeUniform?e[Ja]:1),n=Wo(t)?2:1,i=e[qa],o=Math.abs(s*n/e[Ja])-r;return e.set(qa,Math.max(o,1)),i!==e[qa]}return!1}),Ya=Va(ti,Ha(Ga));var qa,Xa,Ka,Ja;function Qa(e,t,r,n,s){e.save();const{stroke:i,xSize:o,ySize:a,opName:l}=this.commonRenderProps(e,t,r,s,n);let c=o;o>a?e.scale(1,a/o):a>o&&(c=a,e.scale(o/a,1)),e.beginPath(),e.arc(0,0,c/2,0,$s,!1),e[l](),i&&e.stroke(),e.restore()}function Za(e,t,r,n,s){e.save();const{stroke:i,xSize:o,ySize:a,opName:l}=this.commonRenderProps(e,t,r,s,n),c=o/2,u=a/2;e[`${l}Rect`](-c,-u,o,a),i&&e.strokeRect(-c,-u,o,a),e.restore()}class el{constructor(e){bs(this,"visible",!0),bs(this,"actionName",ii),bs(this,"angle",0),bs(this,"x",0),bs(this,"y",0),bs(this,"offsetX",0),bs(this,"offsetY",0),bs(this,"sizeX",0),bs(this,"sizeY",0),bs(this,"touchSizeX",0),bs(this,"touchSizeY",0),bs(this,"cursorStyle","crosshair"),bs(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,r,n){var s;let{tl:i,tr:o,br:a,bl:l}=n;return(null===(s=t.canvas)||void 0===s?void 0:s.getActiveObject())===t&&t.isControlVisible(e)&&za.isPointInPolygon(r,[i,o,a,l])}getActionHandler(e,t,r){return this.actionHandler}getMouseDownHandler(e,t,r){return this.mouseDownHandler}getMouseUpHandler(e,t,r){return this.mouseUpHandler}cursorStyleHandler(e,t,r,n){return t.cursorStyle}getActionName(e,t,r){return t.actionName}getVisibility(e,t){var r,n;return null!==(r=null===(n=e._controlsVisibility)||void 0===n?void 0:n[t])&&void 0!==r?r:this.visible}setVisibility(e,t,r){this.visible=e}positionHandler(e,t,r,n){return new ki(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,r,n,s,i){const o=Bi([Vi(r,n),Hi({angle:e}),Gi((s?this.touchSizeX:this.sizeX)||t,(s?this.touchSizeY:this.sizeY)||t)]);return{tl:new ki(-.5,-.5).transform(o),tr:new ki(.5,-.5).transform(o),br:new ki(.5,.5).transform(o),bl:new ki(-.5,.5).transform(o)}}commonRenderProps(e,t,r,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{cornerSize:i,cornerColor:o,transparentCorners:a,cornerStrokeColor:l}=s,c=i||n.cornerSize,u=this.sizeX||c,h=this.sizeY||c,d=void 0!==a?a:n.transparentCorners,f=d?hi:ui,p=l||n.cornerStrokeColor,g=!d&&!!p;return e.fillStyle=o||n.cornerColor||"",e.strokeStyle=p||"",e.translate(t,r),e.rotate(Li(n.getTotalAngle())),{stroke:g,xSize:u,ySize:h,transparentCorners:d,opName:f}}render(e,t,r,n,s){"circle"===((n=n||{}).cornerStyle||s.cornerStyle)?Qa.call(this,e,t,r,n,s):Za.call(this,e,t,r,n,s)}}const tl=(e,t,r)=>r.lockRotation?Uo:t.cursorStyle,rl=Va(Qs,Ha((e,t,r,n)=>{let{target:s,ex:i,ey:o,theta:a,originX:l,originY:c}=t;const u=s.getPositionByOrigin(l,c);if(Ho(s,"lockRotation"))return!1;const h=Math.atan2(o-u.y,i-u.x),d=Math.atan2(n-u.y,r-u.x);let f=Ii(d-h+a);if(s.snapAngle&&s.snapAngle>0){const e=s.snapAngle,t=s.snapThreshold||e,r=Math.ceil(f/e)*e,n=Math.floor(f/e)*e;Math.abs(f-n)<t?f=n:Math.abs(f-r)<t&&(f=r)}f<0&&(f=360+f),f%=360;const p=s.angle!==f;return s.angle=f,p}));function nl(e,t){const r=t.canvas,n=e[r.uniScaleKey];return r.uniformScaling&&!n||!r.uniformScaling&&n}function sl(e,t,r){const n=Ho(e,"lockScalingX"),s=Ho(e,"lockScalingY");if(n&&s)return!0;if(!t&&(n||s)&&r)return!0;if(n&&"x"===t)return!0;if(s&&"y"===t)return!0;const{width:i,height:o,strokeWidth:a}=e;return 0===i&&0===a&&"y"!==t||0===o&&0===a&&"x"!==t}const il=["e","se","s","sw","w","nw","n","ne","e"],ol=(e,t,r,n)=>{const s=nl(e,r);if(sl(r,0!==t.x&&0===t.y?"x":0===t.x&&0!==t.y?"y":"",s))return Uo;const i=Yo(r,0,n);return`${il[i]}-resize`};function al(e,t,r,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=t.target,o=s.by,a=nl(e,i);let l,c,u,h,d,f;if(sl(i,o,a))return!1;if(t.gestureScale)c=t.scaleX*t.gestureScale,u=t.scaleY*t.gestureScale;else{if(l=qo(t,t.originX,t.originY,r,n),d="y"!==o?Math.sign(l.x||t.signX||1):1,f="x"!==o?Math.sign(l.y||t.signY||1):1,t.signX||(t.signX=d),t.signY||(t.signY=f),Ho(i,"lockScalingFlip")&&(t.signX!==d||t.signY!==f))return!1;if(h=i._getTransformedDimensions(),a&&!o){const e=Math.abs(l.x)+Math.abs(l.y),{original:r}=t,n=e/(Math.abs(h.x*r.scaleX/i.scaleX)+Math.abs(h.y*r.scaleY/i.scaleY));c=r.scaleX*n,u=r.scaleY*n}else c=Math.abs(l.x*i.scaleX/h.x),u=Math.abs(l.y*i.scaleY/h.y);Wo(t)&&(c*=2,u*=2),t.signX!==d&&"y"!==o&&(t.originX=Vo(t.originX),c*=-1,t.signX=d),t.signY!==f&&"x"!==o&&(t.originY=Vo(t.originY),u*=-1,t.signY=f)}const p=i.scaleX,g=i.scaleY;return o?("x"===o&&i.set(oi,c),"y"===o&&i.set(ai,u)):(!Ho(i,"lockScalingX")&&i.set(oi,c),!Ho(i,"lockScalingY")&&i.set(ai,u)),p!==i.scaleX||g!==i.scaleY}const ll=Va(Js,Ha((e,t,r,n)=>al(e,t,r,n))),cl=Va(Js,Ha((e,t,r,n)=>al(e,t,r,n,{by:"x"}))),ul=Va(Js,Ha((e,t,r,n)=>al(e,t,r,n,{by:"y"}))),hl={x:{counterAxis:"y",scale:oi,skew:li,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:ai,skew:ci,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},dl=["ns","nesw","ew","nwse"];function fl(e,t,r,n,s){const{target:i}=r,{counterAxis:o,origin:a,lockSkewing:l,skew:c,flip:u}=hl[e];if(Ho(i,l))return!1;const{origin:h,flip:d}=hl[o],f=jo(r[h])*(i[d]?-1:1),p=-Math.sign(f)*(i[u]?-1:1),g=-(0===i[c]&&qo(r,Ws,Ws,n,s)[e]>0||i[c]>0?1:-1)*p*.5+.5;return Va(ei,Ha((t,r,n,s)=>function(e,t,r){let{target:n,ex:s,ey:i,skewingSide:o,...a}=t;const{skew:l}=hl[e],c=r.subtract(new ki(s,i)).divide(new ki(n.scaleX,n.scaleY))[e],u=n[l],h=a[l],d=Math.tan(Li(h)),f="y"===e?n._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:n._getTransformedDimensions({scaleX:1,scaleY:1}).y,p=2*c*o/Math.max(f,1)+d,g=Ii(Math.atan(p));n.set(l,g);const m=u!==n[l];if(m&&"y"===e){const{skewX:e,scaleX:t}=n,r=n._getTransformedDimensions({skewY:u}),s=n._getTransformedDimensions(),i=0!==e?r.x/s.x:1;1!==i&&n.set(oi,i*t)}return m}(e,r,new ki(n,s))))(t,{...r,[a]:g,skewingSide:p},n,s)}function pl(e,t){return e[t.canvas.altActionKey]}const gl=(e,t,r)=>{const n=pl(e,r);return 0===t.x?n?li:ai:0===t.y?n?ci:oi:""},ml=(e,t,r,n)=>pl(e,r)?((e,t,r,n)=>{if(0!==t.x&&Ho(r,"lockSkewingY"))return Uo;if(0!==t.y&&Ho(r,"lockSkewingX"))return Uo;const s=Yo(r,0,n)%4;return`${dl[s]}-resize`})(0,t,r,n):ol(e,t,r,n),yl=(e,t,r,n)=>pl(e,t.target)?((e,t,r,n)=>fl("y",e,t,r,n))(e,t,r,n):cl(e,t,r,n),vl=(e,t,r,n)=>pl(e,t.target)?((e,t,r,n)=>fl("x",e,t,r,n))(e,t,r,n):ul(e,t,r,n),bl=()=>({ml:new el({x:-.5,y:0,cursorStyleHandler:ml,actionHandler:yl,getActionName:gl}),mr:new el({x:.5,y:0,cursorStyleHandler:ml,actionHandler:yl,getActionName:gl}),mb:new el({x:0,y:.5,cursorStyleHandler:ml,actionHandler:vl,getActionName:gl}),mt:new el({x:0,y:-.5,cursorStyleHandler:ml,actionHandler:vl,getActionName:gl}),tl:new el({x:-.5,y:-.5,cursorStyleHandler:ol,actionHandler:ll}),tr:new el({x:.5,y:-.5,cursorStyleHandler:ol,actionHandler:ll}),bl:new el({x:-.5,y:.5,cursorStyleHandler:ol,actionHandler:ll}),br:new el({x:.5,y:.5,cursorStyleHandler:ol,actionHandler:ll}),mtr:new el({x:0,y:-.5,actionHandler:rl,cursorStyleHandler:tl,offsetY:-40,withConnection:!0,actionName:Zs})});class wl extends Ua{static getDefaults(){return{...super.getDefaults(),...wl.ownDefaults}}constructor(e){super(),Object.assign(this,this.constructor.createControls(),wl.ownDefaults),this.setOptions(e)}static createControls(){return{controls:bl()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,r=t.target,n=t.action;if(this===r&&n&&n.startsWith(ii))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const r=Object.entries(this.oCoords);for(let n=r.length-1;n>=0;n--){const[s,i]=r[n],o=this.controls[s];if(o.shouldActivate(s,this,e,t?i.touchCorner:i.corner))return this.__corner=s,{key:s,control:o,coord:this.oCoords[s]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),r=Vi(t.x,t.y),n=Hi({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=zi(r,n),i=zi(e,s),o=zi(i,[1/e[0],0,0,1/e[3],0,0]),a=this.group?Wi(this.calcTransformMatrix()):void 0;a&&(a.scaleX=Math.abs(a.scaleX),a.scaleY=Math.abs(a.scaleY));const l=this._calculateCurrentDimensions(a),c={};return this.forEachControl((e,t)=>{const r=e.positionHandler(l,o,this,e);c[t]=Object.assign(r,this._calcCornerCoords(e,r))}),c}_calcCornerCoords(e,t){const r=this.getTotalAngle();return{corner:e.calcCornerCoords(r,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(r,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),n=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/n[0],1/n[3]),e.rotate(Li(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n={hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray,...r};e.save(),e.strokeStyle=n.borderColor,this._setLineDash(e,n.borderDashArray),this.strokeBorders(e,t),n.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{hasBorders:r,hasControls:n}=this,s={hasBorders:r,hasControls:n,...t},i=this.getViewportTransform(),o=s.hasBorders,a=s.hasControls,l=zi(i,this.calcTransformMatrix()),c=Wi(l);e.save(),e.translate(c.translateX,c.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(c.angle-=180),e.rotate(Li(this.group?c.angle:this.angle)),o&&this.drawBorders(e,c,t),a&&this.drawControls(e,t),e.restore()}drawBorders(e,t,r){let n;if(r&&r.forActiveSelection||this.group){const e=Co(this.width,this.height,Ki(t)),r=this.isStrokeAccountedForInDimensions()?Ci:(this.strokeUniform?(new ki).scalarAdd(this.canvas?this.canvas.getZoom():1):new ki(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);n=e.add(r).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else n=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,n,r)}drawControlsConnectingLines(e,t){let r=!1;e.beginPath(),this.forEachControl((n,s)=>{n.withConnection&&n.getVisibility(this,s)&&(r=!0,e.moveTo(n.x*t.x,n.y*t.y),e.lineTo(n.x*t.x+n.offsetX,n.y*t.y+n.offsetY))}),r&&e.stroke()}drawControls(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.save();const r=this.getCanvasRetinaScaling(),{cornerStrokeColor:n,cornerDashArray:s,cornerColor:i}=this,o={cornerStrokeColor:n,cornerDashArray:s,cornerColor:i,...t};e.setTransform(r,0,0,r,0,0),e.strokeStyle=e.fillStyle=o.cornerColor,this.transparentCorners||(e.strokeStyle=o.cornerStrokeColor),this._setLineDash(e,o.cornerDashArray),this.forEachControl((t,r)=>{if(t.getVisibility(this,r)){const n=this.oCoords[r];t.render(e,n.x,n.y,o,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.entries(e).forEach(e=>{let[t,r]=e;return this.setControlVisible(t,r)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const r=this.canvas.viewportTransform;t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(t);const n=this.width+4,s=this.height+4;return t.clearRect(-n/2,-s/2,n,s),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function xl(e,t){return t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(r=>{"constructor"!==r&&Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))})}),e}bs(wl,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class _l extends wl{}xl(_l,[ia]),vi.setClass(_l),vi.setClass(_l,"object");class Sl{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new ki(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new ki(1/this.options.scaleX,1/this.options.scaleY):new ki(1,1)}createSideVector(e,t){const r=No(e,t);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(e,t,r){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,r)))}isSkewed(){return 0!==this.options.skewX||0!==this.options.skewY}applySkew(e){const t=new ki(e);return t.y+=t.x*Math.tan(Li(this.options.skewY)),t.x+=t.y*Math.tan(Li(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const kl=new ki;class Cl extends Sl{static getOrthogonalRotationFactor(e,t){const r=t?Ro(e,t):Lo(e);return Math.abs(r)<Ls?-1:1}constructor(e,t,r,n){super(n),bs(this,"AB",void 0),bs(this,"AC",void 0),bs(this,"alpha",void 0),bs(this,"bisector",void 0),this.A=new ki(e),this.B=new ki(t),this.C=new ki(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Ro(this.AB,this.AC),this.bisector=Io(Do(this.AB.eq(kl)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.strokeProjectionMagnitude;const n=this.createSideVector(e,t),s=$o(n),i=Cl.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,r*i)}projectBevel(){const e=[];return(this.alpha%$s===0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),r=1/Math.sin(t/2),n=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*r),s=this.options.strokeUniform?Mo(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Mo(n)/this.strokeProjectionMagnitude<=s&&e.push(this.applySkew(this.A.add(n))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const r=[],n=new ki(Cl.getOrthogonalRotationFactor(this.bisector),Cl.getOrthogonalRotationFactor(new ki(this.bisector.y,this.bisector.x)));return[new ki(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(n),new ki(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(n)].forEach(n=>{Bo(n,e,t)&&r.push(this.A.add(n))}),r}projectRoundWithSkew(e,t){const r=[],{skewX:n,skewY:s,scaleX:i,scaleY:o,strokeUniform:a}=this.options,l=new ki(Math.tan(Li(n)),Math.tan(Li(s))),c=this.strokeProjectionMagnitude,u=a?c/o/Math.sqrt(1/o**2+1/i**2*l.y**2):c/Math.sqrt(1+l.y**2),h=new ki(Math.sqrt(Math.max(c**2-u**2,0)),u),d=a?c/Math.sqrt(1+l.x**2*(1/o)**2/(1/i+1/i*l.x*l.y)**2):c/Math.sqrt(1+l.x**2/(1+l.x*l.y)**2),f=new ki(d,Math.sqrt(Math.max(c**2-d**2,0)));return[f,f.scalarMultiply(-1),h,h.scalarMultiply(-1)].map(e=>this.applySkew(a?e.multiply(this.strokeUniformScalar):e)).forEach(n=>{Bo(n,e,t)&&r.push(this.applySkew(this.A).add(n))}),r}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%$s===0,r=this.applySkew(this.A),n=e[t?0:2].subtract(r),s=e[t?1:0].subtract(r),i=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),o=Fo(n,i)>0,a=o?n:s,l=o?s:n;return this.isSkewed()?e.push(...this.projectRoundWithSkew(a,l)):e.push(...this.projectRoundNoSkew(a,l)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class Tl extends Sl{constructor(e,t,r){super(r),this.A=new ki(e),this.T=new ki(t)}calcOrthogonalProjection(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.strokeProjectionMagnitude;const n=this.createSideVector(e,t);return this.scaleUnitVector($o(n),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new ki(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Cl(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new ki(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(Io(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),n=this.A.add(r);e.push(n.add(t),n.subtract(t))}return e.map(e=>this.applySkew(e))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const El=e=>{const t={};return Object.keys(e).forEach(r=>{t[r]={},Object.keys(e[r]).forEach(n=>{t[r][n]={...e[r][n]}})}),t};let Ol;const jl=e=>{if(Ol||Ol||(Ol="Intl"in As()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Ol){const t=Ol.segment(e);return Array.from(t).map(e=>{let{segment:t}=e;return t})}return Pl(e)},Pl=e=>{const t=[];for(let r,n=0;n<e.length;n++)!1!==(r=Al(e,n))&&t.push(r);return t},Al=(e,t)=>{const r=e.charCodeAt(t);if(isNaN(r))return"";if(r<55296||r>57343)return e.charAt(t);if(55296<=r&&r<=56319){if(e.length<=t+1)throw"High surrogate without following low surrogate";const r=e.charCodeAt(t+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return e.charAt(t)+e.charAt(t+1)}if(0===t)throw"Low surrogate without preceding high surrogate";const n=e.charCodeAt(t-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1},Dl=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.fill!==t.fill||e.stroke!==t.stroke||e.strokeWidth!==t.strokeWidth||e.fontSize!==t.fontSize||e.fontFamily!==t.fontFamily||e.fontWeight!==t.fontWeight||e.fontStyle!==t.fontStyle||e.textDecorationThickness!==t.textDecorationThickness||e.textBackgroundColor!==t.textBackgroundColor||e.deltaY!==t.deltaY||r&&(e.overline!==t.overline||e.underline!==t.underline||e.linethrough!==t.linethrough)},Nl=(e,t)=>{const r=t.split("\n"),n=[];let s=-1,i={};e=El(e);for(let o=0;o<r.length;o++){const t=jl(r[o]);if(e[o])for(let r=0;r<t.length;r++){s++;const t=e[o][r];t&&Object.keys(t).length>0&&(Dl(i,t,!0)?n.push({start:s,end:s+1,style:t}):n[n.length-1].end++),i=t||{}}else s+=t.length,i={}}return n},Ml=(e,t)=>{if(!Array.isArray(e))return El(e);const r=t.split(Xs),n={};let s=-1,i=0;for(let o=0;o<r.length;o++){const t=jl(r[o]);for(let r=0;r<t.length;r++)s++,e[i]&&e[i].start<=s&&s<e[i].end&&(n[o]=n[o]||{},n[o][r]={...e[i].style},s===e[i].end-1&&i++)}return n},Rl=["display","transform",ui,"fill-opacity","fill-rule","opacity",hi,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Ll(e,t){const r=e.nodeName,n=e.getAttribute("class"),s=e.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+r,"i"),t=t.replace(o,""),s&&t.length&&(o=new RegExp("#"+s+i,"i"),t=t.replace(o,"")),n&&t.length){const e=n.split(" ");for(let r=e.length;r--;)o=new RegExp("\\."+e[r]+i,"i"),t=t.replace(o,"")}return 0===t.length}function Il(e,t){let r=!0;const n=Ll(e,t.pop());return n&&t.length&&(r=function(e,t){let r,n=!0;for(;e.parentElement&&1===e.parentElement.nodeType&&t.length;)n&&(r=t.pop()),n=Ll(e=e.parentElement,r);return 0===t.length}(e,t)),n&&r&&0===t.length}function $l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={};for(const n in t)Il(e,n.split(" "))&&(r={...r,...t[n]});return r}const Fl=e=>{var t;return null!==(t=wa[e])&&void 0!==t?t:e},zl=new RegExp(`(${va})`,"gi"),Bl=`(${va})`,Ul=String.raw`(skewX)\(${Bl}\)`,Wl=String.raw`(skewY)\(${Bl}\)`,Vl=String.raw`(rotate)\(${Bl}(?: ${Bl} ${Bl})?\)`,Hl=String.raw`(scale)\(${Bl}(?: ${Bl})?\)`,Gl=String.raw`(translate)\(${Bl}(?: ${Bl})?\)`,Yl=`(?:${String.raw`(matrix)\(${Bl} ${Bl} ${Bl} ${Bl} ${Bl} ${Bl}\)`}|${Gl}|${Vl}|${Hl}|${Ul}|${Wl})`,ql=`(?:${Yl}*)`,Xl=String.raw`^\s*(?:${ql}?)\s*$`,Kl=new RegExp(Xl),Jl=new RegExp(Yl),Ql=new RegExp(Yl,"g");function Zl(e){const t=[];if(!(e=(r=e,Xo(r.replace(zl," $1 ").replace(/,/gi," "))).replace(/\s*([()])\s*/gi,"$1"))||e&&!Kl.test(e))return[...zs];var r;for(const n of e.matchAll(Ql)){const e=Jl.exec(n[0]);if(!e)continue;let r=zs;const s=e.filter(e=>!!e),[,i,...o]=s,[a,l,c,u,h,d]=o.map(e=>parseFloat(e));switch(i){case"translate":r=Vi(a,l);break;case Zs:r=Hi({angle:a},{x:l,y:c});break;case ii:r=Gi(a,l);break;case li:r=qi(a);break;case ci:r=Xi(a);break;case"matrix":r=[a,l,c,u,h,d]}t.push(r)}return Bi(t)}function ec(e,t,r,n){const s=Array.isArray(t);let i,o=t;if(e!==ui&&e!==hi||t!==qs){if("strokeUniform"===e)return"non-scaling-stroke"===t;if("strokeDashArray"===e)o=t===qs?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===e)o=r&&r.transformMatrix?zi(r.transformMatrix,Zl(t)):Zl(t);else if("visible"===e)o=t!==qs&&"hidden"!==t,r&&!1===r.visible&&(o=!1);else if("opacity"===e)o=parseFloat(t),r&&void 0!==r.opacity&&(o*=r.opacity);else if("textAnchor"===e)o="start"===t?Vs:"end"===t?Ys:Ws;else if("charSpacing"===e||e===aa)i=na(t,n)/n*1e3;else if("paintFirst"===e){const e=t.indexOf(ui),r=t.indexOf(hi);o=ui,(e>-1&&r>-1&&r<e||-1===e&&r>-1)&&(o=hi)}else{if("href"===e||"xlink:href"===e||"font"===e||"id"===e)return t;if("imageSmoothing"===e)return"optimizeQuality"===t;i=s?t.map(na):na(t,n)}}else o="";return!s&&isNaN(i)?o:i}function tc(e){const t={},r=e.getAttribute("style");return r?("string"==typeof r?function(e,t){e.replace(/;\s*$/,"").split(";").forEach(e=>{if(!e)return;const[r,n]=e.split(":");t[r.trim().toLowerCase()]=n.trim()})}(r,t):(n=r,s=t,Object.entries(n).forEach(e=>{let[t,r]=e;void 0!==r&&(s[t.toLowerCase()]=r)})),t):t;var n,s}const rc={stroke:"strokeOpacity",fill:"fillOpacity"};function nc(e,t,r){if(!e)return{};let n,s={},i=Bs;e.parentNode&&Sa.test(e.parentNode.nodeName)&&(s=nc(e.parentElement,t,r),s.fontSize&&(n=i=na(s.fontSize)));const o={...t.reduce((t,r)=>{const n=e.getAttribute(r);return n&&(t[r]=n),t},{}),...$l(e,r),...tc(e)};o[_a]&&e.setAttribute(_a,o[_a]),o[xa]&&(n=na(o[xa],i),o[xa]=`${n}`);const a={};for(const c in o){const e=Fl(c),t=ec(e,o[c],s,n);a[e]=t}a&&a.font&&function(e,t){const r=e.match(ba);if(!r)return;const n=r[1],s=r[3],i=r[4],o=r[5],a=r[6];n&&(t.fontStyle=n),s&&(t.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),i&&(t.fontSize=na(i)),a&&(t.fontFamily=a),o&&(t.lineHeight=o===gi?1:o)}(a.font,a);const l={...s,...a};return Sa.test(e.nodeName)?l:function(e){const t=_l.getDefaults();return Object.entries(rc).forEach(r=>{let[n,s]=r;if(void 0===e[s]||""===e[n])return;if(void 0===e[n]){if(!t[n])return;e[n]=t[n]}if(0===e[n].indexOf("url("))return;const i=new ra(e[n]);e[n]=i.setAlpha(no(i.getAlpha()*e[s],2)).toRgba()}),e}(l)}const sc=["rx","ry"];class ic extends _l{static getDefaults(){return{...super.getDefaults(),...ic.ownDefaults}}constructor(e){super(),Object.assign(this,ic.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:r}=this,n=-t/2,s=-r/2,i=this.rx?Math.min(this.rx,t/2):0,o=this.ry?Math.min(this.ry,r/2):0,a=0!==i||0!==o;e.beginPath(),e.moveTo(n+i,s),e.lineTo(n+t-i,s),a&&e.bezierCurveTo(n+t-Us*i,s,n+t,s+Us*o,n+t,s+o),e.lineTo(n+t,s+r-o),a&&e.bezierCurveTo(n+t,s+r-Us*o,n+t-Us*i,s+r,n+t-i,s+r),e.lineTo(n+i,s+r),a&&e.bezierCurveTo(n+Us*i,s+r,n,s+r-Us*o,n,s+r-o),e.lineTo(n,s+o),a&&e.bezierCurveTo(n,s+Us*o,n+Us*i,s,n+i,s),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return super.toObject([...sc,...e])}_toSVG(){const{width:e,height:t,rx:r,ry:n}=this;return["<rect ","COMMON_PARTS",`x="${-e/2}" y="${-t/2}" rx="${r}" ry="${n}" width="${e}" height="${t}" />\n`]}static async fromElement(e,t,r){const{left:n=0,top:s=0,width:i=0,height:o=0,visible:a=!0,...l}=nc(e,this.ATTRIBUTE_NAMES,r);return new this({...t,...l,left:n,top:s,width:i,height:o,visible:Boolean(a&&i&&o)})}}bs(ic,"type","Rect"),bs(ic,"cacheProperties",[...ja,...sc]),bs(ic,"ownDefaults",{rx:0,ry:0}),bs(ic,"ATTRIBUTE_NAMES",[...Rl,"x","y","rx","ry","width","height"]),vi.setClass(ic),vi.setSVGClass(ic);const oc="initialization",ac="added",lc="removed",cc="imperative",uc=(e,t)=>{const{strokeUniform:r,strokeWidth:n,width:s,height:i,group:o}=t,a=o&&o!==e?To(o.calcTransformMatrix(),e.calcTransformMatrix()):null,l=a?t.getRelativeCenterPoint().transform(a):t.getRelativeCenterPoint(),c=!t.isStrokeAccountedForInDimensions(),u=r&&c?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zs,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zs;return e.transform(To(t,r),!0)}(new ki(n,n),void 0,e.calcTransformMatrix()):Ci,h=!r&&c?n:0,d=Co(s+h,i+h,Bi([a,t.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[l.subtract(d),l.add(d)]};class hc{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:r,strategy:n}=e;return t===oc||t===cc||!!r&&n!==r}shouldLayoutClipPath(e){let{type:t,target:{clipPath:r}}=e;return t!==oc&&r&&!r.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:r,target:n}=t;if(r===cc&&t.overrides)return t.overrides;if(0===e.length)return;const{left:s,top:i,width:o,height:a}=_o(e.map(e=>uc(n,e)).reduce((e,t)=>e.concat(t),[])),l=new ki(o,a),c=new ki(s,i).add(l.scalarDivide(2));if(r===oc){const e=this.getInitialSize(t,{size:l,center:c});return{center:c,relativeCorrection:new ki(0,0),size:e}}return{center:c.transform(n.calcOwnMatrix()),size:l}}}bs(hc,"type","strategy");class dc extends hc{shouldPerformLayout(e){return!0}}bs(dc,"type","fit-content"),vi.setClass(dc);const fc="layoutManager";class pc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new dc;bs(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t={bubbles:!0,strategy:this.strategy,...e,prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}};this.onBeforeLayout(t);const r=this.getLayoutResult(t);r&&this.commitLayout(t,r),this.onAfterLayout(t,r),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:r}=t;return[di,Ks,ti,Qs,Js,ei,si,ri,ni].map(t=>e.on(t,e=>this.performLayout(t===di?{type:"object_modified",trigger:t,e:e,target:r}:{type:"object_modifying",trigger:t,e:e,target:r})))}subscribe(e,t){this.unsubscribe(e,t);const r=this.attachHandlers(e,t);this._subscriptions.set(e,r)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(e=>e()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:r}=e,{canvas:n}=t;if(r===oc||r===ac?this.subscribeTargets(e):r===lc&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),n&&n.fire("object:layout:before",{target:t,context:e}),r===cc&&e.deep){const{strategy:r,...n}=e;t.forEachObject(e=>e.layoutManager&&e.layoutManager.performLayout({...n,bubbles:!1,target:e}))}}getLayoutResult(e){const{target:t,strategy:r,type:n}=e,s=r.calcLayoutResult(e,t.getObjects());if(!s)return;const i=n===oc?new ki:t.getRelativeCenterPoint(),{center:o,correction:a=new ki,relativeCorrection:l=new ki}=s,c=i.subtract(o).add(a).transform(n===oc?zs:Fi(t.calcOwnMatrix()),!0).add(l);return{result:s,prevCenter:i,nextCenter:o,offset:c}}commitLayout(e,t){const{target:r}=e,{result:{size:n},nextCenter:s}=t;var i,o;r.set({width:n.x,height:n.y}),this.layoutObjects(e,t),e.type===oc?r.set({left:null!==(i=e.x)&&void 0!==i?i:s.x+n.x*jo(r.originX),top:null!==(o=e.y)&&void 0!==o?o:s.y+n.y*jo(r.originY)}):(r.setPositionByOrigin(s,Ws,Ws),r.setCoords(),r.set("dirty",!0))}layoutObjects(e,t){const{target:r}=e;r.forEachObject(n=>{n.group===r&&this.layoutObject(e,t,n)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,r.clipPath)}layoutObject(e,t,r){let{offset:n}=t;r.set({left:r.left+n.x,top:r.top+n.y})}onAfterLayout(e,t){const{target:r,strategy:n,bubbles:s,prevStrategy:i,...o}=e,{canvas:a}=r;r.fire("layout:after",{context:e,result:t}),a&&a.fire("object:layout:after",{context:e,result:t,target:r});const l=r.parent;s&&null!=l&&l.layoutManager&&((o.path||(o.path=[])).push(r),l.layoutManager.performLayout({...o,target:l})),r.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(e=>e.forEach(e=>e())),e.clear()}toObject(){return{type:fc,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}vi.setClass(pc,fc);class gc extends pc{performLayout(){}}class mc extends(Ei(_l)){static getDefaults(){return{...super.getDefaults(),...mc.ownDefaults}}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),bs(this,"_activeObjects",[]),bs(this,"__objectSelectionTracker",void 0),bs(this,"__objectSelectionDisposer",void 0),Object.assign(this,mc.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var r;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(e=>{this.enterGroup(e,!1)}),this.layoutManager=null!==(r=t.layoutManager)&&void 0!==r?r:new pc,this.layoutManager.performLayout({type:oc,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(_s("error","Group: circular object trees are not supported, this call has no effect"),!1):-1===this._objects.indexOf(e)||(_s("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((e,t,r)=>this.canEnterGroup(e)&&r.indexOf(e)===t)}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=this._filterObjectsBeforeEnteringGroup(t),s=super.add(...n);return this._onAfterObjectsChange(ac,n),s}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(r),i=super.insertAt(e,...s);return this._onAfterObjectsChange(ac,s),i}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(lc,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const r=this[e];return super._set(e,t),"canvas"===e&&r!==t&&(this._objects||[]).forEach(r=>{r._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:r}=t;const n=this._activeObjects;if(e)n.push(r),this._set("dirty",!0);else if(n.length>0){const e=n.indexOf(r);e>-1&&(n.splice(e,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&So(e,zi(Fi(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===e||e.isDescendantOf(r))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(So(e,zi(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const r=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){const e=_l.prototype.shouldCache.call(this);if(e)for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1;return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,r){this._renderBackground(e);for(let s=0;s<this._objects.length;s++){var n;const t=this._objects[s];null!==(n=this.canvas)&&void 0!==n&&n.preserveObjectStacking&&t.group!==this?(e.save(),e.transform(...Fi(this.calcTransformMatrix())),t.render(e),e.restore()):t.group===this&&t.render(e)}this._drawClipPath(e,this.clipPath,r)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.layoutManager.performLayout({target:this,type:cc,...e})}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const r=this.includeDefaultValues;return this._objects.filter(function(e){return!e.excludeFromExport}).map(function(n){const s=n.includeDefaultValues;n.includeDefaultValues=r;const i=n[e||"toObject"](t);return n.includeDefaultValues=s,i})}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this.layoutManager.toObject();return{...super.toObject(["subTargetCheck","interactive",...e]),..."fit-content"!==t.strategy||this.includeDefaultValues?{layoutManager:t}:{},objects:this.__serializeObjects("toObject",e)}}toString(){return`#<Group: (${this.complexity()})>`}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=ic.prototype._toSVG.call(this),r=t.indexOf("COMMON_PARTS");t[r]='for="group" ';const n=t.join("");return e?e(n):n}_toSVG(e){const t=["<g ","COMMON_PARTS"," >\n"],r=this._createSVGBgRect(e);r&&t.push("\t\t",r);for(let n=0;n<this._objects.length;n++)t.push("\t\t",this._objects[n].toSVG(e));return t.push("</g>\n"),t}getSvgStyles(){const e=void 0!==this.opacity&&1!==this.opacity?`opacity: ${this.opacity};`:"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],r=this._createSVGBgRect(e);r&&t.push("\t",r);for(let n=0;n<this._objects.length;n++)t.push("\t",this._objects[n].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:r,objects:n=[],layoutManager:s,...i}=e;return Promise.all([Zi(n,t),eo(i,t)]).then(e=>{let[t,r]=e;const n=new this(t,{...i,...r,layoutManager:new gc});if(s){const e=vi.getClass(s.type),t=vi.getClass(s.strategy);n.layoutManager=new e(new t)}else n.layoutManager=new pc;return n.layoutManager.subscribeTargets({type:oc,target:n,targets:n.getObjects()}),n.setCoords(),n})}}bs(mc,"type","Group"),bs(mc,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),vi.setClass(mc);const yc="\\s*,?\\s*",vc=`${yc}(${va})`,bc=`${vc}${vc}${vc}${yc}([01])${yc}([01])${vc}${vc}`,wc={m:"l",M:"L"},xc=(e,t,r,n,s,i,o,a,l,c,u)=>{const h=_i(e),d=Si(e),f=_i(t),p=Si(t),g=r*s*f-n*i*p+o,m=n*s*f+r*i*p+a;return["C",c+l*(-r*s*d-n*i*h),u+l*(-n*s*d+r*i*h),g+l*(r*s*p+n*i*f),m+l*(n*s*p-r*i*f),g,m]},_c=(e,t,r,n)=>{const s=Math.atan2(t,e),i=Math.atan2(n,r);return i>=s?i-s:2*Math.PI-(s-i)};function Sc(e,t,r,n,s,i,o,a){let l;if(xs.cachesBoundsOfCurve&&(l=[...arguments].join(),Ns.boundsOfCurveCache[l]))return Ns.boundsOfCurveCache[l];const c=Math.sqrt,u=Math.abs,h=[],d=[[0,0],[0,0]];let f=6*e-12*r+6*s,p=-3*e+9*r-9*s+3*o,g=3*r-3*e;for(let w=0;w<2;++w){if(w>0&&(f=6*t-12*n+6*i,p=-3*t+9*n-9*i+3*a,g=3*n-3*t),u(p)<1e-12){if(u(f)<1e-12)continue;const e=-g/f;0<e&&e<1&&h.push(e);continue}const e=f*f-4*g*p;if(e<0)continue;const r=c(e),s=(-f+r)/(2*p);0<s&&s<1&&h.push(s);const o=(-f-r)/(2*p);0<o&&o<1&&h.push(o)}let m=h.length;const y=m,v=Tc(e,t,r,n,s,i,o,a);for(;m--;){const{x:e,y:t}=v(h[m]);d[0][m]=e,d[1][m]=t}d[0][y]=e,d[1][y]=t,d[0][y+1]=o,d[1][y+1]=a;const b=[new ki(Math.min(...d[0]),Math.min(...d[1])),new ki(Math.max(...d[0]),Math.max(...d[1]))];return xs.cachesBoundsOfCurve&&(Ns.boundsOfCurveCache[l]=b),b}const kc=(e,t,r)=>{let[n,s,i,o,a,l,c,u]=r;const h=((e,t,r,n,s,i,o)=>{if(0===r||0===n)return[];let a=0,l=0,c=0;const u=Math.PI,h=o*Fs,d=Si(h),f=_i(h),p=.5*(-f*e-d*t),g=.5*(-f*t+d*e),m=r**2,y=n**2,v=g**2,b=p**2,w=m*y-m*v-y*b;let x=Math.abs(r),_=Math.abs(n);if(w<0){const e=Math.sqrt(1-w/(m*y));x*=e,_*=e}else c=(s===i?-1:1)*Math.sqrt(w/(m*v+y*b));const S=c*x*g/_,k=-c*_*p/x,C=f*S-d*k+.5*e,T=d*S+f*k+.5*t;let E=_c(1,0,(p-S)/x,(g-k)/_),O=_c((p-S)/x,(g-k)/_,(-p-S)/x,(-g-k)/_);0===i&&O>0?O-=2*u:1===i&&O<0&&(O+=2*u);const j=Math.ceil(Math.abs(O/u*2)),P=[],A=O/j,D=8/3*Math.sin(A/4)*Math.sin(A/4)/Math.sin(A/2);let N=E+A;for(let M=0;M<j;M++)P[M]=xc(E,N,f,d,x,_,C,T,D,a,l),a=P[M][5],l=P[M][6],E=N,N+=A;return P})(c-e,u-t,s,i,a,l,o);for(let d=0,f=h.length;d<f;d++)h[d][1]+=e,h[d][2]+=t,h[d][3]+=e,h[d][4]+=t,h[d][5]+=e,h[d][6]+=t;return h},Cc=(e,t,r,n)=>Math.sqrt((r-e)**2+(n-t)**2),Tc=(e,t,r,n,s,i,o,a)=>l=>{const c=l**3,u=3*(f=l)**2*(1-f),h=(e=>3*e*(1-e)**2)(l),d=(e=>(1-e)**3)(l);var f;return new ki(o*c+s*u+r*h+e*d,a*c+i*u+n*h+t*d)},Ec=e=>e**2,Oc=e=>2*e*(1-e),jc=e=>(1-e)**2,Pc=(e,t,r,n,s,i,o,a)=>l=>{const c=Ec(l),u=Oc(l),h=jc(l),d=3*(h*(r-e)+u*(s-r)+c*(o-s)),f=3*(h*(n-t)+u*(i-n)+c*(a-i));return Math.atan2(f,d)},Ac=(e,t,r,n,s,i)=>o=>{const a=Ec(o),l=Oc(o),c=jc(o);return new ki(s*a+r*l+e*c,i*a+n*l+t*c)},Dc=(e,t,r,n,s,i)=>o=>{const a=1-o,l=2*(a*(r-e)+o*(s-r)),c=2*(a*(n-t)+o*(i-n));return Math.atan2(c,l)},Nc=(e,t,r)=>{let n=new ki(t,r),s=0;for(let i=1;i<=100;i+=1){const t=e(i/100);s+=Cc(n.x,n.y,t.x,t.y),n=t}return s},Mc=e=>{let t,r,n=0,s=0,i=0,o=0,a=0;const l=[];for(const c of e){const e={x:s,y:i,command:c[0],length:0};switch(c[0]){case"M":r=e,r.x=o=s=c[1],r.y=a=i=c[2];break;case"L":r=e,r.length=Cc(s,i,c[1],c[2]),s=c[1],i=c[2];break;case"C":t=Tc(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),r=e,r.iterator=t,r.angleFinder=Pc(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),r.length=Nc(t,s,i),s=c[5],i=c[6];break;case"Q":t=Ac(s,i,c[1],c[2],c[3],c[4]),r=e,r.iterator=t,r.angleFinder=Dc(s,i,c[1],c[2],c[3],c[4]),r.length=Nc(t,s,i),s=c[3],i=c[4];break;case"Z":r=e,r.destX=o,r.destY=a,r.length=Cc(s,i,o,a),s=o,i=a}n+=r.length,l.push(r)}return l.push({length:n,x:s,y:i}),l},Rc=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mc(e),n=0;for(;t-r[n].length>0&&n<r.length-2;)t-=r[n].length,n++;const s=r[n],i=t/s.length,o=e[n];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return{...new ki(s.x,s.y).lerp(new ki(s.destX,s.destY),i),angle:Math.atan2(s.destY-s.y,s.destX-s.x)};case"L":return{...new ki(s.x,s.y).lerp(new ki(o[1],o[2]),i),angle:Math.atan2(o[2]-s.y,o[1]-s.x)};case"C":case"Q":return((e,t)=>{let r,n=0,s=0,i={x:e.x,y:e.y},o={...i},a=.01,l=0;const c=e.iterator,u=e.angleFinder;for(;s<t&&a>1e-4;)o=c(n),l=n,r=Cc(i.x,i.y,o.x,o.y),r+s>t?(n-=a,a/=2):(i=o,n+=a,s+=r);return{...o,angle:u(l)}})(s,t)}},Lc=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),Ic=new RegExp(bc,"g"),$c=new RegExp(va,"gi"),Fc={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},zc=(e,t)=>e.map(e=>e.map((e,r)=>0===r||void 0===t?e:no(e,t)).join(" ")).join(" ");function Bc(e,t){const r=e.style;r&&Object.entries(t).forEach(e=>{let[t,n]=e;return r.setProperty(t,n)})}class Uc extends mo{constructor(e){let{allowTouchScrolling:t=!1,containerClass:r=""}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),bs(this,"upper",void 0),bs(this,"container",void 0);const{el:n}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(n,{allowTouchScrolling:t}),this.applyCanvasStyle(s,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const i=this.createContainerElement();i.classList.add(r),n.parentNode&&n.parentNode.replaceChild(i,n),i.append(n,s),this.container=i}createUpperCanvas(){const{el:e}=this.lower,t=Di();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=Ps().createElement("div");return e.setAttribute("data-fabric","wrapper"),Bc(e,{position:"relative"}),go(e),e}applyCanvasStyle(e,t){const{styles:r,allowTouchScrolling:n}=t;Bc(e,{...r,"touch-action":n?"manipulation":qs}),go(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:r,ctx:n}=this.upper;fo(r,n,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),po(this.upper.el,e),po(this.container,e)}cleanupDOM(e){const t=this.container,{el:r}=this.lower,{el:n}=this.upper;super.cleanupDOM(e),t.removeChild(n),t.removeChild(r),t.parentNode&&t.parentNode.replaceChild(r,t)}dispose(){super.dispose(),js().dispose(this.upper.el),delete this.upper,delete this.container}}const Wc=(e,t,r,n)=>{const{target:s,offsetX:i,offsetY:o}=t,a=r-i,l=n-o,c=!Ho(s,"lockMovementX")&&s.left!==a,u=!Ho(s,"lockMovementY")&&s.top!==l;return c&&s.set(Vs,a),u&&s.set(Hs,l),(c||u)&&Wa(Ks,Go(e,t,r,n)),c||u};class Vc extends vo{constructor(){super(...arguments),bs(this,"_hoveredTargets",[]),bs(this,"_currentTransform",null),bs(this,"_groupSelector",null),bs(this,"contextTopDirty",!1)}static getDefaults(){return{...super.getDefaults(),...Vc.ownDefaults}}get upperCanvasEl(){var e;return null===(e=this.elements.upper)||void 0===e?void 0:e.el}get contextTop(){var e;return null===(e=this.elements.upper)||void 0===e?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new Uc(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),r=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,r){const n=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-t+n,-r+n),s.transform(...this.viewportTransform);const i=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(s),e.selectionBackgroundColor=i,s.restore();const o=Math.round(n*this.getRetinaScaling());return((e,t,r,n)=>{const s=2*(n=Math.round(n))+1,{data:i}=e.getImageData(t-n,r-n,s,s);for(let o=3;o<i.length;o+=4)if(i[o]>0)return!1;return!0})(s,o,o,o)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(t=>!!t&&!0===e[t]):e[t])}_shouldClearSelection(e,t){const r=this.getActiveObjects(),n=this._activeObject;return!!(!t||t&&n&&r.length>1&&-1===r.indexOf(t)&&n!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&n&&n!==t)}_shouldCenterTransform(e,t,r){if(!e)return;let n;return t===ii||t===oi||t===ai||t===ti?n=this.centeredScaling||e.centeredScaling:t===Zs&&(n=this.centeredRotation||e.centeredRotation),n?!r:r}_getOriginFromCorner(e,t){const r={x:e.originX,y:e.originY};return t?(["ml","tl","bl"].includes(t)?r.x=Ys:["mr","tr","br"].includes(t)&&(r.x=Vs),["tl","mt","tr"].includes(t)?r.y=Gs:["bl","mb","br"].includes(t)&&(r.y=Hs),r):r}_setupCurrentTransform(e,t,r){var n;const s=t.group?Eo(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:i="",control:o}=t.getActiveControl()||{},a=r&&o?null===(n=o.getActionHandler(e,t,o))||void 0===n?void 0:n.bind(o):Wc,l=((e,t,r,n)=>{if(!t||!e)return"drag";const s=n.controls[t];return s.getActionName(r,s,n)})(r,i,e,t),c=e[this.centeredKey],u=this._shouldCenterTransform(t,l,c)?{x:Ws,y:Ws}:this._getOriginFromCorner(t,i),{scaleX:h,scaleY:d,skewX:f,skewY:p,left:g,top:m,angle:y,width:v,height:b,cropX:w,cropY:x}=t,_={target:t,action:l,actionHandler:a,actionPerformed:!1,corner:i,scaleX:h,scaleY:d,skewX:f,skewY:p,offsetX:s.x-g,offsetY:s.y-m,originX:u.x,originY:u.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:Li(y),width:v,height:b,shiftKey:e.shiftKey,altKey:c,original:{...ko(t),originX:u.x,originY:u.y,cropX:w,cropY:x}};this._currentTransform=_,this.fire("before:transform",{e:e,transform:_})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:r,deltaX:n,deltaY:s}=this._groupSelector,i=new ki(t,r).transform(this.viewportTransform),o=new ki(t+n,r+s).transform(this.viewportTransform),a=this.selectionLineWidth/2;let l=Math.min(i.x,o.x),c=Math.min(i.y,o.y),u=Math.max(i.x,o.x),h=Math.max(i.y,o.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(l,c,u-l,h-c)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,l+=a,c+=a,u-=a,h-=a,_l.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(l,c,u-l,h-c))}findTarget(e){if(this._targetInfo)return this._targetInfo;if(this.skipTargetFind)return{subTargets:[],currentSubTargets:[]};const t=this.getScenePoint(e),r=this._activeObject,n=this.getActiveObjects(),s=this.searchPossibleTargets(this._objects,t),{subTargets:i,container:o,target:a}=s,l={...s,currentSubTargets:i,currentContainer:o,currentTarget:a};if(!r)return l;const c={...this.searchPossibleTargets([r],t),currentSubTargets:i,currentContainer:o,currentTarget:a};if(r.findControl(this.getViewportPoint(e),wo(e)))return{...c,target:r};if(c.target){if(n.length>1)return c;if(!this.preserveObjectStacking)return c;if(this.preserveObjectStacking&&e[this.altSelectionKey])return c}return l}_pointIsInObjectSelectionArea(e,t){let r=e.getCoords();const n=this.getZoom(),s=e.padding/n;if(s){const[e,t,n,i]=r,o=Math.atan2(t.y-e.y,t.x-e.x),a=_i(o)*s,l=Si(o)*s,c=a+l,u=a-l;r=[new ki(e.x-u,e.y-c),new ki(t.x+c,t.y-u),new ki(n.x+u,n.y+c),new ki(i.x-c,i.y+u)]}return za.isPointInPolygon(t,r)}_checkTarget(e,t){if(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;{const r=t.transform(this.viewportTransform);if(!this.isTargetTransparent(e,r.x,r.y))return!0}}return!1}_searchPossibleTargets(e,t,r){let n=e.length;for(;n--;){const s=e[n];if(this._checkTarget(s,t)){if(Ti(s)&&s.subTargetCheck){const{target:e}=this._searchPossibleTargets(s._objects,t,r);e&&r.push(e)}return{target:s,subTargets:r}}}return{subTargets:[]}}searchPossibleTargets(e,t){const r=this._searchPossibleTargets(e,t,[]);r.container=r.target;const{container:n,subTargets:s}=r;if(n&&Ti(n)&&n.interactive&&s[0]){for(let e=s.length-1;e>0;e--){const t=s[e];if(!Ti(t)||!t.interactive)return r.target=t,r}return r.target=s[0],r}return r}getViewportPoint(e){return this._viewportPoint?this._viewportPoint:this._getPointerImpl(e,!0)}getScenePoint(e){return this._scenePoint?this._scenePoint:this._getPointerImpl(e)}_getPointerImpl(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this.upperCanvasEl,n=r.getBoundingClientRect();let s=(e=>{const t=co(e.target),r=function(e){const t=e.changedTouches;return t&&t[0]?t[0]:e}(e);return new ki(r.clientX+t.left,r.clientY+t.top)})(e),i=n.width||0,o=n.height||0;i&&o||(Hs in n&&Gs in n&&(o=Math.abs(n.top-n.bottom)),Ys in n&&Vs in n&&(i=Math.abs(n.right-n.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,t||(s=Eo(s,void 0,this.viewportTransform));const a=this.getRetinaScaling();1!==a&&(s.x/=a,s.y/=a);const l=0===i||0===o?new ki(1,1):new ki(r.width/i,r.height/o);return s.multiply(l)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Di(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return lo(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let r=!1,n=!1;const s=this.getActiveObjects(),i=[],o=[];e.forEach(e=>{s.includes(e)||(r=!0,e.fire("deselected",{e:t,target:e}),o.push(e))}),s.forEach(n=>{e.includes(n)||(r=!0,n.fire("selected",{e:t,target:n}),i.push(n))}),e.length>0&&s.length>0?(n=!0,r&&this.fire("selection:updated",{e:t,selected:i,deselected:o})):s.length>0?(n=!0,this.fire("selection:created",{e:t,selected:i})):e.length>0&&(n=!0,this.fire("selection:cleared",{e:t,deselected:o})),n&&(this._objectsToRender=void 0)}setActiveObject(e,t){const r=this.getActiveObjects(),n=this._setActiveObject(e,t);return this._fireSelectionEvents(r,t),n}_setActiveObject(e,t){const r=this._activeObject;return!(r===e||!this._discardActiveObject(t,e)&&this._activeObject||e.onSelect({e:t})||(this._activeObject=e,lo(e)&&r!==e&&e.set("canvas",this),e.setCoords(),0))}_discardActiveObject(e,t){const r=this._activeObject;return!!r&&!r.onDeselect({e:e,object:t})&&(this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(e),lo(r)&&r===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),r=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e:e,deselected:[r]});const n=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),n}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,r=t.target,n={e:e,target:r,transform:t,action:t.action};r._scaling&&(r._scaling=!1),r.setCoords(),t.actionPerformed&&(this.fire("object:modified",n),r.fire(di,n))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;lo(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,r){const n=this._realizeGroupTransformOnObject(e),s=super._toObject(e,t,r);return e.set(n),s}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&lo(t)&&this._activeObject===t){const r=to(e,["angle","flipX","flipY",Vs,oi,ai,li,ci,Hs]);return((e,t)=>{So(e,zi(t,e.calcOwnMatrix()))})(e,t.calcOwnMatrix()),r}return{}}_setSVGObject(e,t,r){const n=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,r),t.set(n)}}bs(Vc,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!0,fireRightClick:!0,fireMiddleClick:!0,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!0});class Hc{constructor(e){bs(this,"targets",[]),bs(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:t}=e.getActiveObject()||{};t&&t.focus()},r=e.upperCanvasEl;r.addEventListener("click",t),this.__disposer=()=>r.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),xi(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;(null===(t=this.target)||void 0===t?void 0:t.isEditing)&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const Gc={passive:!1},Yc=(e,t)=>({viewportPoint:e.getViewportPoint(t),scenePoint:e.getScenePoint(t)}),qc=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.addEventListener(...r)},Xc=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.removeEventListener(...r)},Kc={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class Jc extends Vc{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),bs(this,"_isClick",void 0),bs(this,"textEditingManager",new Hc(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(e=>{this[e]=this[e].bind(this)}),this.addOrRemove(qc)}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this.upperCanvasEl,n=this._getEventPrefix();e(ho(r),"resize",this._onResize),e(r,n+"down",this._onMouseDown),e(r,`${n}move`,this._onMouseMove,Gc),e(r,`${n}out`,this._onMouseOut),e(r,`${n}enter`,this._onMouseEnter),e(r,"wheel",this._onMouseWheel,{passive:!1}),e(r,"contextmenu",this._onContextMenu),t||(e(r,"click",this._onClick),e(r,"dblclick",this._onClick)),e(r,"dragstart",this._onDragStart),e(r,"dragend",this._onDragEnd),e(r,"dragover",this._onDragOver),e(r,"dragenter",this._onDragEnter),e(r,"dragleave",this._onDragLeave),e(r,"drop",this._onDrop),this.enablePointerEvents||e(r,"touchstart",this._onTouchStart,Gc)}removeListeners(){this.addOrRemove(Xc);const e=this._getEventPrefix(),t=uo(this.upperCanvasEl);Xc(t,`${e}up`,this._onMouseUp),Xc(t,"touchend",this._onTouchEnd,Gc),Xc(t,`${e}move`,this._onMouseMove,Gc),Xc(t,"touchmove",this._onMouseMove,Gc),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_onMouseOut(e){const t=this._hoveredTarget,r={e:e,...Yc(this,e)};this.fire("mouse:out",{...r,target:t}),this._hoveredTarget=void 0,t&&t.fire("mouseout",{...r}),this._hoveredTargets.forEach(e=>{this.fire("mouse:out",{...r,target:e}),e&&e.fire("mouseout",{...r})}),this._hoveredTargets=[]}_onMouseEnter(e){const{target:t}=this.findTarget(e);this._currentTransform||t||(this.fire("mouse:over",{e:e,...Yc(this,e)}),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const r={e:e,target:t};return this.fire("dragstart",r),t.fire("dragstart",r),void qc(this.upperCanvasEl,"drag",this._onDragProgress)}xo(e)}_renderDragEffects(e,t,r){let n=!1;const s=this._dropTarget;s&&s!==t&&s!==r&&(s.clearContextTop(),n=!0),null==t||t.clearContextTop(),r!==t&&(null==r||r.clearContextTop());const i=this.contextTop;i.save(),i.transform(...this.viewportTransform),t&&(i.save(),t.transform(i),t.renderDragSourceEffect(e),i.restore(),n=!0),r&&(i.save(),r.transform(i),r.renderDropTargetEffect(e),i.restore(),n=!0),i.restore(),n&&(this.contextTopDirty=!0)}_onDragEnd(e){const{currentSubTargets:t}=this.findTarget(e),r=!!e.dataTransfer&&e.dataTransfer.dropEffect!==qs,n=r?this._activeObject:void 0,s={e:e,target:this._dragSource,subTargets:t,dragSource:this._dragSource,didDrop:r,dropTarget:n};Xc(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e:e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}_onDragOver(e){const t="dragover",{currentContainer:r,currentSubTargets:n}=this.findTarget(e),s=this._dragSource,i={e:e,target:r,subTargets:n,dragSource:s,canDrop:!1,dropTarget:void 0};let o;this.fire(t,i),this._fireEnterLeaveEvents(e,r,i),r&&(r.canDrop(e)&&(o=r),r.fire(t,i));for(let a=0;a<n.length;a++){const r=n[a];r.canDrop(e)&&(o=r),r.fire(t,i)}this._renderDragEffects(e,s,o),this._dropTarget=o}_onDragEnter(e){const{currentContainer:t,currentSubTargets:r}=this.findTarget(e),n={e:e,target:t,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",n),this._fireEnterLeaveEvents(e,t,n)}_onDragLeave(e){const{currentSubTargets:t}=this.findTarget(e),r={e:e,target:this._draggedoverTarget,subTargets:t,dragSource:this._dragSource};this.fire("dragleave",r),this._fireEnterLeaveEvents(e,void 0,r),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this._hoveredTargets=[]}_onDrop(e){const{currentContainer:t,currentSubTargets:r}=this.findTarget(e),n=this._basicEventHandler("drop:before",{e:e,target:t,subTargets:r,dragSource:this._dragSource,...Yc(this,e)});n.didDrop=!1,n.dropTarget=void 0,this._basicEventHandler("drop",n),this.fire("drop:after",n)}_onContextMenu(e){const{target:t,subTargets:r}=this.findTarget(e),n=this._basicEventHandler("contextmenu:before",{e:e,target:t,subTargets:r});return this.stopContextMenu&&xo(e),this._basicEventHandler("contextmenu",n),!1}_onClick(e){const t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),2==t&&"dblclick"===e.type&&this._handleEvent(e,"dblclick"),3==t&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}fireEventFromPointerEvent(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._cacheTransformEventData(e);const{target:s,subTargets:i}=this.findTarget(e),o={e:e,target:s,subTargets:i,...Yc(this,e),transform:this._currentTransform,...n};this.fire(t,o),s&&s.fire(r,o);for(let a=0;a<i.length;a++)i[a]!==s&&i[a].fire(r,o);this._resetTransformEventData()}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return!0===e.isPrimary||!1!==e.isPrimary&&("touchend"===e.type&&0===e.touches.length||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){this._cacheTransformEventData(e);let t=!this.allowTouchScrolling;const r=this._activeObject;void 0===this.mainTouchId&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e);const{target:n}=this.findTarget(e);(this.isDrawingMode||r&&n===r)&&(t=!0),t&&e.preventDefault();const s=this.upperCanvasEl,i=this._getEventPrefix(),o=uo(s);qc(o,"touchend",this._onTouchEnd,Gc),t&&qc(o,"touchmove",this._onMouseMove,Gc),Xc(s,`${i}down`,this._onMouseDown),this._resetTransformEventData()}_onMouseDown(e){this._cacheTransformEventData(e),this.__onMouseDown(e);const t=this.upperCanvasEl,r=this._getEventPrefix();Xc(t,`${r}move`,this._onMouseMove,Gc);const n=uo(t);qc(n,`${r}up`,this._onMouseUp),qc(n,`${r}move`,this._onMouseMove,Gc),this._resetTransformEventData()}_onTouchEnd(e){if(e.touches.length>0)return;this._cacheTransformEventData(e),this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),r=uo(this.upperCanvasEl);Xc(r,"touchend",this._onTouchEnd,Gc),Xc(r,"touchmove",this._onMouseMove,Gc),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{qc(this.upperCanvasEl,`${t}down`,this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this._cacheTransformEventData(e),this.__onMouseUp(e);const t=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(e)){const e=uo(this.upperCanvasEl);Xc(e,`${r}up`,this._onMouseUp),Xc(e,`${r}move`,this._onMouseMove,Gc),qc(t,`${r}move`,this._onMouseMove,Gc)}this._resetTransformEventData()}_onMouseMove(e){this._cacheTransformEventData(e);const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e),this._resetTransformEventData()}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._handleEvent(e,"up:before");const r=this._currentTransform,n=this._isClick,{target:s}=this.findTarget(e),{button:i}=e;if(i)return void((this.fireMiddleClick&&1===i||this.fireRightClick&&2===i)&&this._handleEvent(e,"up"));if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let o,a,l=!1;if(r&&(this._finalizeCurrentTransform(e),l=r.actionPerformed),!n){const t=s===this._activeObject;this.handleSelection(e),l||(l=this._shouldRender(s)||!t&&s===this._activeObject)}if(s){const t=s.findControl(this.getViewportPoint(e),wo(e)),{key:n,control:i}=t||{};if(a=n,s.selectable&&s!==this._activeObject&&"up"===s.activeOn)this.setActiveObject(s,e),l=!0;else if(i){const t=i.getMouseUpHandler(e,s,i);t&&(o=this.getScenePoint(e),t.call(i,e,r,o.x,o.y))}s.isMoving=!1}if(r&&(r.target!==s||r.corner!==a)){const t=r.target&&r.target.controls[r.corner],n=t&&t.getMouseUpHandler(e,r.target,t);o=o||this.getScenePoint(e),n&&n.call(t,e,r,o.x,o.y)}this._setCursorFromEvent(e,s),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),l?this.requestRenderAll():n||null!==(t=this._activeObject)&&void 0!==t&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:r,subTargets:n=[]}=t;this.fire(e,t),r&&r.fire(e,t);for(let s=0;s<n.length;s++)n[s]!==r&&n[s].fire(e,t);return t}_handleEvent(e,t,r){const{target:n,subTargets:s}=this.findTarget(e),i={e:e,target:n,subTargets:s,...Yc(this,e),transform:this._currentTransform,..."down:before"===t||"down"===t?r:{}};"up:before"!==t&&"up"!==t||(i.isClick=this._isClick),this.fire(`mouse:${t}`,i),n&&n.fire(`mouse${t}`,i);for(let o=0;o<s.length;o++)s[o]!==n&&s[o].fire(`mouse${t}`,i)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e:e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e:e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._handleEvent(e,"down:before");let{target:t}=this.findTarget(e),r=!!t&&t===this._activeObject;const{button:n}=e;if(n)return void((this.fireMiddleClick&&1===n||this.fireRightClick&&2===n)&&this._handleEvent(e,"down",{alreadySelected:r}));if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e))return;if(this._currentTransform)return;let s=this._shouldRender(t),i=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,i=!0,s=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const t=this.getScenePoint(e);this._groupSelector={x:t.x,y:t.y,deltaY:0,deltaX:0}}if(r=!!t&&t===this._activeObject,t){t.selectable&&"down"===t.activeOn&&this.setActiveObject(t,e);const n=t.findControl(this.getViewportPoint(e),wo(e));if(t===this._activeObject&&(n||!i)){this._setupCurrentTransform(e,t,r);const s=n?n.control:void 0,i=this.getScenePoint(e),o=s&&s.getMouseDownHandler(e,t,s);o&&o.call(s,e,this._currentTransform,i.x,i.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:r}),s&&this.requestRenderAll()}_resetTransformEventData(){this._targetInfo=this._viewportPoint=this._scenePoint=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._viewportPoint=this.getViewportPoint(e),this._scenePoint=Eo(this._viewportPoint,void 0,this.viewportTransform),this._targetInfo=this.findTarget(e),this._currentTransform&&(this._targetInfo.target=this._currentTransform.target)}__onMouseMove(e){if(this._isClick=!1,this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const r=this.getScenePoint(e);t.deltaX=r.x-t.x,t.deltaY=r.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const{target:t}=this.findTarget(e);this._setCursorFromEvent(e,t),this._fireOverOutEvents(e,t)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move")}_fireOverOutEvents(e,t){const{_hoveredTarget:r,_hoveredTargets:n}=this,{subTargets:s}=this.findTarget(e),i=Math.max(n.length,s.length);this.fireSyntheticInOutEvents("mouse",{e:e,target:t,oldTarget:r,fireCanvas:!0});for(let o=0;o<i;o++)s[o]===t||n[o]&&n[o]===r||this.fireSyntheticInOutEvents("mouse",{e:e,target:s[o],oldTarget:n[o]});this._hoveredTarget=t,this._hoveredTargets=s}_fireEnterLeaveEvents(e,t,r){const n=this._draggedoverTarget,s=this._hoveredTargets,{subTargets:i}=this.findTarget(e),o=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("drag",{...r,target:t,oldTarget:n,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",{...r,target:i[a],oldTarget:s[a]});this._draggedoverTarget=t}fireSyntheticInOutEvents(e,t){let{target:r,oldTarget:n,fireCanvas:s,e:i,...o}=t;const{targetIn:a,targetOut:l,canvasIn:c,canvasOut:u}=Kc[e],h=n!==r;if(n&&h){const e={...o,e:i,target:n,nextTarget:r,...Yc(this,i)};s&&this.fire(u,e),n.fire(l,e)}if(r&&h){const e={...o,e:i,target:r,previousTarget:n,...Yc(this,i)};s&&this.fire(c,e),r.fire(a,e)}}_transformObject(e){const t=this.getScenePoint(e),r=this._currentTransform,n=r.target,s=n.group?Eo(t,void 0,n.group.calcTransformMatrix()):t;r.shiftKey=e.shiftKey,r.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,r,s),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,r){const{action:n,actionHandler:s,target:i}=t,o=!!s&&s(e,t,r.x,r.y);o&&i.setCoords(),"drag"===n&&o&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||o}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let r=t.hoverCursor||this.hoverCursor;const n=lo(this._activeObject)?this._activeObject:null,s=(!n||t.group!==n)&&t.findControl(this.getViewportPoint(e));if(s){const{control:r,coord:n}=s;this.setCursor(r.cursorStyleHandler(e,r,t,n))}else{if(t.subTargetCheck){const{subTargets:t}=this.findTarget(e);t.concat().reverse().forEach(e=>{r=e.hoverCursor||r})}this.setCursor(r)}}handleMultiSelection(e,t){const r=this._activeObject,n=lo(r);if(r&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(r!==t||n)&&(n||!t.isDescendantOf(r)&&!r.isDescendantOf(t))&&!t.onSelect({e:e})&&!r.getActiveControl()){if(n){const n=r.getObjects();let s=[];if(t===r){const r=this.getScenePoint(e);let i=this.searchPossibleTargets(n,r);if(i.target?(t=i.target,s=i.subTargets):(i=this.searchPossibleTargets(this._objects,r),t=i.target,s=i.subTargets),!t||!t.selectable)return!1}t.group===r?(r.remove(t),this._hoveredTarget=t,this._hoveredTargets=s,1===r.size()&&this._setActiveObject(r.item(0),e)):(r.multiSelectAdd(t),this._hoveredTarget=r,this._hoveredTargets=s),this._fireSelectionEvents(n,e)}else{r.isEditing&&r.exitEditing();const n=new(vi.getClass("ActiveSelection"))([],{canvas:this});n.multiSelectAdd(r,t),this._hoveredTarget=n,this._setActiveObject(n,e),this._fireSelectionEvents([r],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:r,deltaX:n,deltaY:s}=this._groupSelector,i=new ki(t,r),o=i.add(new ki(n,s)),a=i.min(o),l=i.max(o).subtract(a),c=this.collectObjects({left:a.x,top:a.y,width:l.x,height:l.y},{includeIntersecting:!this.selectionFullyContained}),u=i.eq(o)?c[0]?[c[0]]:[]:c.length>1?c.filter(t=>!t.onSelect({e:e})).reverse():c;if(1===u.length)this.setActiveObject(u[0],e);else if(u.length>1){const t=vi.getClass("ActiveSelection");this.setActiveObject(new t(u,{canvas:this}),e)}return this._groupSelector=null,!0}toCanvasElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;const{upper:r}=this.elements;r.ctx=void 0;const n=super.toCanvasElement(e,t);return r.ctx=r.el.getContext("2d"),n}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const Qc={x1:0,y1:0,x2:0,y2:0},Zc={...Qc,r1:0,r2:0},eu=(e,t)=>isNaN(e)&&"number"==typeof t?t:e;function tu(e){return e&&/%$/.test(e)&&Number.isFinite(parseFloat(e))}function ru(e,t){const r="number"==typeof e?e:"string"==typeof e?parseFloat(e)/(tu(e)?100:1):NaN;return Ea(0,eu(r,t),1)}const nu=/\s*;\s*/,su=/\s*:\s*/;function iu(e,t){let r,n;const s=e.getAttribute("style");if(s){const e=s.split(nu);""===e[e.length-1]&&e.pop();for(let t=e.length;t--;){const[s,i]=e[t].split(su).map(e=>e.trim());"stop-color"===s?r=i:"stop-opacity"===s&&(n=i)}}r=r||e.getAttribute("stop-color")||"rgb(0,0,0)",n=eu(parseFloat(n||e.getAttribute("stop-opacity")||""),1);const i=new ra(r);return i.setAlpha(i.getAlpha()*n*t),{offset:ru(e.getAttribute("offset"),0),color:i.toRgba()}}function ou(e,t){const r=[],n=e.getElementsByTagName("stop"),s=ru(t,1);for(let i=n.length;i--;)r.push(iu(n[i],s));return r}function au(e){return"linearGradient"===e.nodeName||"LINEARGRADIENT"===e.nodeName?"linear":"radial"}function lu(e){return"userSpaceOnUse"===e.getAttribute("gradientUnits")?"pixels":"percentage"}function cu(e,t){return e.getAttribute(t)}function uu(e,t){return function(e,t){let r,{width:n,height:s,gradientUnits:i}=t;return Object.entries(e).reduce((e,t)=>{let[o,a]=t;if("Infinity"===a)r=1;else if("-Infinity"===a)r=0;else{const e="string"==typeof a;r=e?parseFloat(a):a,e&&tu(a)&&(r*=.01,"pixels"===i&&("x1"!==o&&"x2"!==o&&"r2"!==o||(r*=n),"y1"!==o&&"y2"!==o||(r*=s)))}return e[o]=r,e},{})}("linear"===au(e)?{x1:cu(r=e,"x1")||0,y1:cu(r,"y1")||0,x2:cu(r,"x2")||"100%",y2:cu(r,"y2")||0}:function(e){return{x1:cu(e,"fx")||cu(e,"cx")||"50%",y1:cu(e,"fy")||cu(e,"cy")||"50%",r1:0,x2:cu(e,"cx")||"50%",y2:cu(e,"cy")||"50%",r2:cu(e,"r")||"50%"}}(e),{...t,gradientUnits:lu(e)});var r}class hu{constructor(e){const{type:t="linear",gradientUnits:r="pixels",coords:n={},colorStops:s=[],offsetX:i=0,offsetY:o=0,gradientTransform:a,id:l}=e||{};Object.assign(this,{type:t,gradientUnits:r,coords:{..."radial"===t?Zc:Qc,...n},colorStops:s,offsetX:i,offsetY:o,gradientTransform:a,id:l?`${l}_${Ai()}`:Ai()})}addColorStop(e){for(const t in e)this.colorStops.push({offset:parseFloat(t),color:e[t]});return this}toObject(e){return{...to(this,e),type:this.type,coords:{...this.coords},colorStops:this.colorStops.map(e=>({...e})),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0}}toSVG(e){let{additionalTransform:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[],n=this.gradientTransform?this.gradientTransform.concat():zs.concat(),s="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox",i=this.colorStops.map(e=>({...e})).sort((e,t)=>e.offset-t.offset);let o=-this.offsetX,a=-this.offsetY;var l;"objectBoundingBox"===s?(o/=e.width,a/=e.height):(o+=e.width/2,a+=e.height/2),(l=e)&&"function"==typeof l._renderPathCommands&&"percentage"!==this.gradientUnits&&(o-=e.pathOffset.x,a-=e.pathOffset.y),n[4]-=o,n[5]-=a;const c=[`id="SVGID_${this.id}"`,`gradientUnits="${s}"`,`gradientTransform="${t?t+" ":""}${so(n)}"`,""].join(" ");if("linear"===this.type){const{x1:e,y1:t,x2:n,y2:s}=this.coords;r.push("<linearGradient ",c,' x1="',e,'" y1="',t,'" x2="',n,'" y2="',s,'">\n')}else if("radial"===this.type){const{x1:e,y1:t,x2:n,y2:s,r1:o,r2:a}=this.coords,l=o>a;r.push("<radialGradient ",c,' cx="',l?e:n,'" cy="',l?t:s,'" r="',l?o:a,'" fx="',l?n:e,'" fy="',l?s:t,'">\n'),l&&(i.reverse(),i.forEach(e=>{e.offset=1-e.offset}));const u=Math.min(o,a);if(u>0){const e=u/Math.max(o,a);i.forEach(t=>{t.offset+=e*(1-t.offset)})}}return i.forEach(e=>{let{color:t,offset:n}=e;r.push(`<stop offset="${100*n}%" style="stop-color:${t};"/>\n`)}),r.push("linear"===this.type?"</linearGradient>":"</radialGradient>","\n"),r.join("")}toLive(e){const{x1:t,y1:r,x2:n,y2:s,r1:i,r2:o}=this.coords,a="linear"===this.type?e.createLinearGradient(t,r,n,s):e.createRadialGradient(t,r,i,n,s,o);return this.colorStops.forEach(e=>{let{color:t,offset:r}=e;a.addColorStop(r,t)}),a}static async fromObject(e){const{colorStops:t,gradientTransform:r}=e;return new this({...e,colorStops:t?t.map(e=>({...e})):void 0,gradientTransform:r?[...r]:void 0})}static fromElement(e,t,r){const n=lu(e),s=t._findCenterFromElement();return new this({id:e.getAttribute("id")||void 0,type:au(e),coords:uu(e,{width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height}),colorStops:ou(e,r.opacity),gradientUnits:n,gradientTransform:Zl(e.getAttribute("gradientTransform")||""),..."pixels"===n?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}})}}bs(hu,"type","Gradient"),vi.setClass(hu,"gradient"),vi.setClass(hu,"linear"),vi.setClass(hu,"radial");class du{get type(){return"pattern"}set type(e){_s("warn","Setting type has no effect",e)}constructor(e){bs(this,"repeat","repeat"),bs(this,"offsetX",0),bs(this,"offsetY",0),bs(this,"crossOrigin",""),this.id=Ai(),Object.assign(this,e)}isImageSource(){return!!this.source&&"string"==typeof this.source.src}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&0!==this.source.naturalWidth&&0!==this.source.naturalHeight)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const{repeat:t,crossOrigin:r}=this;return{...to(this,e),type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:r,offsetX:no(this.offsetX,xs.NUM_FRACTION_DIGITS),offsetY:no(this.offsetY,xs.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null}}toSVG(e){let{width:t,height:r}=e;const{source:n,repeat:s,id:i}=this,o=eu(this.offsetX/t,0),a=eu(this.offsetY/r,0);return[`<pattern id="SVGID_${i}" x="${o}" y="${a}" width="${"repeat-y"===s||"no-repeat"===s?1+Math.abs(o||0):eu(n.width/t,0)}" height="${"repeat-x"===s||"no-repeat"===s?1+Math.abs(a||0):eu(n.height/r,0)}">`,`<image x="0" y="0" width="${n.width}" height="${n.height}" xlink:href="${this.sourceToString()}"></image>`,"</pattern>",""].join("\n")}static async fromObject(e,t){let{type:r,source:n,patternTransform:s,...i}=e;const o=await Qi(n,{...t,crossOrigin:i.crossOrigin});return new this({...i,patternTransform:s&&s.slice(0),source:o})}}bs(du,"type","Pattern"),vi.setClass(du),vi.setClass(du,"pattern");class fu extends _l{constructor(e){let{path:t,left:r,top:n,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),Object.assign(this,fu.ownDefaults),this.setOptions(s),this._setPath(e||[],!0),"number"==typeof r&&this.set(Vs,r),"number"==typeof n&&this.set(Hs,n)}_setPath(e,t){this.path=(e=>{let t=0,r=0,n=0,s=0;const i=[];let o,a=0,l=0;for(const c of e){const e=[...c];let u;switch(e[0]){case"l":e[1]+=t,e[2]+=r;case"L":t=e[1],r=e[2],u=["L",t,r];break;case"h":e[1]+=t;case"H":t=e[1],u=["L",t,r];break;case"v":e[1]+=r;case"V":r=e[1],u=["L",t,r];break;case"m":e[1]+=t,e[2]+=r;case"M":t=e[1],r=e[2],n=e[1],s=e[2],u=["M",t,r];break;case"c":e[1]+=t,e[2]+=r,e[3]+=t,e[4]+=r,e[5]+=t,e[6]+=r;case"C":a=e[3],l=e[4],t=e[5],r=e[6],u=["C",e[1],e[2],a,l,t,r];break;case"s":e[1]+=t,e[2]+=r,e[3]+=t,e[4]+=r;case"S":"C"===o?(a=2*t-a,l=2*r-l):(a=t,l=r),t=e[3],r=e[4],u=["C",a,l,e[1],e[2],t,r],a=u[3],l=u[4];break;case"q":e[1]+=t,e[2]+=r,e[3]+=t,e[4]+=r;case"Q":a=e[1],l=e[2],t=e[3],r=e[4],u=["Q",a,l,t,r];break;case"t":e[1]+=t,e[2]+=r;case"T":"Q"===o?(a=2*t-a,l=2*r-l):(a=t,l=r),t=e[1],r=e[2],u=["Q",a,l,t,r];break;case"a":e[6]+=t,e[7]+=r;case"A":kc(t,r,e).forEach(e=>i.push(e)),t=e[6],r=e[7];break;case"z":case"Z":t=n,r=s,u=["Z"]}u?(i.push(u),o=u[0]):o=""}return i})(Array.isArray(e)?e:(e=>{var t;const r=[],n=null!==(t=e.match(Lc))&&void 0!==t?t:[];for(const s of n){const e=s[0];if("z"===e||"Z"===e){r.push([e]);continue}const t=Fc[e.toLowerCase()];let n=[];if("a"===e||"A"===e){Ic.lastIndex=0;for(let e=null;e=Ic.exec(s);)n.push(...e.slice(1))}else n=s.match($c)||[];for(let s=0;s<n.length;s+=t){const i=new Array(t),o=wc[e];i[0]=s>0&&o?o:e;for(let e=0;e<t;e++)i[e+1]=parseFloat(n[s+e]);r.push(i)}}return r})(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new ki(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,r=-this.pathOffset.y;e.beginPath();for(const n of this.path)switch(n[0]){case"L":e.lineTo(n[1]+t,n[2]+r);break;case"M":e.moveTo(n[1]+t,n[2]+r);break;case"C":e.bezierCurveTo(n[1]+t,n[2]+r,n[3]+t,n[4]+r,n[5]+t,n[6]+r);break;case"Q":e.quadraticCurveTo(n[1]+t,n[2]+r,n[3]+t,n[4]+r);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return`#<Path (${this.complexity()}): { "top": ${this.top}, "left": ${this.left} }>`}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{...super.toObject(e),path:this.path.map(e=>e.slice())}}toDatalessObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){return["<path ","COMMON_PARTS",`d="${zc(this.path,xs.NUM_FRACTION_DIGITS)}" stroke-linecap="round" />\n`]}_getOffsetTransform(){const e=xs.NUM_FRACTION_DIGITS;return` translate(${no(-this.pathOffset.x,e)}, ${no(-this.pathOffset.y,e)})`}toClipPathSVG(e){const t=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:r,pathOffset:n}=this._calcDimensions();this.set({width:t,height:r,pathOffset:n}),e&&this.setPositionByOrigin(n,Ws,Ws)}_calcBoundsFromPath(){const e=[];let t=0,r=0,n=0,s=0;for(const i of this.path)switch(i[0]){case"L":n=i[1],s=i[2],e.push({x:t,y:r},{x:n,y:s});break;case"M":n=i[1],s=i[2],t=n,r=s;break;case"C":e.push(...Sc(n,s,i[1],i[2],i[3],i[4],i[5],i[6])),n=i[5],s=i[6];break;case"Q":e.push(...Sc(n,s,i[1],i[2],i[1],i[2],i[3],i[4])),n=i[3],s=i[4];break;case"Z":n=t,s=r}return _o(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return{...e,pathOffset:new ki(e.left+e.width/2,e.top+e.height/2)}}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,r){const{d:n,...s}=nc(e,this.ATTRIBUTE_NAMES,r);return new this(n,{...s,...t,left:void 0,top:void 0})}}bs(fu,"type","Path"),bs(fu,"cacheProperties",[...ja,"path","fillRule"]),bs(fu,"ATTRIBUTE_NAMES",[...Rl,"d"]),vi.setClass(fu),vi.setSVGClass(fu);const pu=["radius","startAngle","endAngle","counterClockwise"];class gu extends _l{static getDefaults(){return{...super.getDefaults(),...gu.ownDefaults}}constructor(e){super(),Object.assign(this,gu.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),"radius"===e&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,Li(this.startAngle),Li(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(oi)}getRadiusY(){return this.get("radius")*this.get(ai)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return super.toObject([...pu,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(0===e)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',`${this.radius}`,'" />\n'];{const{radius:t}=this,r=Li(this.startAngle),n=Li(this.endAngle),s=_i(r)*t,i=Si(r)*t,o=_i(n)*t,a=Si(n)*t;return[`<path d="M ${s} ${i} A ${t} ${t} 0 ${e>180?1:0} ${this.counterClockwise?0:1} ${o} ${a}" `,"COMMON_PARTS"," />\n"]}}static async fromElement(e,t,r){const{left:n=0,top:s=0,radius:i=0,...o}=nc(e,this.ATTRIBUTE_NAMES,r);return new this({...o,radius:i,left:n-i,top:s-i})}static fromObject(e){return super._fromObject(e)}}bs(gu,"type","Circle"),bs(gu,"cacheProperties",[...ja,...pu]),bs(gu,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),bs(gu,"ATTRIBUTE_NAMES",["cx","cy","r",...Rl]),vi.setClass(gu),vi.setSVGClass(gu);const mu=["x1","x2","y1","y2"];class yu extends _l{constructor(){let[e,t,r,n]=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),Object.assign(this,yu.ownDefaults),this.setOptions(s),this.x1=e,this.x2=r,this.y1=t,this.y2=n,this._setWidthHeight();const{left:i,top:o}=s;"number"==typeof i&&this.set(Vs,i),"number"==typeof o&&this.set(Hs,o)}_setWidthHeight(){const{x1:e,y1:t,x2:r,y2:n}=this;this.width=Math.abs(r-e),this.height=Math.abs(n-t);const{left:s,top:i,width:o,height:a}=_o([{x:e,y:t},{x:r,y:n}]),l=new ki(s+o/2,i+a/2);this.setPositionByOrigin(l,Ws,Ws)}_set(e,t){return super._set(e,t),mu.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const r=e.strokeStyle;var n;io(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=null!==(n=this.stroke)&&void 0!==n?n:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=r}_findCenterFromElement(){return new ki((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{...super.toObject(e),...this.calcLinePoints()}}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return"butt"===this.strokeLineCap&&(0===this.width&&(e.y-=this.strokeWidth),0===this.height&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:r,y2:n,width:s,height:i}=this,o=e<=t?-1:1,a=r<=n?-1:1;return{x1:o*s/2,x2:o*-s/2,y1:a*i/2,y2:a*-i/2}}_toSVG(){const{x1:e,x2:t,y1:r,y2:n}=this.calcLinePoints();return["<line ","COMMON_PARTS",`x1="${e}" y1="${r}" x2="${t}" y2="${n}" />\n`]}static async fromElement(e,t,r){const{x1:n=0,y1:s=0,x2:i=0,y2:o=0,...a}=nc(e,this.ATTRIBUTE_NAMES,r);return new this([n,s,i,o],a)}static fromObject(e){let{x1:t,y1:r,x2:n,y2:s,...i}=e;return this._fromObject({...i,points:[t,r,n,s]},{extraParam:"points"})}}bs(yu,"type","Line"),bs(yu,"cacheProperties",[...ja,...mu]),bs(yu,"ATTRIBUTE_NAMES",Rl.concat(mu)),vi.setClass(yu),vi.setSVGClass(yu);class vu extends _l{static getDefaults(){return{...super.getDefaults(),...vu.ownDefaults}}constructor(e){super(),Object.assign(this,vu.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,r),e.lineTo(0,-r),e.lineTo(t,r),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',`${-e} ${t},0 ${-t},${e} ${t}`,'" />']}}bs(vu,"type","Triangle"),bs(vu,"ownDefaults",{width:100,height:100}),vi.setClass(vu),vi.setSVGClass(vu);const bu=["rx","ry"];class wu extends _l{static getDefaults(){return{...super.getDefaults(),...wu.ownDefaults}}constructor(e){super(),Object.assign(this,wu.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(oi)}getRy(){return this.get("ry")*this.get(ai)}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return super.toObject([...bu,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",`cx="0" cy="0" rx="${this.rx}" ry="${this.ry}" />\n`]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,$s,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,r){const n=nc(e,this.ATTRIBUTE_NAMES,r);return n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,new this(n)}}bs(wu,"type","Ellipse"),bs(wu,"cacheProperties",[...ja,...bu]),bs(wu,"ownDefaults",{rx:0,ry:0}),bs(wu,"ATTRIBUTE_NAMES",[...Rl,"cx","cy","rx","ry"]),vi.setClass(wu),vi.setSVGClass(wu);const xu={exactBoundingBox:!1};class _u extends _l{static getDefaults(){return{...super.getDefaults(),..._u.ownDefaults}}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),bs(this,"strokeDiff",void 0),Object.assign(this,_u.ownDefaults),this.setOptions(t),this.points=e;const{left:r,top:n}=t;this.initialized=!0,this.setBoundingBox(!0),"number"==typeof r&&this.set(Vs,r),"number"==typeof n&&this.set(Hs,n)}isOpen(){return!0}_projectStrokeOnPoints(e){return function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];if(0===e.length)return n;const s=e.reduce((e,t)=>(e[e.length-1].eq(t)||e.push(new ki(t)),e),[new ki(e[0])]);if(1===s.length)r=!0;else if(!r){const e=s[0],t=((e,t)=>{for(let r=e.length-1;r>=0;r--)if(t(e[r]))return r;return-1})(s,t=>!t.eq(e));s.splice(t+1)}return s.forEach((e,s,i)=>{let o,a;0===s?(a=i[1],o=r?e:i[i.length-1]):s===i.length-1?(o=i[s-1],a=r?e:i[0]):(o=i[s-1],a=i[s+1]),r&&1===i.length?n.push(...new Tl(e,e,t).project()):!r||0!==s&&s!==i.length-1?n.push(...new Cl(e,o,a,t).project()):n.push(...new Tl(e,0===s?a:o,t).project())}),n}(this.points,e,this.isOpen())}_calcDimensions(e){e={scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth,...e||{}};const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(e=>e.projectedPoint):this.points;if(0===t.length)return{left:0,top:0,width:0,height:0,pathOffset:new ki,strokeOffset:new ki,strokeDiff:new ki};const r=_o(t),n=Ki({...e,scaleX:1,scaleY:1}),s=_o(this.points.map(e=>$i(e,n,!0))),i=new ki(this.scaleX,this.scaleY);let o=r.left+r.width/2,a=r.top+r.height/2;return this.exactBoundingBox&&(o-=a*Math.tan(Li(this.skewX)),a-=o*Math.tan(Li(this.skewY))),{...r,pathOffset:new ki(o,a),strokeOffset:new ki(s.left,s.top).subtract(new ki(r.left,r.top)).multiply(i),strokeDiff:new ki(r.width,r.height).subtract(new ki(s.width,s.height)).multiply(i)}}_findCenterFromElement(){const e=_o(this.points);return new ki(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:r,width:n,height:s,pathOffset:i,strokeOffset:o,strokeDiff:a}=this._calcDimensions();this.set({width:n,height:s,pathOffset:i,strokeOffset:o,strokeDiff:a}),e&&this.setPositionByOrigin(new ki(t+n/2,r+s/2),Ws,Ws)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new ki(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.exactBoundingBox){let i;if(Object.keys(e).some(e=>this.strokeUniform||this.constructor.layoutProperties.includes(e))){var t,r;const{width:n,height:s}=this._calcDimensions(e);i=new ki(null!==(t=e.width)&&void 0!==t?t:n,null!==(r=e.height)&&void 0!==r?r:s)}else{var n,s;i=new ki(null!==(n=e.width)&&void 0!==n?n:this.width,null!==(s=e.height)&&void 0!==s?s:this.height)}return i.multiply(new ki(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const r=this.initialized&&this[e]!==t,n=super._set(e,t);return this.exactBoundingBox&&r&&((e===oi||e===ai)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),n}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{...super.toObject(e),points:this.points.map(e=>{let{x:t,y:r}=e;return{x:t,y:r}})}}_toSVG(){const e=[],t=this.pathOffset.x,r=this.pathOffset.y,n=xs.NUM_FRACTION_DIGITS;for(let s=0,i=this.points.length;s<i;s++)e.push(no(this.points[s].x-t,n),",",no(this.points[s].y-r,n)," ");return[`<${this.constructor.type.toLowerCase()} `,"COMMON_PARTS",`points="${e.join("")}" />\n`]}_render(e){const t=this.points.length,r=this.pathOffset.x,n=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-r,this.points[0].y-n);for(let s=0;s<t;s++){const t=this.points[s];e.lineTo(t.x-r,t.y-n)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,r){const n=function(e){if(!e)return[];const t=e.replace(/,/g," ").trim().split(/\s+/),r=[];for(let n=0;n<t.length;n+=2)r.push({x:parseFloat(t[n]),y:parseFloat(t[n+1])});return r}(e.getAttribute("points")),{left:s,top:i,...o}=nc(e,this.ATTRIBUTE_NAMES,r);return new this(n,{...o,...t})}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}bs(_u,"ownDefaults",xu),bs(_u,"type","Polyline"),bs(_u,"layoutProperties",[li,ci,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),bs(_u,"cacheProperties",[...ja,"points"]),bs(_u,"ATTRIBUTE_NAMES",[...Rl]),vi.setClass(_u),vi.setSVGClass(_u);class Su extends _u{isOpen(){return!1}}bs(Su,"ownDefaults",xu),bs(Su,"type","Polygon"),vi.setClass(Su),vi.setSVGClass(Su);class ku extends _l{isEmptyStyles(e){if(!this.styles)return!0;if(void 0!==e&&!this.styles[e])return!0;const t=void 0===e?this.styles:{line:this.styles[e]};for(const r in t)for(const e in t[r])for(const n in t[r][e])return!1;return!0}styleHas(e,t){if(!this.styles)return!1;if(void 0!==t&&!this.styles[t])return!1;const r=void 0===t?this.styles:{0:this.styles[t]};for(const n in r)for(const t in r[n])if(void 0!==r[n][t][e])return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let r,n,s=0,i=!0,o=0;for(const a in t){r=0;for(const o in t[a]){const l=t[a][o]||{};s++,void 0!==l[e]?(n?l[e]!==n&&(i=!1):n=l[e],l[e]===this[e]&&delete l[e]):i=!1,0!==Object.keys(l).length?r++:delete t[a][o]}0===r&&delete t[a]}for(let a=0;a<this._textLines.length;a++)o+=this._textLines[a].length;i&&s===o&&(this[e]=n,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let r,n,s;for(n in t){for(s in r=t[n],r)delete r[s][e],0===Object.keys(r[s]).length&&delete r[s];0===Object.keys(r).length&&delete t[n]}}_extendStyles(e,t){const{lineIndex:r,charIndex:n}=this.get2DCursorLocation(e);this._getLineStyle(r)||this._setLineStyle(r);const s=ro({...this._getStyleDeclaration(r,n),...t},e=>void 0!==e);this._setStyleDeclaration(r,n,s)}getSelectionStyles(e,t,r){const n=[];for(let s=e;s<(t||e);s++)n.push(this.getStyleAtPosition(s,r));return n}getStyleAtPosition(e,t){const{lineIndex:r,charIndex:n}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(r,n):this._getStyleDeclaration(r,n)}setSelectionStyles(e,t,r){for(let n=t;n<(r||t);n++)this._extendStyles(n,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var r;const n=this.styles&&this.styles[e];return n&&null!==(r=n[t])&&void 0!==r?r:{}}getCompleteStyleDeclaration(e,t){return{...to(this,this.constructor._styleProperties),...this._getStyleDeclaration(e,t)}}_setStyleDeclaration(e,t,r){this.styles[e][t]=r}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}bs(ku,"_styleProperties",da);const Cu=/  +/g,Tu=/"/g;function Eu(e,t,r,n,s){return`\t\t${function(e,t){let{left:r,top:n,width:s,height:i}=t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xs.NUM_FRACTION_DIGITS;const a=sa(ui,e,!1),[l,c,u,h]=[r,n,s,i].map(e=>no(e,o));return`<rect ${a} x="${l}" y="${c}" width="${u}" height="${h}"></rect>`}(e,{left:t,top:r,width:n,height:s})}\n`}let Ou;class ju extends ku{static getDefaults(){return{...super.getDefaults(),...ju.ownDefaults}}constructor(e,t){super(),bs(this,"__charBounds",[]),Object.assign(this,ju.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=Mc(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(pa)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,r,n,s,i,o;for(let a=0,l=this._textLines.length;a<l;a++)if((this.textAlign===pa||a!==l-1&&!this.isEndOfWrapping(a))&&(n=0,s=this._textLines[a],t=this.getLineWidth(a),t<this.width&&(o=this.textLines[a].match(this._reSpacesAndTabs)))){r=o.length,e=(this.width-t)/r;for(let t=0;t<=s.length;t++)i=this.__charBounds[a][t],this._reSpaceAndTab.test(s[t])?(i.width+=e,i.kernedWidth+=e,i.left+=n,n+=e):i.left+=n}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const r=t?this._unwrappedTextLines:this._textLines;let n;for(n=0;n<r.length;n++){if(e<=r[n].length)return{lineIndex:n,charIndex:e};e-=r[n].length+this.missingNewlineOffset(n,t)}return{lineIndex:n-1,charIndex:r[n-1].length<e?r[n-1].length:e}}toString(){return`#<Text (${this.complexity()}): { "text": "${this.text}", "fontFamily": "${this.fontFamily}" }>`}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===hi?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,r){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Ws:e.textBaseline="middle";break;case"ascender":e.textBaseline=Hs;break;case"descender":e.textBaseline=Gs}e.font=this._getFontDeclaration(t,r)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,r=this._textLines.length;t<r;t++){const r=this.getLineWidth(t);r>e&&(e=r)}return e}_renderTextLine(e,t,r,n,s,i){this._renderChars(e,t,r,n,s,i)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,r=this._getLeftOffset();let n=this._getTopOffset();for(let s=0,i=this._textLines.length;s<i;s++){const t=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){n+=t;continue}const i=this._textLines[s].length,o=this._getLineLeftOffset(s);let a,l,c=0,u=0,h=this.getValueOfPropertyAt(s,0,"textBackgroundColor");const d=this.getHeightOfLineImpl(s);for(let f=0;f<i;f++){const t=this.__charBounds[s][f];l=this.getValueOfPropertyAt(s,f,"textBackgroundColor"),this.path?(e.save(),e.translate(t.renderLeft,t.renderTop),e.rotate(t.angle),e.fillStyle=l,l&&e.fillRect(-t.width/2,-d*(1-this._fontSizeFraction),t.width,d),e.restore()):l!==h?(a=r+o+u,this.direction===pi&&(a=this.width-a-c),e.fillStyle=h,h&&e.fillRect(a,n,c,d),u=t.left,c=t.width,h=l):c+=t.kernedWidth}l&&!this.path&&(a=r+o+u,this.direction===pi&&(a=this.width-a-c),e.fillStyle=l,e.fillRect(a,n,c,d)),n+=t}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,r,n){const s=Ns.getFontCache(t),i=this._getFontDeclaration(t),o=r?r+e:e,a=r&&i===this._getFontDeclaration(n),l=t.fontSize/this.CACHE_FONT_SIZE;let c,u,h,d;if(r&&s.has(r)&&(h=s.get(r)),s.has(e)&&(d=c=s.get(e)),a&&s.has(o)&&(u=s.get(o),d=u-h),void 0===c||void 0===h||void 0===u){const n=function(){if(!Ou){const e=Ni({width:0,height:0});Ou=e.getContext("2d")}return Ou}();this._setTextStyles(n,t,!0),void 0===c&&(d=c=n.measureText(e).width,s.set(e,c)),void 0===h&&a&&r&&(h=n.measureText(r).width,s.set(r,h)),a&&void 0===u&&(u=n.measureText(o).width,s.set(o,u),d=u-h)}return{width:c*l,kernedWidth:d*l}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return 0!==this.charSpacing&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,r,n=0;const s=this.pathSide===Ys,i=this.path,o=this._textLines[e],a=o.length,l=new Array(a);this.__charBounds[e]=l;for(let c=0;c<a;c++){const s=o[c];r=this._getGraphemeBox(s,e,c,t),l[c]=r,n+=r.kernedWidth,t=s}if(l[a]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},i&&i.segmentsInfo){let e=0;const t=i.segmentsInfo[i.segmentsInfo.length-1].length;switch(this.textAlign){case Vs:e=s?t-n:0;break;case Ws:e=(t-n)/2;break;case Ys:e=s?0:t-n}e+=this.pathStartOffset*(s?-1:1);for(let n=s?a-1:0;s?n>=0:n<a;s?n--:n++)r=l[n],e>t?e%=t:e<0&&(e+=t),this._setGraphemeOnPath(e,r),e+=r.kernedWidth}return{width:n,numOfSpaces:0}}_setGraphemeOnPath(e,t){const r=e+t.kernedWidth/2,n=this.path,s=Rc(n.path,r,n.segmentsInfo);t.renderLeft=s.x-n.pathOffset.x,t.renderTop=s.y-n.pathOffset.y,t.angle=s.angle+(this.pathSide===Ys?Math.PI:0)}_getGraphemeBox(e,t,r,n,s){const i=this.getCompleteStyleDeclaration(t,r),o=n?this.getCompleteStyleDeclaration(t,r-1):{},a=this._measureChar(e,i,n,o);let l,c=a.kernedWidth,u=a.width;0!==this.charSpacing&&(l=this._getWidthOfCharSpacing(),u+=l,c+=l);const h={width:u,left:0,height:i.fontSize,kernedWidth:c,deltaY:i.deltaY};if(r>0&&!s){const e=this.__charBounds[t][r-1];h.left=e.left+e.width+a.kernedWidth-a.width}return h}getHeightOfLineImpl(e){const t=this.__lineHeights;if(t[e])return t[e];let r=this.getHeightOfChar(e,0);for(let n=1,s=this._textLines[e].length;n<s;n++)r=Math.max(this.getHeightOfChar(e,n),r);return t[e]=r*this._fontSizeMult}getHeightOfLine(e){return this.getHeightOfLineImpl(e)*this.lineHeight}calcTextHeight(){let e=0;for(let t=0,r=this._textLines.length;t<r;t++)e+=t===r-1?this.getHeightOfLineImpl(t):this.getHeightOfLine(t);return e}_getLeftOffset(){return this.direction===fi?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let r=0;const n=this._getLeftOffset(),s=this._getTopOffset();for(let i=0,o=this._textLines.length;i<o;i++)this._renderTextLine(t,e,this._textLines[i],n+this._getLineLeftOffset(i),s+r+this.getHeightOfLineImpl(i),i),r+=this.getHeightOfLine(i);e.restore()}_renderTextFill(e){(this.fill||this.styleHas(ui))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,r,n,s,i){const o=this.textAlign.includes(pa),a=this.path,l=!o&&0===this.charSpacing&&this.isEmptyStyles(i)&&!a,c=this.direction===fi,u=this.direction===fi?1:-1,h=t.direction;let d,f,p,g,m,y="",v=0;if(t.save(),h!==this.direction&&(t.canvas.setAttribute("dir",c?fi:pi),t.direction=c?fi:pi,t.textAlign=c?Vs:Ys),s-=this.getHeightOfLineImpl(i)*this._fontSizeFraction,l)return this._renderChar(e,t,i,0,r.join(""),n,s),void t.restore();for(let b=0,w=r.length-1;b<=w;b++)g=b===w||this.charSpacing||a,y+=r[b],p=this.__charBounds[i][b],0===v?(n+=u*(p.kernedWidth-p.width),v+=p.width):v+=p.kernedWidth,o&&!g&&this._reSpaceAndTab.test(r[b])&&(g=!0),g||(d=d||this.getCompleteStyleDeclaration(i,b),f=this.getCompleteStyleDeclaration(i,b+1),g=Dl(d,f,!1)),g&&(a?(t.save(),t.translate(p.renderLeft,p.renderTop),t.rotate(p.angle),this._renderChar(e,t,i,b,y,-v/2,0),t.restore()):(m=n,this._renderChar(e,t,i,b,y,m,s)),y="",d=f,n+=u*v,v=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,r=this.height+this.strokeWidth,n=Ni({width:t,height:r}),s=n.getContext("2d");return n.width=t,n.height=r,s.beginPath(),s.moveTo(0,0),s.lineTo(t,0),s.lineTo(t,r),s.lineTo(0,r),s.closePath(),s.translate(t/2,r/2),s.fillStyle=e.toLive(s),this._applyPatternGradientTransform(s,e),s.fill(),s.createPattern(n,"no-repeat")}handleFiller(e,t,r){let n,s;return io(r)?"percentage"===r.gradientUnits||r.gradientTransform||r.patternTransform?(n=-this.width/2,s=-this.height/2,e.translate(n,s),e[t]=this._applyPatternGradientTransformText(r),{offsetX:n,offsetY:s}):(e[t]=r.toLive(e),this._applyPatternGradientTransform(e,r)):(e[t]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:r,strokeWidth:n}=t;return e.lineWidth=n,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",r)}_setFillStyles(e,t){let{fill:r}=t;return this.handleFiller(e,"fillStyle",r)}_renderChar(e,t,r,n,s,i,o){const a=this._getStyleDeclaration(r,n),l=this.getCompleteStyleDeclaration(r,n),c="fillText"===e&&l.fill,u="strokeText"===e&&l.stroke&&l.strokeWidth;if(u||c){if(t.save(),t.font=this._getFontDeclaration(l),a.textBackgroundColor&&this._removeShadow(t),a.deltaY&&(o+=a.deltaY),c){const e=this._setFillStyles(t,l);t.fillText(s,i-e.offsetX,o-e.offsetY)}if(u){const e=this._setStrokeStyles(t,l);t.strokeText(s,i-e.offsetX,o-e.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,r){const n=this.get2DCursorLocation(e,!0),s=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"fontSize"),i=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"deltaY"),o={fontSize:s*r.size,deltaY:i+s*r.baseline};this.setSelectionStyles(o,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),r=this.width-t,n=this.textAlign,s=this.direction,i=this.isEndOfWrapping(e);let o=0;return n===pa||n===ya&&!i||n===ma&&!i||n===ga&&!i?0:(n===Ws&&(o=r/2),n===Ys&&(o=r),n===ya&&(o=r/2),n===ma&&(o=r),s===pi&&(n===Ys||n===ma?o=0:n===Vs||n===ga?o=-r:n!==Ws&&n!==ya||(o=-r/2)),o)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(void 0!==this.__lineWidths[e])return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,r){var n;return null!==(n=this._getStyleDeclaration(e,t)[r])&&void 0!==n?n:this[r]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let r=this._getTopOffset();const n=this._getLeftOffset(),s=this.path,i=this._getWidthOfCharSpacing(),o="linethrough"===t?.5:"overline"===t?1:0,a=this.offsets[t];for(let l=0,c=this._textLines.length;l<c;l++){const c=this.getHeightOfLine(l);if(!this[t]&&!this.styleHas(t,l)){r+=c;continue}const u=this._textLines[l],h=c/this.lineHeight,d=this._getLineLeftOffset(l);let f=0,p=0,g=this.getValueOfPropertyAt(l,0,t),m=this.getValueOfPropertyAt(l,0,ui),y=this.getValueOfPropertyAt(l,0,aa),v=g,b=m,w=y;const x=r+h*(1-this._fontSizeFraction);let _=this.getHeightOfChar(l,0),S=this.getValueOfPropertyAt(l,0,"deltaY");for(let r=0,i=u.length;r<i;r++){const i=this.__charBounds[l][r];v=this.getValueOfPropertyAt(l,r,t),b=this.getValueOfPropertyAt(l,r,ui),w=this.getValueOfPropertyAt(l,r,aa);const c=this.getHeightOfChar(l,r),u=this.getValueOfPropertyAt(l,r,"deltaY");if(s&&v&&b){const t=this.fontSize*w/1e3;e.save(),e.fillStyle=m,e.translate(i.renderLeft,i.renderTop),e.rotate(i.angle),e.fillRect(-i.kernedWidth/2,a*c+u-o*t,i.kernedWidth,t),e.restore()}else if((v!==g||b!==m||c!==_||w!==y||u!==S)&&p>0){const t=this.fontSize*y/1e3;let r=n+d+f;this.direction===pi&&(r=this.width-r-p),g&&m&&y&&(e.fillStyle=m,e.fillRect(r,x+a*_+S-o*t,p,t)),f=i.left,p=i.width,g=v,y=w,m=b,_=c,S=u}else p+=i.kernedWidth}let k=n+d+f;this.direction===pi&&(k=this.width-k-p),e.fillStyle=b;const C=this.fontSize*w/1e3;v&&b&&w&&e.fillRect(k,x+a*_+S-o*C,p-i,C),r+=c}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:n=this.fontSize}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const i=e.includes("'")||e.includes('"')||e.includes(",")||ju.genericFonts.includes(e.toLowerCase())?e:`"${e}"`;return[t,r,`${s?this.CACHE_FONT_SIZE:n}px`,i].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return jl(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),r=new Array(t.length),n=["\n"];let s=[];for(let i=0;i<t.length;i++)r[i]=this.graphemeSplit(t[i]),s=s.concat(r[i],n);return s.pop(),{_unwrappedLines:r,lines:t,graphemeText:s,graphemeLines:r}}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{...super.toObject([...ha,...e]),styles:Nl(this.styles,this.text),...this.path?{path:this.path.toObject()}:{}}}set(e,t){const{textLayoutProperties:r}=this.constructor;super.set(e,t);let n=!1,s=!1;if("object"==typeof e)for(const i in e)"path"===i&&this.setPathInfo(),n=n||r.includes(i),s=s||"path"===i;else n=r.includes(e),s="path"===e;return s&&this.setPathInfo(),n&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,r){const n=nc(e,ju.ATTRIBUTE_NAMES,r),{textAnchor:s=Vs,textDecoration:i="",dx:o=0,dy:a=0,top:l=0,left:c=0,fontSize:u=Bs,strokeWidth:h=1,...d}={...t,...n},f=new this(Xo(e.textContent||"").trim(),{left:c+o,top:l+a,underline:i.includes("underline"),overline:i.includes("overline"),linethrough:i.includes("line-through"),strokeWidth:0,fontSize:u,...d}),p=f.getScaledHeight()/f.height,g=((f.height+f.strokeWidth)*f.lineHeight-f.height)*p,m=f.getScaledHeight()+g;let y=0;return s===Ws&&(y=f.getScaledWidth()/2),s===Ys&&(y=f.getScaledWidth()),f.set({left:f.left-y,top:f.top-(m-f.fontSize*(.07+f._fontSizeFraction))/f.lineHeight,strokeWidth:h}),f}static fromObject(e){return this._fromObject({...e,styles:Ml(e.styles||{},e.text)},{extraParam:"text"})}}bs(ju,"textLayoutProperties",ua),bs(ju,"cacheProperties",[...ja,...ha]),bs(ju,"ownDefaults",fa),bs(ju,"type","Text"),bs(ju,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),bs(ju,"ATTRIBUTE_NAMES",Rl.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),xl(ju,[class extends ia{_toSVG(){const e=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(e.textTop,e.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(e){const t=this._createBaseSVGMarkup(this._toSVG(),{reviver:e,noStyle:!0,withShadow:!0}),r=this.path;return r?t+r._createBaseSVGMarkup(r._toSVG(),{reviver:e,withShadow:!0,additionalTransform:so(this.calcOwnMatrix())}):t}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(e){let{textBgRects:t,textSpans:r}=e;const n=this.getSvgTextDecoration(this);return[t.join(""),'\t\t<text xml:space="preserve" ',`font-family="${this.fontFamily.replace(Tu,"'")}" `,`font-size="${this.fontSize}" `,this.fontStyle?`font-style="${this.fontStyle}" `:"",this.fontWeight?`font-weight="${this.fontWeight}" `:"",n?`text-decoration="${n}" `:"","rtl"===this.direction?`direction="${this.direction}" `:"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",r.join(""),"</text>\n"]}_getSVGTextAndBg(e,t){const r=[],n=[];let s,i=e;this.backgroundColor&&n.push(...Eu(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)s=this._getLineLeftOffset(o),"rtl"===this.direction&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(n,o,t+s,i),this._setSVGTextLineText(r,o,t+s,i),i+=this.getHeightOfLine(o);return{textSpans:r,textBgRects:n}}_createTextCharSpan(e,t,r,n,s){const i=xs.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(t,e!==e.trim()||!!e.match(Cu)),a=o?`style="${o}"`:"",l=t.deltaY,c=l?` dy="${no(l,i)}" `:"",{angle:u,renderLeft:h,renderTop:d,width:f}=s;let p="";if(void 0!==h){const e=f/2;u&&(p=` rotate="${no(Ii(u),i)}"`);const t=Hi({angle:Ii(u)});t[4]=h,t[5]=d;const s=new ki(-e,0).transform(t);r=s.x,n=s.y}return`<tspan x="${no(r,i)}" y="${no(n,i)}" ${c}${p}${a}>${(e=>e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))(e)}</tspan>`}_setSVGTextLineText(e,t,r,n){const s=this.getHeightOfLine(t),i=this.textAlign.includes(pa),o=this._textLines[t];let a,l,c,u,h,d="",f=0;n+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let p=0,g=o.length-1;p<=g;p++)h=p===g||this.charSpacing||this.path,d+=o[p],c=this.__charBounds[t][p],0===f?(r+=c.kernedWidth-c.width,f+=c.width):f+=c.kernedWidth,i&&!h&&this._reSpaceAndTab.test(o[p])&&(h=!0),h||(a=a||this.getCompleteStyleDeclaration(t,p),l=this.getCompleteStyleDeclaration(t,p+1),h=Dl(a,l,!0)),h&&(u=this._getStyleDeclaration(t,p),e.push(this._createTextCharSpan(d,u,r,n,c)),d="",a=l,"rtl"===this.direction?r-=f:r+=f,f=0)}_setSVGTextLineBg(e,t,r,n){const s=this._textLines[t],i=this.getHeightOfLine(t)/this.lineHeight;let o,a=0,l=0,c=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let u=0;u<s.length;u++){const{left:s,width:h,kernedWidth:d}=this.__charBounds[t][u];o=this.getValueOfPropertyAt(t,u,"textBackgroundColor"),o!==c?(c&&e.push(...Eu(c,r+l,n,a,i)),l=s,a=h,c=o):a+=d}o&&e.push(...Eu(c,r+l,n,a,i))}getSvgStyles(e){return`${super.getSvgStyles(e)} text-decoration-thickness: ${no(this.textDecorationThickness*this.getObjectScaling().y/10,xs.NUM_FRACTION_DIGITS)}%; white-space: pre;`}getSvgSpanStyles(e,t){const{fontFamily:r,strokeWidth:n,stroke:s,fill:i,fontSize:o,fontStyle:a,fontWeight:l,textDecorationThickness:c,linethrough:u,overline:h,underline:d}=e,f=this.getSvgTextDecoration({underline:null!=d?d:this.underline,overline:null!=h?h:this.overline,linethrough:null!=u?u:this.linethrough}),p=c||this.textDecorationThickness;return[s?sa(hi,s):"",n?`stroke-width: ${n}; `:"",r?`font-family: ${r.includes("'")||r.includes('"')?r:`'${r}'`}; `:"",o?`font-size: ${o}px; `:"",a?`font-style: ${a}; `:"",l?`font-weight: ${l}; `:"",f?`text-decoration: ${f}; text-decoration-thickness: ${no(p*this.getObjectScaling().y/10,xs.NUM_FRACTION_DIGITS)}%; `:"",i?sa(ui,i):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(e){return["overline","underline","line-through"].filter(t=>e[t.replace("-","")]).join(" ")}}]),vi.setClass(ju),vi.setSVGClass(ju);class Pu{constructor(e){bs(this,"target",void 0),bs(this,"__mouseDownInPlace",!1),bs(this,"__dragStartFired",!1),bs(this,"__isDraggingOver",!1),bs(this,"__dragStartSelection",void 0),bs(this,"__dragImageDisposer",void 0),bs(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(e=>e()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,r=t.getSelectionStartFromPointer(e);return t.isEditing&&r>=t.selectionStart&&r<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var r;let{selectionStart:n,selectionEnd:s}=t;const i=this.target,o=i.canvas,a=new ki(i.flipX?-1:1,i.flipY?-1:1),l=i._getCursorBoundaries(n),c=new ki(l.left+l.leftOffset,l.top+l.topOffset).multiply(a).transform(i.calcTransformMatrix()),u=o.getScenePoint(e).subtract(c),h=i.getCanvasRetinaScaling(),d=i.getBoundingRect(),f=c.subtract(new ki(d.left,d.top)),p=o.viewportTransform,g=f.add(u).transform(p,!0),m=i.backgroundColor,y=El(i.styles);i.backgroundColor="";const v={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};i.setSelectionStyles(v,0,n),i.setSelectionStyles(v,s,i.text.length),i.dirty=!0;const b=i.toCanvasElement({enableRetinaScaling:o.enableRetinaScaling,viewportTransform:!0});i.backgroundColor=m,i.styles=y,i.dirty=!0,Bc(b,{position:"fixed",left:-b.width+"px",border:qs,width:b.width/h+"px",height:b.height/h+"px"}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{b.remove()},uo(e.target||this.target.hiddenTextarea).body.appendChild(b),null===(r=e.dataTransfer)||void 0===r||r.setDragImage(b,g.x,g.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,r=this.isActive();if(r&&e.dataTransfer){const r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},n=t._text.slice(r.selectionStart,r.selectionEnd).join(""),s={text:t.text,value:n,...r};e.dataTransfer.setData("text/plain",n),e.dataTransfer.setData("application/fabric",JSON.stringify({value:n,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,s)}return t.abortCursorAnimation(),r}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),r=this.__dragStartSelection;return t<r.selectionStart||t>r.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const r=this.targetCanDrop(t);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,r=this.targetCanDrop(t);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:r}=e,n=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let s=null===(t=r.dataTransfer)||void 0===t?void 0:t.getData("text/plain");if(s&&!n){const t=this.target,n=t.canvas;let i=t.getSelectionStartFromPointer(r);const{styles:o}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},a=s[Math.max(0,s.length-1)],l=0;if(this.__dragStartSelection){const e=this.__dragStartSelection.selectionStart,r=this.__dragStartSelection.selectionEnd;i>e&&i<=r?i=e:i>r&&(i-=r-e),t.removeChars(e,r),delete this.__dragStartSelection}t._reNewline.test(a)&&(t._reNewline.test(t._text[i])||i===t._text.length)&&(s=s.trimEnd()),e.didDrop=!0,e.dropTarget=t,t.insertChars(s,o,i),n.setActiveObject(t),t.enterEditing(r),t.selectionStart=Math.min(i+l,t._text.length),t.selectionEnd=Math.min(t.selectionStart+s.length,t._text.length),t.hiddenTextarea.value=t.text,t._updateTextarea(),t.hiddenTextarea.focus(),t.fire(si,{index:i+l,action:"drop"}),n.fire("text:changed",{target:t}),n.contextTopDirty=!0,n.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;const e=this.target,n=this.target.canvas,{selectionStart:s,selectionEnd:i}=this.__dragStartSelection,o=(null===(r=t.dataTransfer)||void 0===r?void 0:r.dropEffect)||qs;o===qs?(e.selectionStart=s,e.selectionEnd=i,e._updateTextarea(),e.hiddenTextarea.focus()):(e.clearContextTop(),"move"===o&&(e.removeChars(s,i),e.selectionStart=e.selectionEnd=s,e.hiddenTextarea&&(e.hiddenTextarea.value=e.text),e._updateTextarea(),e.fire(si,{index:s,action:"dragend"}),n.fire("text:changed",{target:e}),n.requestRenderAll()),e.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Au=/[ \n\.,;!\?\-]/;class Du extends ju{constructor(){super(...arguments),bs(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:r,delay:n,onComplete:s}=e;return Fa({startValue:this._currentCursorOpacity,endValue:t,duration:r,delay:n,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:e=>{this._currentCursorOpacity=e,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;null===(e=this._currentTickCompleteState)||void 0===e||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,r=e-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r--;for(;/\S/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findWordBoundaryRight(e){let t=0,r=e;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}findLineBoundaryLeft(e){let t=0,r=e-1;for(;!/\n/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findLineBoundaryRight(e){let t=0,r=e;for(;!/\n/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}searchWordBoundary(e,t){const r=this._text;let n=e>0&&this._reSpace.test(r[e])&&(-1===t||!Xs.test(r[e-1]))?e-1:e,s=r[n];for(;n>0&&n<r.length&&!Au.test(s);)n+=t,s=r[n];return-1===t&&Au.test(s)&&n++,n}selectWord(e){e=null!=e?e:this.selectionStart;const t=this.searchWordBoundary(e,-1),r=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=null!=e?e:this.selectionStart;const t=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e:e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;uo(t).activeElement!==t&&t.focus();const r=this.getSelectionStartFromPointer(e),n=this.selectionStart,s=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&n!==s||n!==r&&s!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===n&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,r){const n=r.slice(0,e),s=this.graphemeSplit(n).length;if(e===t)return{selectionStart:s,selectionEnd:s};const i=r.slice(e,t);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(i).length}}fromGraphemeToStringSelection(e,t,r){const n=r.slice(0,e).join("").length;return e===t?{selectionStart:n,selectionEnd:n}:{selectionStart:n,selectionEnd:n+r.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){const{hiddenTextarea:e,direction:t,textAlign:r,inCompositionMode:n}=this;if(!e)return;const s=r!==pa?r.replace("justify-",""):t===fi?Vs:Ys,i=this.getPositionByOrigin(s,"top");this.cursorOffsetCache={},this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setPositionByOrigin(i,s,"top"),this.setCoords();const o=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=o.selectionEnd,n||(this.selectionStart=o.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),r=this.get2DCursorLocation(e),n=r.lineIndex,s=r.charIndex,i=this.getValueOfPropertyAt(n,s,"fontSize")*this.lineHeight,o=t.leftOffset,a=this.getCanvasRetinaScaling(),l=this.canvas.upperCanvasEl,c=l.width/a,u=l.height/a,h=c-i,d=u-i,f=new ki(t.left+o,t.top+t.topOffset+i).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new ki(l.clientWidth/c,l.clientHeight/u));return f.x<0&&(f.x=0),f.x>h&&(f.x=h),f.y<0&&(f.y=0),f.y>d&&(f.y=d),f.x+=this.canvas._offset.left,f.y+=this.canvas._offset.top,{left:`${f.x}px`,top:`${f.y}px`,fontSize:`${i}px`,charHeight:i}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}exitEditingImpl(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(di),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:r,charIndex:n}=this.get2DCursorLocation(e,!0),{lineIndex:s,charIndex:i}=this.get2DCursorLocation(t,!0);if(r!==s){if(this.styles[r])for(let e=n;e<this._unwrappedTextLines[r].length;e++)delete this.styles[r][e];if(this.styles[s])for(let e=i;e<this._unwrappedTextLines[s].length;e++){const t=this.styles[s][e];t&&(this.styles[r]||(this.styles[r]={}),this.styles[r][n+e-i]=t)}for(let e=r+1;e<=s;e++)delete this.styles[e];this.shiftLineStyles(s,r-s)}else if(this.styles[r]){const e=this.styles[r],t=i-n;for(let r=n;r<i;r++)delete e[r];for(const n in this.styles[r]){const r=parseInt(n,10);r>=i&&(e[r-t]=e[n],delete e[n])}}}shiftLineStyles(e,t){const r=Object.assign({},this.styles);for(const n in this.styles){const s=parseInt(n,10);s>e&&(this.styles[s+t]=r[s],r[s-t]||delete this.styles[s])}}insertNewlineStyleObject(e,t,r,n){const s={},i=this._unwrappedTextLines[e].length,o=i===t;let a=!1;r||(r=1),this.shiftLineStyles(e,r);const l=this.styles[e]?this.styles[e][0===t?t:t-1]:void 0;for(const u in this.styles[e]){const r=parseInt(u,10);r>=t&&(a=!0,s[r-t]=this.styles[e][u],o&&0===t||delete this.styles[e][u])}let c=!1;for(a&&!o&&(this.styles[e+r]=s,c=!0),(c||i>t)&&r--;r>0;)n&&n[r-1]?this.styles[e+r]={0:{...n[r-1]}}:l?this.styles[e+r]={0:{...l}}:delete this.styles[e+r],r--;this._forceClearCache=!0}insertCharStyleObject(e,t,r,n){this.styles||(this.styles={});const s=this.styles[e],i=s?{...s}:{};r||(r=1);for(const a in i){const e=parseInt(a,10);e>=t&&(s[e+r]=i[e],i[e-r]||delete s[e])}if(this._forceClearCache=!0,n){for(;r--;)Object.keys(n[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+r]={...n[r]});return}if(!s)return;const o=s[t?t-1:1];for(;o&&r--;)this.styles[e][t+r]={...o}}insertNewStyleBlock(e,t,r){const n=this.get2DCursorLocation(t,!0),s=[0];let i,o=0;for(let a=0;a<e.length;a++)"\n"===e[a]?(o++,s[o]=0):s[o]++;for(s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],r),r=r&&r.slice(s[0]+1)),o&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],o),i=1;i<o;i++)s[i]>0?this.insertCharStyleObject(n.lineIndex+i,0,s[i],r):r&&this.styles[n.lineIndex+i]&&r[0]&&(this.styles[n.lineIndex+i][0]=r[0]),r=r&&r.slice(s[i]+1);s[i]>0&&this.insertCharStyleObject(n.lineIndex+i,0,s[i],r)}removeChars(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;n>r&&this.removeStyleFromTo(r,n);const s=this.graphemeSplit(e);this.insertNewStyleBlock(s,r,t),this._text=[...this._text.slice(0,r),...s,...this._text.slice(n)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,r){r<=e?(t===e?this._selectionDirection=Vs:this._selectionDirection===Ys&&(this._selectionDirection=Vs,this.selectionEnd=e),this.selectionStart=r):r>e&&r<t?this._selectionDirection===Ys?this.selectionEnd=r:this.selectionStart=r:(t===e?this._selectionDirection=Ys:this._selectionDirection===Vs&&(this._selectionDirection=Ys,this.selectionStart=t),this.selectionEnd=r)}}class Nu extends Du{initHiddenTextarea(){const e=this.canvas&&uo(this.canvas.getElement())||Ps(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map(e=>{let[r,n]=e;return t.setAttribute(r,n)});const{top:r,left:n,fontSize:s}=this._calcTextareaPosition();t.style.cssText=`position: absolute; top: ${r}; left: ${n}; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ${s};`,(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(e=>{let[r,n]=e;return t.addEventListener(r,this[n].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste,{value:r,selectionStart:n,selectionEnd:s}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const i=()=>{this.updateFromTextArea(),this.fire(si),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(""===this.hiddenTextarea.value)return this.styles={},void i();const o=this._splitTextIntoLines(r).graphemeText,a=this._text.length,l=o.length,c=this.selectionStart,u=this.selectionEnd,h=c!==u;let d,f,p,g,m=l-a;const y=this.fromStringToGraphemeSelection(n,s,r),v=c>y.selectionStart;h?(f=this._text.slice(c,u),m+=u-c):l<a&&(f=v?this._text.slice(u+m,u):this._text.slice(c,c-m));const b=o.slice(y.selectionEnd-m,y.selectionEnd);if(f&&f.length&&(b.length&&(d=this.getSelectionStyles(c,c+1,!1),d=b.map(()=>d[0])),h?(p=c,g=u):v?(p=u-f.length,g=u):(p=u,g=u+f.length),this.removeStyleFromTo(p,g)),b.length){const{copyPasteData:e}=js();t&&b.join("")===e.copiedText&&!xs.disableStyleCopyPaste&&(d=e.copiedTextStyle),this.insertNewStyleBlock(b,c,d)}i()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:r,selectionEnd:n}=t;this.compositionStart=r,this.compositionEnd=n,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=js();e.copiedText=this.getSelectedText(),xs.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let r,n=this._getLineLeftOffset(e);return t>0&&(r=this.__charBounds[e][t-1],n+=r.left+r.width),n}getDownCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),n=this.get2DCursorLocation(r),s=n.lineIndex;if(s===this._textLines.length-1||e.metaKey||34===e.keyCode)return this._text.length-r;const i=n.charIndex,o=this._getWidthBeforeCursor(s,i),a=this._getIndexOnLine(s+1,o);return this._textLines[s].slice(i).length+a+1+this.missingNewlineOffset(s)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),n=this.get2DCursorLocation(r),s=n.lineIndex;if(0===s||e.metaKey||33===e.keyCode)return-r;const i=n.charIndex,o=this._getWidthBeforeCursor(s,i),a=this._getIndexOnLine(s-1,o),l=this._textLines[s].slice(0,i),c=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+a-l.length+(1-c)}_getIndexOnLine(e,t){const r=this._textLines[e];let n,s,i=this._getLineLeftOffset(e),o=0;for(let a=0,l=r.length;a<l;a++)if(n=this.__charBounds[e][a].width,i+=n,i>t){s=!0;const e=i-n,r=i,l=Math.abs(e-t);o=Math.abs(r-t)<l?a:a-1;break}return s||(o=r.length-1),o}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const r=this[`get${e}CursorOffset`](t,this._selectionDirection===Ys);if(t.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),0!==r){const e=this.text.length;this.selectionStart=Ea(0,this.selectionStart,e),this.selectionEnd=Ea(0,this.selectionEnd,e),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===Vs?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),0!==e}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),0!==e}moveCursorLeft(e){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",e)}_move(e,t,r){let n;if(e.altKey)n=this[`findWordBoundary${r}`](this[t]);else{if(!e.metaKey&&35!==e.keyCode&&36!==e.keyCode)return this[t]+="Left"===r?-1:1,!0;n=this[`findLineBoundary${r}`](this[t])}return void 0!==n&&this[t]!==n&&(this[t]=n,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Vs,this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===Ys&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection=Vs,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const r=`moveCursor${e}${t.shiftKey?"WithShift":"WithoutShift"}`;this._currentCursorOpacity=1,this[r](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Vs&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Ys,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=Ys,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const Mu=e=>!!e.button;class Ru extends Nu{constructor(){super(...arguments),bs(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new Pu(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:r}=e;this.canvas&&this.editable&&!Mu(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),r&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=r||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:r}=e;const n=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const e=this.canvas._activeObject;if(e&&e!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||Mu(t)||n||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),r=this.selectionStart,n=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(r,n,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Fi(this.calcTransformMatrix())).add(new ki(-this._getLeftOffset(),-this._getTopOffset()));let r=0,n=0,s=0;for(let l=0;l<this._textLines.length&&r<=t.y;l++)r+=this.getHeightOfLine(l),s=l,l>0&&(n+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));let i=Math.abs(this._getLineLeftOffset(s));const o=this._textLines[s].length,a=this.__charBounds[s];for(let l=0;l<o;l++){const e=i+a[l].kernedWidth;if(t.x<=e){Math.abs(t.x-e)<=Math.abs(t.x-i)&&n++;break}i=e,n++}return Math.min(this.flipX?o-n:n,this._text.length)}}const Lu="moveCursorUp",Iu="moveCursorDown",$u="moveCursorLeft",Fu="moveCursorRight",zu="exitEditing",Bu=(e,t)=>{const r=t.getRetinaScaling();e.setTransform(r,0,0,r,0,0);const n=t.viewportTransform;e.transform(n[0],n[1],n[2],n[3],n[4],n[5])},Uu={selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:zu,27:zu,33:Lu,34:Iu,35:Fu,36:$u,37:$u,38:Lu,39:Fu,40:Iu},keysMapRtl:{9:zu,27:zu,33:Lu,34:Iu,35:$u,36:Fu,37:Fu,38:Lu,39:$u,40:Iu},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"},_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1};class Wu extends Ru{static getDefaults(){return{...super.getDefaults(),...Wu.ownDefaults}}get type(){const e=super.type;return"itext"===e?"i-text":e}constructor(e,t){super(e,{...Wu.ownDefaults,...t}),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):("canvas"===e&&(this.canvas instanceof Jc&&this.canvas.textEditingManager.remove(this),t instanceof Jc&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectionStart||0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,r)}setSelectionStyles(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selectionStart||0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,r)}get2DCursorLocation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const r=super.toCanvasElement(e);return this.isEditing=t,r}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries(),r=this.findAncestorsWithClipPath(),n=r.length>0;let s,i=e;if(n){s=Ni(e.canvas),i=s.getContext("2d"),Bu(i,this.canvas);const t=this.calcTransformMatrix();i.transform(t[0],t[1],t[2],t[3],t[4],t[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(i,t):this.renderCursor(i,t),n)for(const o of r){const t=o.clipPath,r=Ni(e.canvas),n=r.getContext("2d");if(Bu(n,this.canvas),!t.absolutePositioned){const e=o.calcTransformMatrix();n.transform(e[0],e[1],e[2],e[3],e[4],e[5])}t.transform(n),t.drawObject(n,!0,{}),this.drawClipPathOnCache(i,t,r)}n&&(e.setTransform(1,0,0,1,0,0),e.drawImage(s,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const r=this._getLeftOffset(),n=this._getTopOffset(),s=this._getCursorBoundariesOffsets(e,t);return{left:r,top:n,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,r=0;const{charIndex:n,lineIndex:s}=this.get2DCursorLocation(e),{textAlign:i,direction:o}=this;for(let u=0;u<s;u++)t+=this.getHeightOfLine(u);const a=this._getLineLeftOffset(s),l=this.__charBounds[s][n];l&&(r=l.left),0!==this.charSpacing&&n===this._textLines[s].length&&(r-=this._getWidthOfCharSpacing());let c=a+(r>0?r:0);return o===pi&&(i===Ys||i===pa||i===ma?c*=-1:i===Vs||i===ga?c=a-(r>0?r:0):i!==Ws&&i!==ya||(c=a-(r>0?r:0))),{top:t,left:c}}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectionStart,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getCursorBoundaries(e);const r=this.get2DCursorLocation(e),n=r.lineIndex,s=r.charIndex>0?r.charIndex-1:0,i=this.getValueOfPropertyAt(n,s,"fontSize"),o=this.getObjectScaling().x*this.canvas.getZoom(),a=this.cursorWidth/o,l=this.getValueOfPropertyAt(n,s,"deltaY"),c=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-i*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-a/2,top:c+t.top+l,width:a,height:i}}_renderCursor(e,t,r){const{color:n,opacity:s,left:i,top:o,width:a,height:l}=this.getCursorRenderingData(r,t);e.fillStyle=n,e.globalAlpha=s,e.fillRect(i,o,a,l)}renderSelection(e,t){const r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,r,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,r){const{textAlign:n,direction:s}=this,i=t.selectionStart,o=t.selectionEnd,a=n.includes(pa),l=this.get2DCursorLocation(i),c=this.get2DCursorLocation(o),u=l.lineIndex,h=c.lineIndex,d=l.charIndex<0?0:l.charIndex,f=c.charIndex<0?0:c.charIndex;for(let p=u;p<=h;p++){const t=this._getLineLeftOffset(p)||0;let i=this.getHeightOfLine(p),o=0,l=0,c=0;if(p===u&&(l=this.__charBounds[u][d].left),p>=u&&p<h)c=a&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===h)if(0===f)c=this.__charBounds[h][f].left;else{const e=this._getWidthOfCharSpacing();c=this.__charBounds[h][f-1].left+this.__charBounds[h][f-1].width-e}o=i,(this.lineHeight<1||p===h&&this.lineHeight>1)&&(i/=this.lineHeight);let g=r.left+t+l,m=i,y=0;const v=c-l;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",m=1,y=i):e.fillStyle=this.selectionColor,s===pi&&(n===Ys||n===pa||n===ma?g=this.width-g-v:n===Vs||n===ga?g=r.left+t-c:n!==Ws&&n!==ya||(g=r.left+t-c)),e.fillRect(g,r.top+r.topOffset+y,v,m),r.topOffset+=o}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,ui)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}bs(Wu,"ownDefaults",Uu),bs(Wu,"type","IText"),vi.setClass(Wu),vi.setClass(Wu,"i-text");class Vu extends Wu{static getDefaults(){return{...super.getDefaults(),...Vu.ownDefaults}}constructor(e,t){super(e,{...Vu.ownDefaults,...t})}static createControls(){return{controls:{...bl(),mr:new el({x:.5,y:0,actionHandler:Ya,cursorStyleHandler:ml,actionName:ti}),ml:new el({x:-.5,y:0,actionHandler:Ya,cursorStyleHandler:ml,actionName:ti})}}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(pa)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,r=0,n=0;const s={};for(let i=0;i<e.graphemeLines.length;i++)"\n"===e.graphemeText[n]&&i>0?(r=0,n++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[n])&&i>0&&(r++,n++),s[i]={line:t,offset:r},n+=e.graphemeLines[i].length,r+=e.graphemeLines[i].length;return s}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const e=this._styleMap[t];e&&(t=e.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,r=0,n=e+1,s=!1;const i=this._styleMap[e],o=this._styleMap[e+1];i&&(e=i.line,r=i.offset),o&&(n=o.line,s=n===e,t=o.offset);const a=void 0===e?this.styles:{line:this.styles[e]};for(const l in a)for(const e in a[l]){const n=parseInt(e,10);if(n>=r&&(!s||n<t))for(const t in a[l][e])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[e];if(!r)return{};e=r.line,t=r.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,r){const n=this._styleMap[e];super._setStyleDeclaration(n.line,n.offset+t,r)}_deleteStyleDeclaration(e,t){const r=this._styleMap[e];super._deleteStyleDeclaration(r.line,r.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const r=this.getGraphemeDataForRender(e),n=[];for(let s=0;s<r.wordsData.length;s++)n.push(...this._wrapLine(s,t,r));return this.isWrapping=!1,n}getGraphemeDataForRender(e){const t=this.splitByGrapheme,r=t?"":" ";let n=0;return{wordsData:e.map((e,s)=>{let i=0;const o=t?this.graphemeSplit(e):this.wordSplit(e);return 0===o.length?[{word:[],width:0}]:o.map(e=>{const o=t?[e]:this.graphemeSplit(e),a=this._measureWord(o,s,i);return n=Math.max(a,n),i+=o.length+r.length,{word:o,width:a}})}),largestWordWidth:n}}_measureWord(e,t){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=0;for(let i=0,o=e.length;i<o;i++)s+=this._getGraphemeBox(e[i],t,i+n,r,!0).kernedWidth,r=e[i];return s}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,r){let{largestWordWidth:n,wordsData:s}=r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=this._getWidthOfCharSpacing(),a=this.splitByGrapheme,l=[],c=a?"":" ";let u=0,h=[],d=0,f=0,p=!0;t-=i;const g=Math.max(t,n,this.dynamicMinWidth),m=s[e];let y;for(d=0,y=0;y<m.length;y++){const{word:t,width:r}=m[y];d+=t.length,u+=f+r-o,u>g&&!p?(l.push(h),h=[],u=r,p=!0):u+=o,p||a||h.push(c),h=h.concat(t),f=a?0:this._measureWord([c],e,d),d++,p=!1}return y&&l.push(h),n+i>this.dynamicMinWidth&&(this.dynamicMinWidth=n-o+i),l}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),r=this._wrapText(t.lines,this.width),n=new Array(r.length);for(let s=0;s<r.length;s++)n[s]=r[s].join("");return t.lines=n,t.graphemeLines=r,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const r=parseInt(t,10);if(this._textLines[r]){const r=this._styleMap[t].line;e.set(`${r}`,!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}bs(Vu,"type","Textbox"),bs(Vu,"textLayoutProperties",[...Wu.textLayoutProperties,"width"]),bs(Vu,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),vi.setClass(Vu);class Hu extends hc{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:r}=e,{clipPath:n,group:s}=r;if(!n||!this.shouldPerformLayout(e))return;const{width:i,height:o}=_o(uc(r,n)),a=new ki(i,o);if(n.absolutePositioned)return{center:Eo(n.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:a};{const s=n.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:r=new ki,correction:n=new ki}=this.calcBoundingBox(t,e)||{};return{center:r.add(s),correction:n.subtract(s),size:a}}return{center:r.getRelativeCenterPoint().add(s),size:a}}}}bs(Hu,"type","clip-path"),vi.setClass(Hu);class Gu extends hc{getInitialSize(e,t){let{target:r}=e,{size:n}=t;return new ki(r.width||n.x,r.height||n.y)}}bs(Gu,"type","fixed"),vi.setClass(Gu);class Yu extends pc{subscribeTargets(e){const t=e.target;e.targets.reduce((e,t)=>(t.parent&&e.add(t.parent),e),new Set).forEach(e=>{e.layoutManager.subscribeTargets({target:e,targets:[t]})})}unsubscribeTargets(e){const t=e.target,r=t.getObjects();e.targets.reduce((e,t)=>(t.parent&&e.add(t.parent),e),new Set).forEach(e=>{!r.some(t=>t.parent===e)&&e.layoutManager.unsubscribeTargets({target:e,targets:[t]})})}}class qu extends mc{static getDefaults(){return{...super.getDefaults(),...qu.ownDefaults}}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),Object.assign(this,qu.ownDefaults),this.setOptions(t);const{left:r,top:n,layoutManager:s}=t;this.groupInit(e,{left:r,top:n,layoutManager:null!=s?s:new Yu})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];"selection-order"===this.multiSelectionStacking?this.add(...t):t.forEach(e=>{const t=this._objects.findIndex(t=>t.isInFrontOf(e)),r=-1===t?this.size():t;this.insertAt(r,e)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(_s("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const r=new Set;t.forEach(e=>{const{parent:t}=e;t&&r.add(t)}),e===lc?r.forEach(e=>{e._onAfterObjectsChange(ac,t)}):r.forEach(e=>{e._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return`#<ActiveSelection: (${this.complexity()})>`}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,r){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const n={hasControls:!1,...r,forActiveSelection:!0};for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(e,n);super._renderControls(e,t),e.restore()}}bs(qu,"type","ActiveSelection"),bs(qu,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),vi.setClass(qu),vi.setClass(qu,"activeSelection");class Xu{constructor(){bs(this,"resources",{})}applyFilters(e,t,r,n,s){const i=s.getContext("2d",{willReadFrequently:!0,desynchronized:!0});if(!i)return;i.drawImage(t,0,0,r,n);const o={sourceWidth:r,sourceHeight:n,imageData:i.getImageData(0,0,r,n),originalEl:t,originalImageData:i.getImageData(0,0,r,n),canvasEl:s,ctx:i,filterBackend:this};e.forEach(e=>{e.applyTo(o)});const{imageData:a}=o;return a.width===r&&a.height===n||(s.width=a.width,s.height=a.height),i.putImageData(a,0,0),o}}class Ku{constructor(){let{tileSize:e=xs.textureSize}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};bs(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),bs(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const r=Ni({width:e,height:t}),n=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});n&&(n.clearColor(0,0,0,0),this.canvas=r,this.gl=n)}applyFilters(e,t,r,n,s,i){const o=this.gl,a=s.getContext("2d");if(!o||!a)return;let l;i&&(l=this.getCachedTexture(i,t));const c={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:r,sourceHeight:n,destinationWidth:r,destinationHeight:n,context:o,sourceTexture:this.createTexture(o,r,n,l?void 0:t),targetTexture:this.createTexture(o,r,n),originalTexture:l||this.createTexture(o,r,n,l?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},u=o.createFramebuffer();return o.bindFramebuffer(o.FRAMEBUFFER,u),e.forEach(e=>{e&&e.applyTo(c)}),function(e){const t=e.targetCanvas,r=t.width,n=t.height,s=e.destinationWidth,i=e.destinationHeight;r===s&&n===i||(t.width=s,t.height=i)}(c),this.copyGLTo2D(o,c),o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(c.sourceTexture),o.deleteTexture(c.targetTexture),o.deleteFramebuffer(u),a.setTransform(1,0,0,1,0,0),c}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,r,n,s){const{NEAREST:i,TEXTURE_2D:o,RGBA:a,UNSIGNED_BYTE:l,CLAMP_TO_EDGE:c,TEXTURE_MAG_FILTER:u,TEXTURE_MIN_FILTER:h,TEXTURE_WRAP_S:d,TEXTURE_WRAP_T:f}=e,p=e.createTexture();return e.bindTexture(o,p),e.texParameteri(o,u,s||i),e.texParameteri(o,h,s||i),e.texParameteri(o,d,c),e.texParameteri(o,f,c),n?e.texImage2D(o,0,a,a,l,n):e.texImage2D(o,0,a,t,r,0,a,l,null),p}getCachedTexture(e,t,r){const{textureCache:n}=this;if(n[e])return n[e];{const s=this.createTexture(this.gl,t.width,t.height,t,r);return s&&(n[e]=s),s}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const r=e.canvas,n=t.targetCanvas,s=n.getContext("2d");if(!s)return;s.translate(0,n.height),s.scale(1,-1);const i=r.height-n.height;s.drawImage(r,0,i,n.width,n.height,0,0,n.width,n.height)}copyGLTo2DPutImageData(e,t){const r=t.targetCanvas.getContext("2d"),n=t.destinationWidth,s=t.destinationHeight,i=n*s*4;if(!r)return;const o=new Uint8Array(this.imageBuffer,0,i),a=new Uint8ClampedArray(this.imageBuffer,0,i);e.readPixels(0,0,n,s,e.RGBA,e.UNSIGNED_BYTE,o);const l=new ImageData(a,n,s);r.putImageData(l,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const r=e.getExtension("WEBGL_debug_renderer_info");if(r){const n=e.getParameter(r.UNMASKED_RENDERER_WEBGL),s=e.getParameter(r.UNMASKED_VENDOR_WEBGL);n&&(t.renderer=n.toLowerCase()),s&&(t.vendor=s.toLowerCase())}return this.gpuInfo=t,t}}let Ju;function Qu(){return!Ju&&(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(Ju=function(){const{WebGLProbe:e}=js();return e.queryWebGL(Di()),xs.enableGLFiltering&&e.isSupported(xs.textureSize)?new Ku({tileSize:xs.textureSize}):new Xu}()),Ju}const Zu=["cropX","cropY"];class eh extends _l{static getDefaults(){return{...super.getDefaults(),...eh.ownDefaults}}constructor(e,t){super(),bs(this,"_lastScaleX",1),bs(this,"_lastScaleY",1),bs(this,"_filterScalingX",1),bs(this,"_filterScalingY",1),this.filters=[],Object.assign(this,eh.ownDefaults),this.setOptions(t),this.cacheKey=`texture${Ai()}`,this.setElement("string"==typeof e?(this.canvas&&uo(this.canvas.getElement())||Ps()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._element=e,this._originalElement=e,this._setWidthHeight(t),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=Qu(!1);t instanceof Ku&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&js().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||0===this.strokeWidth)return;const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,-r),e.lineTo(t,-r),e.lineTo(t,r),e.lineTo(-t,r),e.lineTo(-t,-r),e.closePath()}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=[];return this.filters.forEach(e=>{e&&t.push(e.toObject())}),{...super.toObject([...Zu,...e]),src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t,...this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{}}}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,r=-this.width/2,n=-this.height/2;let s=[],i=[],o="",a="";if(!t)return[];if(this.hasCrop()){const e=Ai();s.push('<clipPath id="imageCrop_'+e+'">\n','\t<rect x="'+r+'" y="'+n+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),o=' clip-path="url(#imageCrop_'+e+')" '}if(this.imageSmoothing||(a=' image-rendering="optimizeSpeed"'),e.push("\t<image ","COMMON_PARTS",`xlink:href="${this.getSvgSrc(!0)}" x="${r-this.cropX}" y="${n-this.cropY}" width="${t.width||t.naturalWidth}" height="${t.height||t.naturalHeight}"${a}${o}></image>\n`),this.stroke||this.strokeDashArray){const e=this.fill;this.fill=null,i=[`\t<rect x="${r}" y="${n}" width="${this.width}" height="${this.height}" style="${this.getSvgStyles()}" />\n`],this.fill=e}return s=this.paintFirst!==ui?s.concat(i,e):s.concat(e,i),s}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Qi(e,{crossOrigin:t,signal:r}).then(e=>{void 0!==t&&this.set({crossOrigin:t}),this.setElement(e)})}toString(){return`#<Image: { src: "${this.getSrc()}" }>`}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),n=r.x,s=r.y,i=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||n>t&&s>t)return this._element=i,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,void(this._lastScaleY=s);const o=Ni(i),{width:a,height:l}=i;this._element=o,this._lastScaleX=e.scaleX=n,this._lastScaleY=e.scaleY=s,Qu().applyFilters([e],i,a,l,this._element),this._filterScalingX=o.width/this._originalElement.width,this._filterScalingY=o.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.filters||[];if(e=e.filter(e=>e&&!e.isNeutralState()),this.set("dirty",!0),this.removeTexture(`${this.cacheKey}_filtered`),0===e.length)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,r=t.naturalWidth||t.width,n=t.naturalHeight||t.height;if(this._element===this._originalElement){const e=Ni({width:r,height:n});this._element=e,this._filteredEl=e}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,n),this._lastScaleX=1,this._lastScaleY=1);Qu().applyFilters(e,this._originalElement,r,n,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const r=this._filterScalingX,n=this._filterScalingY,s=this.width,i=this.height,o=Math.max(this.cropX,0),a=Math.max(this.cropY,0),l=t.naturalWidth||t.width,c=t.naturalHeight||t.height,u=o*r,h=a*n,d=Math.min(s*r,l-u),f=Math.min(i*n,c-h),p=-s/2,g=-i/2,m=Math.min(s,l/r-o),y=Math.min(i,c/n-a);t&&e.drawImage(t,u,h,d,f,p,g,m,y)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this.getOriginalSize();this.width=e||r.width,this.height=t||r.height}parsePreserveAspectRatioAttribute(){const e=(e=>{const[t,r]=e.trim().split(" "),[n,s]=(i=t)&&i!==qs?[i.slice(1,4),i.slice(5,8)]:i===qs?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:r||"meet",alignX:n,alignY:s}})(this.preserveAspectRatio||""),t=this.width,r=this.height,n={width:t,height:r};let s,i=this._element.width,o=this._element.height,a=1,l=1,c=0,u=0,h=0,d=0;return!e||e.alignX===qs&&e.alignY===qs?(a=t/i,l=r/o):("meet"===e.meetOrSlice&&(a=l=((e,t)=>Math.min(t.width/e.width,t.height/e.height))(this._element,n),s=(t-i*a)/2,"Min"===e.alignX&&(c=-s),"Max"===e.alignX&&(c=s),s=(r-o*l)/2,"Min"===e.alignY&&(u=-s),"Max"===e.alignY&&(u=s)),"slice"===e.meetOrSlice&&(a=l=((e,t)=>Math.max(t.width/e.width,t.height/e.height))(this._element,n),s=i-t/a,"Mid"===e.alignX&&(h=s/2),"Max"===e.alignX&&(h=s),s=o-r/l,"Mid"===e.alignY&&(d=s/2),"Max"===e.alignY&&(d=s),i=t/a,o=r/l)),{width:i,height:o,scaleX:a,scaleY:l,offsetLeft:c,offsetTop:u,cropX:h,cropY:d}}static fromObject(e,t){let{filters:r,resizeFilter:n,src:s,crossOrigin:i,type:o,...a}=e;return Promise.all([Qi(s,{...t,crossOrigin:i}),r&&Zi(r,t),n?Zi([n],t):[],eo(a,t)]).then(e=>{let[t,r=[],[n],i={}]=e;return new this(t,{...a,src:s,filters:r,resizeFilter:n,...i})})}static fromURL(e){let{crossOrigin:t=null,signal:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Qi(e,{crossOrigin:t,signal:r}).then(e=>new this(e,n))}static async fromElement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const n=nc(e,this.ATTRIBUTE_NAMES,r);return this.fromURL(n["xlink:href"]||n.href,t,n).catch(e=>(_s("log","Unable to parse Image",e),null))}}bs(eh,"type","Image"),bs(eh,"cacheProperties",[...ja,...Zu]),bs(eh,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),bs(eh,"ATTRIBUTE_NAMES",[...Rl,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),vi.setClass(eh),vi.setSVGClass(eh),oa(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const th=e=>void 0!==e.webgl,rh="precision highp float",nh=`\n    ${rh};\n    varying vec2 vTexCoord;\n    uniform sampler2D uTexture;\n    void main() {\n      gl_FragColor = texture2D(uTexture, vTexCoord);\n    }`,sh=new RegExp(rh,"g");class ih{get type(){return this.constructor.type}constructor(){let{type:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,this.constructor.defaults,t)}getFragmentSource(){return nh}getVertexSource(){return"\n    attribute vec2 aPosition;\n    varying vec2 vTexCoord;\n    void main() {\n      vTexCoord = aPosition;\n      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n    }"}createProgram(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:n="highp"}}=js();"highp"!==n&&(t=t.replace(sh,rh.replace("highp",n)));const s=e.createShader(e.VERTEX_SHADER),i=e.createShader(e.FRAGMENT_SHADER),o=e.createProgram();if(!s||!i||!o)throw new Ss("Vertex, fragment shader or program creation error");if(e.shaderSource(s,r),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Ss(`Vertex shader compile error for ${this.type}: ${e.getShaderInfoLog(s)}`);if(e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Ss(`Fragment shader compile error for ${this.type}: ${e.getShaderInfoLog(i)}`);if(e.attachShader(o,s),e.attachShader(o,i),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Ss(`Shader link error for "${this.type}" ${e.getProgramInfoLog(o)}`);const a=this.getUniformLocations(e,o)||{};return a.uStepW=e.getUniformLocation(o,"uStepW"),a.uStepH=e.getUniformLocation(o,"uStepH"),{program:o,attributeLocations:this.getAttributeLocations(e,o),uniformLocations:a}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const r=this.constructor.uniformLocations,n={};for(let s=0;s<r.length;s++)n[r[s]]=e.getUniformLocation(t,r[s]);return n}sendAttributeData(e,t,r){const n=t.aPosition,s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(n),e.vertexAttribPointer(n,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const r=e.destinationWidth,n=e.destinationHeight;e.sourceWidth===r&&e.sourceHeight===n||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,r,n)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){th(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,r=this.retrieveShader(e);0===e.pass&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(r.program),this.sendAttributeData(t,r.attributeLocations,e.aPosition),t.uniform1f(r.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(r.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,r.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:r}=e,n=Ni({width:t,height:r});e.helpLayer=n}}toObject(){const e=Object.keys(this.constructor.defaults||{});return{type:this.type,...e.reduce((e,t)=>(e[t]=this[t],e),{})}}toJSON(){return this.toObject()}static async fromObject(e,t){let{type:r,...n}=e;return new this(n)}}bs(ih,"type","BaseFilter"),bs(ih,"uniformLocations",[]);const oh={multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",difference:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"\n    if (uColor.r < 0.5) {\n      gl_FragColor.r *= 2.0 * uColor.r;\n    } else {\n      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n    }\n    if (uColor.g < 0.5) {\n      gl_FragColor.g *= 2.0 * uColor.g;\n    } else {\n      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n    }\n    if (uColor.b < 0.5) {\n      gl_FragColor.b *= 2.0 * uColor.b;\n    } else {\n      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n    }\n    ",tint:"\n    gl_FragColor.rgb *= (1.0 - uColor.a);\n    gl_FragColor.rgb += uColor.rgb;\n    "};class ah extends ih{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return`\n      precision highp float;\n      uniform sampler2D uTexture;\n      uniform vec4 uColor;\n      varying vec2 vTexCoord;\n      void main() {\n        vec4 color = texture2D(uTexture, vTexCoord);\n        gl_FragColor = color;\n        if (color.a > 0.0) {\n          ${oh[this.mode]}\n        }\n      }\n      `}applyTo2d(e){let{imageData:{data:t}}=e;const r=new ra(this.color).getSource(),n=this.alpha,s=r[0]*n,i=r[1]*n,o=r[2]*n,a=1-n;for(let l=0;l<t.length;l+=4){const e=t[l],r=t[l+1],n=t[l+2];let c,u,h;switch(this.mode){case"multiply":c=e*s/255,u=r*i/255,h=n*o/255;break;case"screen":c=255-(255-e)*(255-s)/255,u=255-(255-r)*(255-i)/255,h=255-(255-n)*(255-o)/255;break;case"add":c=e+s,u=r+i,h=n+o;break;case"difference":c=Math.abs(e-s),u=Math.abs(r-i),h=Math.abs(n-o);break;case"subtract":c=e-s,u=r-i,h=n-o;break;case"darken":c=Math.min(e,s),u=Math.min(r,i),h=Math.min(n,o);break;case"lighten":c=Math.max(e,s),u=Math.max(r,i),h=Math.max(n,o);break;case"overlay":c=s<128?2*e*s/255:255-2*(255-e)*(255-s)/255,u=i<128?2*r*i/255:255-2*(255-r)*(255-i)/255,h=o<128?2*n*o/255:255-2*(255-n)*(255-o)/255;break;case"exclusion":c=s+e-2*s*e/255,u=i+r-2*i*r/255,h=o+n-2*o*n/255;break;case"tint":c=s+e*a,u=i+r*a,h=o+n*a}t[l]=c,t[l+1]=u,t[l+2]=h}}sendUniformData(e,t){const r=new ra(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,e.uniform4fv(t.uColor,r)}}bs(ah,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),bs(ah,"type","BlendColor"),bs(ah,"uniformLocations",["uColor"]),vi.setClass(ah);const lh={multiply:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform sampler2D uImage;\n    uniform vec4 uColor;\n    varying vec2 vTexCoord;\n    varying vec2 vTexCoord2;\n    void main() {\n      vec4 color = texture2D(uTexture, vTexCoord);\n      vec4 color2 = texture2D(uImage, vTexCoord2);\n      color.rgba *= color2.rgba;\n      gl_FragColor = color;\n    }\n    ",mask:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform sampler2D uImage;\n    uniform vec4 uColor;\n    varying vec2 vTexCoord;\n    varying vec2 vTexCoord2;\n    void main() {\n      vec4 color = texture2D(uTexture, vTexCoord);\n      vec4 color2 = texture2D(uImage, vTexCoord2);\n      color.a = color2.a;\n      gl_FragColor = color;\n    }\n    "};class ch extends ih{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return lh[this.mode]}getVertexSource(){return"\n    attribute vec2 aPosition;\n    varying vec2 vTexCoord;\n    varying vec2 vTexCoord2;\n    uniform mat3 uTransformMatrix;\n    void main() {\n      vTexCoord = aPosition;\n      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\n      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n    }\n    "}applyToWebGL(e){const t=e.context,r=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,r,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:r}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/r,1]}applyTo2d(e){let{imageData:{data:t,width:r,height:n},filterBackend:{resources:s}}=e;const i=this.image;s.blendImage||(s.blendImage=Di());const o=s.blendImage,a=o.getContext("2d");o.width!==r||o.height!==n?(o.width=r,o.height=n):a.clearRect(0,0,r,n),a.setTransform(i.scaleX,0,0,i.scaleY,i.left,i.top),a.drawImage(i.getElement(),0,0,r,n);const l=a.getImageData(0,0,r,n).data;for(let c=0;c<t.length;c+=4){const e=t[c],r=t[c+1],n=t[c+2],s=t[c+3],i=l[c],o=l[c+1],a=l[c+2],u=l[c+3];switch(this.mode){case"multiply":t[c]=e*i/255,t[c+1]=r*o/255,t[c+2]=n*a/255,t[c+3]=s*u/255;break;case"mask":t[c+3]=u}}}sendUniformData(e,t){const r=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,r)}toObject(){return{...super.toObject(),image:this.image&&this.image.toObject()}}static async fromObject(e,t){let{type:r,image:n,...s}=e;return eh.fromObject(n,t).then(e=>new this({...s,image:e}))}}bs(ch,"type","BlendImage"),bs(ch,"defaults",{mode:"multiply",alpha:1}),bs(ch,"uniformLocations",["uTransformMatrix","uImage"]),vi.setClass(ch);class uh extends ih{getFragmentSource(){return"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform vec2 uDelta;\n    varying vec2 vTexCoord;\n    const float nSamples = 15.0;\n    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);\n    float random(vec3 scale) {\n      /* use the fragment position for a different seed per-pixel */\n      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n    }\n    void main() {\n      vec4 color = vec4(0.0);\n      float totalC = 0.0;\n      float totalA = 0.0;\n      float offset = random(v3offset);\n      for (float t = -nSamples; t <= nSamples; t++) {\n        float percent = (t + offset - 0.5) / nSamples;\n        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);\n        float weight = 1.0 - abs(percent);\n        float alpha = weight * sample.a;\n        color.rgb += sample.rgb * alpha;\n        color.a += alpha;\n        totalA += weight;\n        totalC += alpha;\n      }\n      gl_FragColor.rgb = color.rgb / totalC;\n      gl_FragColor.a = color.a / totalA;\n    }\n  "}applyTo(e){th(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:r,height:n}}=e;this.aspectRatio=r/n,this.horizontal=!0;let s=this.getBlurValue()*r;const i=new Uint8ClampedArray(t),o=4*r;for(let a=0;a<t.length;a+=4){let e=0,r=0,n=0,l=0,c=0;const u=a-a%o,h=u+o;for(let i=-14;i<15;i++){const o=i/15,d=4*Math.floor(s*o),f=1-Math.abs(o);let p=a+d;p<u?p=u:p>h&&(p=h);const g=t[p+3]*f;e+=t[p]*g,r+=t[p+1]*g,n+=t[p+2]*g,l+=g,c+=f}i[a]=e/l,i[a+1]=r/l,i[a+2]=n/l,i[a+3]=l/c}this.horizontal=!1,s=this.getBlurValue()*n;for(let a=0;a<i.length;a+=4){let e=0,r=0,n=0,l=0,c=0;const u=a%o,h=i.length-o+u;for(let t=-14;t<15;t++){const d=t/15,f=Math.floor(s*d)*o,p=1-Math.abs(d);let g=a+f;g<u?g=u:g>h&&(g=h);const m=i[g+3]*p;e+=i[g]*m,r+=i[g+1]*m,n+=i[g+2]*m,l+=m,c+=p}t[a]=e/l,t[a+1]=r/l,t[a+2]=n/l,t[a+3]=l/c}}sendUniformData(e,t){const r=this.chooseRightDelta();e.uniform2fv(t.uDelta,r)}isNeutralState(){return 0===this.blur}getBlurValue(){let e=1;const{horizontal:t,aspectRatio:r}=this;return t?r>1&&(e=1/r):r<1&&(e=r),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}bs(uh,"type","Blur"),bs(uh,"defaults",{blur:0}),bs(uh,"uniformLocations",["uDelta"]),vi.setClass(uh);class hh extends ih{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uBrightness;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    color.rgb += uBrightness;\n    gl_FragColor = color;\n  }\n"}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.round(255*this.brightness);for(let n=0;n<t.length;n+=4)t[n]+=r,t[n+1]+=r,t[n+2]+=r}isNeutralState(){return 0===this.brightness}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}bs(hh,"type","Brightness"),bs(hh,"defaults",{brightness:0}),bs(hh,"uniformLocations",["uBrightness"]),vi.setClass(hh);const dh={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class fh extends ih{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  varying vec2 vTexCoord;\n  uniform mat4 uColorMatrix;\n  uniform vec4 uConstants;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    color *= uColorMatrix;\n    color += uConstants;\n    gl_FragColor = color;\n  }"}applyTo2d(e){const t=e.imageData.data,r=this.matrix,n=this.colorsOnly;for(let s=0;s<t.length;s+=4){const e=t[s],i=t[s+1],o=t[s+2];if(t[s]=e*r[0]+i*r[1]+o*r[2]+255*r[4],t[s+1]=e*r[5]+i*r[6]+o*r[7]+255*r[9],t[s+2]=e*r[10]+i*r[11]+o*r[12]+255*r[14],!n){const n=t[s+3];t[s]+=n*r[3],t[s+1]+=n*r[8],t[s+2]+=n*r[13],t[s+3]=e*r[15]+i*r[16]+o*r[17]+n*r[18]+255*r[19]}}}sendUniformData(e,t){const r=this.matrix,n=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],s=[r[4],r[9],r[14],r[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,n),e.uniform4fv(t.uConstants,s)}toObject(){return{...super.toObject(),matrix:[...this.matrix]}}}function ph(e,t){var r;const n=(bs(r=class extends fh{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",e),bs(r,"defaults",{colorsOnly:!1,matrix:t}),r);return vi.setClass(n,e),n}bs(fh,"type","ColorMatrix"),bs(fh,"defaults",dh),bs(fh,"uniformLocations",["uColorMatrix","uConstants"]),vi.setClass(fh),ph("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),ph("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),ph("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),ph("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),ph("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),ph("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),ph("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class gh extends ih{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){th(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(e=>vi.getClass(e.type).fromObject(e,t))).then(e=>new this({subFilters:e}))}}bs(gh,"type","Composed"),vi.setClass(gh);class mh extends ih{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uContrast;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\n    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;\n    gl_FragColor = color;\n  }"}isNeutralState(){return 0===this.contrast}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.floor(255*this.contrast),n=259*(r+255)/(255*(259-r));for(let s=0;s<t.length;s+=4)t[s]=n*(t[s]-128)+128,t[s+1]=n*(t[s+1]-128)+128,t[s+2]=n*(t[s+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}bs(mh,"type","Contrast"),bs(mh,"defaults",{contrast:0}),bs(mh,"uniformLocations",["uContrast"]),vi.setClass(mh);const yh={Convolute_3_1:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[9];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 0);\n      for (float h = 0.0; h < 3.0; h+=1.0) {\n        for (float w = 0.0; w < 3.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\n          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n        }\n      }\n      gl_FragColor = color;\n    }\n    ",Convolute_3_0:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[9];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 1);\n      for (float h = 0.0; h < 3.0; h+=1.0) {\n        for (float w = 0.0; w < 3.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\n          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n        }\n      }\n      float alpha = texture2D(uTexture, vTexCoord).a;\n      gl_FragColor = color;\n      gl_FragColor.a = alpha;\n    }\n    ",Convolute_5_1:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[25];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 0);\n      for (float h = 0.0; h < 5.0; h+=1.0) {\n        for (float w = 0.0; w < 5.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\n          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n        }\n      }\n      gl_FragColor = color;\n    }\n    ",Convolute_5_0:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[25];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 1);\n      for (float h = 0.0; h < 5.0; h+=1.0) {\n        for (float w = 0.0; w < 5.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\n          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n        }\n      }\n      float alpha = texture2D(uTexture, vTexCoord).a;\n      gl_FragColor = color;\n      gl_FragColor.a = alpha;\n    }\n    ",Convolute_7_1:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[49];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 0);\n      for (float h = 0.0; h < 7.0; h+=1.0) {\n        for (float w = 0.0; w < 7.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\n          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n        }\n      }\n      gl_FragColor = color;\n    }\n    ",Convolute_7_0:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[49];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 1);\n      for (float h = 0.0; h < 7.0; h+=1.0) {\n        for (float w = 0.0; w < 7.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\n          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n        }\n      }\n      float alpha = texture2D(uTexture, vTexCoord).a;\n      gl_FragColor = color;\n      gl_FragColor.a = alpha;\n    }\n    ",Convolute_9_1:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[81];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 0);\n      for (float h = 0.0; h < 9.0; h+=1.0) {\n        for (float w = 0.0; w < 9.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\n          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n        }\n      }\n      gl_FragColor = color;\n    }\n    ",Convolute_9_0:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[81];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 1);\n      for (float h = 0.0; h < 9.0; h+=1.0) {\n        for (float w = 0.0; w < 9.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\n          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n        }\n      }\n      float alpha = texture2D(uTexture, vTexCoord).a;\n      gl_FragColor = color;\n      gl_FragColor.a = alpha;\n    }\n    "};class vh extends ih{getCacheKey(){return`${this.type}_${Math.sqrt(this.matrix.length)}_${this.opaque?1:0}`}getFragmentSource(){return yh[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,r=t.data,n=this.matrix,s=Math.round(Math.sqrt(n.length)),i=Math.floor(s/2),o=t.width,a=t.height,l=e.ctx.createImageData(o,a),c=l.data,u=this.opaque?1:0;let h,d,f,p,g,m,y,v,b,w,x,_,S;for(x=0;x<a;x++)for(w=0;w<o;w++){for(g=4*(x*o+w),h=0,d=0,f=0,p=0,S=0;S<s;S++)for(_=0;_<s;_++)y=x+S-i,m=w+_-i,y<0||y>=a||m<0||m>=o||(v=4*(y*o+m),b=n[S*s+_],h+=r[v]*b,d+=r[v+1]*b,f+=r[v+2]*b,u||(p+=r[v+3]*b));c[g]=h,c[g+1]=d,c[g+2]=f,c[g+3]=u?r[g+3]:p}e.imageData=l}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return{...super.toObject(),opaque:this.opaque,matrix:[...this.matrix]}}}bs(vh,"type","Convolute"),bs(vh,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),bs(vh,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),vi.setClass(vh);const bh="Gamma";class wh extends ih{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform vec3 uGamma;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    vec3 correction = (1.0 / uGamma);\n    color.r = pow(color.r, correction.r);\n    color.g = pow(color.g, correction.g);\n    color.b = pow(color.b, correction.b);\n    gl_FragColor = color;\n    gl_FragColor.rgb *= color.a;\n  }\n"}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.gamma,n=1/r[0],s=1/r[1],i=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const o=this.rgbValues;for(let a=0;a<256;a++)o.r[a]=255*Math.pow(a/255,n),o.g[a]=255*Math.pow(a/255,s),o.b[a]=255*Math.pow(a/255,i);for(let a=0;a<t.length;a+=4)t[a]=o.r[t[a]],t[a+1]=o.g[t[a+1]],t[a+2]=o.b[t[a+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return 1===e[0]&&1===e[1]&&1===e[2]}toObject(){return{type:bh,gamma:this.gamma.concat()}}}bs(wh,"type",bh),bs(wh,"defaults",{gamma:[1,1,1]}),bs(wh,"uniformLocations",["uGamma"]),vi.setClass(wh);const xh={average:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = texture2D(uTexture, vTexCoord);\n      float average = (color.r + color.b + color.g) / 3.0;\n      gl_FragColor = vec4(average, average, average, color.a);\n    }\n    ",lightness:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform int uMode;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 col = texture2D(uTexture, vTexCoord);\n      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\n      gl_FragColor = vec4(average, average, average, col.a);\n    }\n    ",luminosity:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform int uMode;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 col = texture2D(uTexture, vTexCoord);\n      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\n      gl_FragColor = vec4(average, average, average, col.a);\n    }\n    "};class _h extends ih{applyTo2d(e){let{imageData:{data:t}}=e;for(let r,n=0;n<t.length;n+=4){const e=t[n],s=t[n+1],i=t[n+2];switch(this.mode){case"average":r=(e+s+i)/3;break;case"lightness":r=(Math.min(e,s,i)+Math.max(e,s,i))/2;break;case"luminosity":r=.21*e+.72*s+.07*i}t[n+2]=t[n+1]=t[n]=r}}getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return xh[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}bs(_h,"type","Grayscale"),bs(_h,"defaults",{mode:"average"}),bs(_h,"uniformLocations",["uMode"]),vi.setClass(_h);const Sh={...dh,rotation:0};class kh extends fh{calculateMatrix(){const e=this.rotation*Math.PI,t=_i(e),r=Si(e),n=1/3,s=Math.sqrt(n)*r,i=1-t;this.matrix=[t+i/3,n*i-s,n*i+s,0,0,n*i+s,t+n*i,n*i-s,0,0,n*i-s,n*i+s,t+n*i,0,0,0,0,0,1,0]}isNeutralState(){return 0===this.rotation}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}bs(kh,"type","HueRotation"),bs(kh,"defaults",Sh),vi.setClass(kh);class Ch extends ih{applyTo2d(e){let{imageData:{data:t}}=e;for(let r=0;r<t.length;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2],this.alpha&&(t[r+3]=255-t[r+3])}getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform int uInvert;\n  uniform int uAlpha;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    if (uInvert == 1) {\n      if (uAlpha == 1) {\n        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);\n      } else {\n        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n      }\n    } else {\n      gl_FragColor = color;\n    }\n  }\n"}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}bs(Ch,"type","Invert"),bs(Ch,"defaults",{alpha:!1,invert:!0}),bs(Ch,"uniformLocations",["uInvert","uAlpha"]),vi.setClass(Ch);class Th extends ih{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uStepH;\n  uniform float uNoise;\n  uniform float uSeed;\n  varying vec2 vTexCoord;\n  float rand(vec2 co, float seed, float vScale) {\n    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n  }\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\n    gl_FragColor = color;\n  }\n"}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.noise;for(let n=0;n<t.length;n+=4){const e=(.5-Math.random())*r;t[n]+=e,t[n+1]+=e,t[n+2]+=e}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return 0===this.noise}}bs(Th,"type","Noise"),bs(Th,"defaults",{noise:0}),bs(Th,"uniformLocations",["uNoise","uSeed"]),vi.setClass(Th);class Eh extends ih{applyTo2d(e){let{imageData:{data:t,width:r,height:n}}=e;for(let s=0;s<n;s+=this.blocksize)for(let e=0;e<r;e+=this.blocksize){const i=4*s*r+4*e,o=t[i],a=t[i+1],l=t[i+2],c=t[i+3];for(let u=s;u<Math.min(s+this.blocksize,n);u++)for(let n=e;n<Math.min(e+this.blocksize,r);n++){const e=4*u*r+4*n;t[e]=o,t[e+1]=a,t[e+2]=l,t[e+3]=c}}}isNeutralState(){return 1===this.blocksize}getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uBlocksize;\n  uniform float uStepW;\n  uniform float uStepH;\n  varying vec2 vTexCoord;\n  void main() {\n    float blockW = uBlocksize * uStepW;\n    float blockH = uBlocksize * uStepH;\n    int posX = int(vTexCoord.x / blockW);\n    int posY = int(vTexCoord.y / blockH);\n    float fposX = float(posX);\n    float fposY = float(posY);\n    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\n    vec4 color = texture2D(uTexture, squareCoords);\n    gl_FragColor = color;\n  }\n"}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}bs(Eh,"type","Pixelate"),bs(Eh,"defaults",{blocksize:4}),bs(Eh,"uniformLocations",["uBlocksize"]),vi.setClass(Eh);class Oh extends ih{getFragmentSource(){return"\nprecision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\n  gl_FragColor = texture2D(uTexture, vTexCoord);\n  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\n    gl_FragColor.a = 0.0;\n  }\n}\n"}applyTo2d(e){let{imageData:{data:t}}=e;const r=255*this.distance,n=new ra(this.color).getSource(),s=[n[0]-r,n[1]-r,n[2]-r],i=[n[0]+r,n[1]+r,n[2]+r];for(let o=0;o<t.length;o+=4){const e=t[o],r=t[o+1],n=t[o+2];e>s[0]&&r>s[1]&&n>s[2]&&e<i[0]&&r<i[1]&&n<i[2]&&(t[o+3]=0)}}sendUniformData(e,t){const r=new ra(this.color).getSource(),n=this.distance,s=[0+r[0]/255-n,0+r[1]/255-n,0+r[2]/255-n,1],i=[r[0]/255+n,r[1]/255+n,r[2]/255+n,1];e.uniform4fv(t.uLow,s),e.uniform4fv(t.uHigh,i)}}bs(Oh,"type","RemoveColor"),bs(Oh,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),bs(Oh,"uniformLocations",["uLow","uHigh"]),vi.setClass(Oh);class jh extends ih{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return`${this.type}_${e}`}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,r=this.getFilterWindow(),n=new Array(r);for(let s=1;s<=r;s++)n[s-1]=e(s*t);return n}generateShader(e){const t=new Array(e);for(let r=1;r<=e;r++)t[r-1]=`${r}.0 * uDelta`;return`\n      precision highp float;\n      uniform sampler2D uTexture;\n      uniform vec2 uDelta;\n      varying vec2 vTexCoord;\n      uniform float uTaps[${e}];\n      void main() {\n        vec4 color = texture2D(uTexture, vTexCoord);\n        float sum = 1.0;\n        ${t.map((e,t)=>`\n              color += texture2D(uTexture, vTexCoord + ${e}) * uTaps[${t}] + texture2D(uTexture, vTexCoord - ${e}) * uTaps[${t}];\n              sum += 2.0 * uTaps[${t}];\n            `).join("\n")}\n        gl_FragColor = color / sum;\n      }\n    `}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){th(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return 1===this.scaleX&&1===this.scaleY}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<1.1920929e-7&&t>-1.1920929e-7)return 1;const r=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(r)/r}}applyTo2d(e){const t=e.imageData,r=this.scaleX,n=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/n;const s=t.width,i=t.height,o=Math.round(s*r),a=Math.round(i*n);let l;l="sliceHack"===this.resizeType?this.sliceByTwo(e,s,i,o,a):"hermite"===this.resizeType?this.hermiteFastResize(e,s,i,o,a):"bilinear"===this.resizeType?this.bilinearFiltering(e,s,i,o,a):"lanczos"===this.resizeType?this.lanczosResize(e,s,i,o,a):new ImageData(o,a),e.imageData=l}sliceByTwo(e,t,r,n,s){const i=e.imageData,o=.5;let a=!1,l=!1,c=t*o,u=r*o;const h=e.filterBackend.resources;let d=0,f=0;const p=t;let g=0;h.sliceByTwo||(h.sliceByTwo=Di());const m=h.sliceByTwo;(m.width<1.5*t||m.height<r)&&(m.width=1.5*t,m.height=r);const y=m.getContext("2d");for(y.clearRect(0,0,1.5*t,r),y.putImageData(i,0,0),n=Math.floor(n),s=Math.floor(s);!a||!l;)t=c,r=u,n<Math.floor(c*o)?c=Math.floor(c*o):(c=n,a=!0),s<Math.floor(u*o)?u=Math.floor(u*o):(u=s,l=!0),y.drawImage(m,d,f,t,r,p,g,c,u),d=p,f=g,g+=u;return y.getImageData(d,f,n,s)}lanczosResize(e,t,r,n,s){const i=e.imageData.data,o=e.ctx.createImageData(n,s),a=o.data,l=this.lanczosCreate(this.lanczosLobes),c=this.rcpScaleX,u=this.rcpScaleY,h=2/this.rcpScaleX,d=2/this.rcpScaleY,f=Math.ceil(c*this.lanczosLobes/2),p=Math.ceil(u*this.lanczosLobes/2),g={},m={x:0,y:0},y={x:0,y:0};return function e(v){let b,w,x,_,S,k,C,T,E,O,j;for(m.x=(v+.5)*c,y.x=Math.floor(m.x),b=0;b<s;b++){for(m.y=(b+.5)*u,y.y=Math.floor(m.y),S=0,k=0,C=0,T=0,E=0,w=y.x-f;w<=y.x+f;w++)if(!(w<0||w>=t)){O=Math.floor(1e3*Math.abs(w-m.x)),g[O]||(g[O]={});for(let e=y.y-p;e<=y.y+p;e++)e<0||e>=r||(j=Math.floor(1e3*Math.abs(e-m.y)),g[O][j]||(g[O][j]=l(Math.sqrt(Math.pow(O*h,2)+Math.pow(j*d,2))/1e3)),x=g[O][j],x>0&&(_=4*(e*t+w),S+=x,k+=x*i[_],C+=x*i[_+1],T+=x*i[_+2],E+=x*i[_+3]))}_=4*(b*n+v),a[_]=k/S,a[_+1]=C/S,a[_+2]=T/S,a[_+3]=E/S}return++v<n?e(v):o}(0)}bilinearFiltering(e,t,r,n,s){let i,o,a,l,c,u,h,d,f,p,g,m,y,v=0;const b=this.rcpScaleX,w=this.rcpScaleY,x=4*(t-1),_=e.imageData.data,S=e.ctx.createImageData(n,s),k=S.data;for(h=0;h<s;h++)for(d=0;d<n;d++)for(c=Math.floor(b*d),u=Math.floor(w*h),f=b*d-c,p=w*h-u,y=4*(u*t+c),g=0;g<4;g++)i=_[y+g],o=_[y+4+g],a=_[y+x+g],l=_[y+x+4+g],m=i*(1-f)*(1-p)+o*f*(1-p)+a*p*(1-f)+l*f*p,k[v++]=m;return S}hermiteFastResize(e,t,r,n,s){const i=this.rcpScaleX,o=this.rcpScaleY,a=Math.ceil(i/2),l=Math.ceil(o/2),c=e.imageData.data,u=e.ctx.createImageData(n,s),h=u.data;for(let d=0;d<s;d++)for(let e=0;e<n;e++){const r=4*(e+d*n);let s=0,u=0,f=0,p=0,g=0,m=0,y=0;const v=(d+.5)*o;for(let n=Math.floor(d*o);n<(d+1)*o;n++){const r=Math.abs(v-(n+.5))/l,o=(e+.5)*i,h=r*r;for(let l=Math.floor(e*i);l<(e+1)*i;l++){let e=Math.abs(o-(l+.5))/a;const r=Math.sqrt(h+e*e);r>1&&r<-1||(s=2*r*r*r-3*r*r+1,s>0&&(e=4*(l+n*t),y+=s*c[e+3],f+=s,c[e+3]<255&&(s=s*c[e+3]/250),p+=s*c[e],g+=s*c[e+1],m+=s*c[e+2],u+=s))}}h[r]=p/u,h[r+1]=g/u,h[r+2]=m/u,h[r+3]=y/f}return u}}bs(jh,"type","Resize"),bs(jh,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),bs(jh,"uniformLocations",["uDelta","uTaps"]),vi.setClass(jh);class Ph extends ih{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uSaturation;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    float rgMax = max(color.r, color.g);\n    float rgbMax = max(rgMax, color.b);\n    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\n    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\n    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\n    gl_FragColor = color;\n  }\n"}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.saturation;for(let n=0;n<t.length;n+=4){const e=t[n],s=t[n+1],i=t[n+2],o=Math.max(e,s,i);t[n]+=o!==e?(o-e)*r:0,t[n+1]+=o!==s?(o-s)*r:0,t[n+2]+=o!==i?(o-i)*r:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return 0===this.saturation}}bs(Ph,"type","Saturation"),bs(Ph,"defaults",{saturation:0}),bs(Ph,"uniformLocations",["uSaturation"]),vi.setClass(Ph);class Ah extends ih{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uVibrance;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    float max = max(color.r, max(color.g, color.b));\n    float avg = (color.r + color.g + color.b) / 3.0;\n    float amt = (abs(max - avg) * 2.0) * uVibrance;\n    color.r += max != color.r ? (max - color.r) * amt : 0.00;\n    color.g += max != color.g ? (max - color.g) * amt : 0.00;\n    color.b += max != color.b ? (max - color.b) * amt : 0.00;\n    gl_FragColor = color;\n  }\n"}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.vibrance;for(let n=0;n<t.length;n+=4){const e=t[n],s=t[n+1],i=t[n+2],o=Math.max(e,s,i),a=(e+s+i)/3,l=2*Math.abs(o-a)/255*r;t[n]+=o!==e?(o-e)*l:0,t[n+1]+=o!==s?(o-s)*l:0,t[n+2]+=o!==i?(o-i)*l:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return 0===this.vibrance}}bs(Ah,"type","Vibrance"),bs(Ah,"defaults",{vibrance:0}),bs(Ah,"uniformLocations",["uVibrance"]),vi.setClass(Ah);class Dh extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Nh extends Dh{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Mh extends Dh{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Rh extends Dh{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Lh,Ih;(Ih=Lh||(Lh={})).Any="any",Ih.ApNortheast1="ap-northeast-1",Ih.ApNortheast2="ap-northeast-2",Ih.ApSouth1="ap-south-1",Ih.ApSoutheast1="ap-southeast-1",Ih.ApSoutheast2="ap-southeast-2",Ih.CaCentral1="ca-central-1",Ih.EuCentral1="eu-central-1",Ih.EuWest1="eu-west-1",Ih.EuWest2="eu-west-2",Ih.EuWest3="eu-west-3",Ih.SaEast1="sa-east-1",Ih.UsEast1="us-east-1",Ih.UsWest1="us-west-1",Ih.UsWest2="us-west-2";class $h{constructor(e,{headers:t={},customFetch:r,region:n=Lh.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=(e=>e?(...t)=>e(...t):(...e)=>fetch(...e))(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Tr(this,arguments,void 0,function*(e,t={}){var r;let n,s;try{const{headers:i,method:o,body:a,signal:l,timeout:c}=t;let u={},{region:h}=t;h||(h=this.region);const d=new URL(`${this.url}/${e}`);let f;h&&"any"!==h&&(u["x-region"]=h,d.searchParams.set("forceFunctionRegion",h)),a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?"undefined"!=typeof Blob&&a instanceof Blob||a instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",f=a):"string"==typeof a?(u["Content-Type"]="text/plain",f=a):"undefined"!=typeof FormData&&a instanceof FormData?f=a:(u["Content-Type"]="application/json",f=JSON.stringify(a)):f=!a||"string"==typeof a||"undefined"!=typeof Blob&&a instanceof Blob||a instanceof ArrayBuffer||"undefined"!=typeof FormData&&a instanceof FormData?a:JSON.stringify(a);let p=l;c&&(s=new AbortController,n=setTimeout(()=>s.abort(),c),l?(p=s.signal,l.addEventListener("abort",()=>s.abort())):p=s.signal);const g=yield this.fetch(d.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),i),body:f,signal:p}).catch(e=>{throw new Nh(e)}),m=g.headers.get("x-relay-error");if(m&&"true"===m)throw new Mh(g);if(!g.ok)throw new Rh(g);let y,v=(null!==(r=g.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return y="application/json"===v?yield g.json():"application/octet-stream"===v||"application/pdf"===v?yield g.blob():"text/event-stream"===v?g:"multipart/form-data"===v?yield g.formData():yield g.text(),{data:y,error:null,response:g}}catch(i){return{data:null,error:i,response:i instanceof Rh||i instanceof Mh?i.context:void 0}}finally{n&&clearTimeout(n)}})}}var Fh=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},zh=class{constructor(e){var t,r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,this.urlLengthLimit=null!==(n=e.urlLengthLimit)&&void 0!==n?n:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{let t=null,n=null,s=null,i=e.status,o=e.statusText;if(e.ok){var a,l;if("HEAD"!==r.method){var c;const t=await e.text();""===t||(n="text/csv"===r.headers.get("Accept")||r.headers.get("Accept")&&(null===(c=r.headers.get("Accept"))||void 0===c?void 0:c.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}const u=null===(a=r.headers.get("Prefer"))||void 0===a?void 0:a.match(/count=(exact|planned|estimated)/),h=null===(l=e.headers.get("content-range"))||void 0===l?void 0:l.split("/");u&&h&&h.length>1&&(s=parseInt(h[1])),r.isMaybeSingle&&"GET"===r.method&&Array.isArray(n)&&(n.length>1?(t={code:"PGRST116",details:`Results contain ${n.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},n=null,s=null,i=406,o="Not Acceptable"):n=1===n.length?n[0]:null)}else{var u;const s=await e.text();try{t=JSON.parse(s),Array.isArray(t)&&404===e.status&&(n=[],t=null,i=200,o="OK")}catch(h){404===e.status&&""===s?(i=204,o="No Content"):t={message:s}}if(t&&r.isMaybeSingle&&(null==t||null===(u=t.details)||void 0===u?void 0:u.includes("0 rows"))&&(t=null,i=200,o="OK"),t&&r.shouldThrowOnError)throw new Fh(t)}return{error:t,data:n,count:s,status:i,statusText:o}});return this.shouldThrowOnError||(n=n.catch(e=>{var t;let r="",n="",s="";const i=null==e?void 0:e.cause;if(i){var o,a,l,c;const t=null!==(o=null==i?void 0:i.message)&&void 0!==o?o:"",n=null!==(a=null==i?void 0:i.code)&&void 0!==a?a:"";r=`${null!==(l=null==e?void 0:e.name)&&void 0!==l?l:"FetchError"}: ${null==e?void 0:e.message}`,r+=`\n\nCaused by: ${null!==(c=null==i?void 0:i.name)&&void 0!==c?c:"Error"}: ${t}`,n&&(r+=` (${n})`),(null==i?void 0:i.stack)&&(r+=`\n${i.stack}`)}else{var u;r=null!==(u=null==e?void 0:e.stack)&&void 0!==u?u:""}const h=this.url.toString().length;return"AbortError"===(null==e?void 0:e.name)||"ABORT_ERR"===(null==e?void 0:e.code)?(s="",n="Request was aborted (timeout or manual cancellation)",h>this.urlLengthLimit&&(n+=`. Note: Your request URL is ${h} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):"HeadersOverflowError"!==(null==i?void 0:i.name)&&"UND_ERR_HEADERS_OVERFLOW"!==(null==i?void 0:i.code)||(s="",n="HTTP headers exceeded server limits (typically 16KB)",h>this.urlLengthLimit&&(n+=`. Your request URL is ${h} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:r,hint:n,code:s},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}},Bh=class extends zh{select(e){let t=!1;const r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:s=n}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const s=void 0===n?"offset":`${n}.offset`,i=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:s=!1,format:i="text"}={}){var o;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.get("Accept"))&&void 0!==o?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Uh=new RegExp("[,()]");var Wh=class extends Bh{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&Uh.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&Uh.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let s="";"plain"===n?s="pl":"phrase"===n?s="ph":"websearch"===n&&(s="w");const i=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},Vh=class{constructor(e,{headers:t={},schema:r,fetch:n,urlLengthLimit:s=8e3}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=null!=t?t:{},s=r?"HEAD":"GET";let i=!1;const o=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e)).join(""),{url:a,headers:l}=this.cloneRequestState();return a.searchParams.set("select",o),n&&l.append("Prefer",`count=${n}`),new Wh({method:s,url:a,headers:l,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const{url:s,headers:i}=this.cloneRequestState();if(t&&i.append("Prefer",`count=${t}`),r||i.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);s.searchParams.set("columns",e.join(","))}}return new Wh({method:"POST",url:s,headers:i,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){var i;const{url:o,headers:a}=this.cloneRequestState();if(a.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&o.searchParams.set("on_conflict",t),n&&a.append("Prefer",`count=${n}`),s||a.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);o.searchParams.set("columns",e.join(","))}}return new Wh({method:"POST",url:o,headers:a,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch,urlLengthLimit:this.urlLengthLimit})}update(e,{count:t}={}){var r;const{url:n,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Wh({method:"PATCH",url:n,headers:s,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:e}={}){var t;const{url:r,headers:n}=this.cloneRequestState();return e&&n.append("Prefer",`count=${e}`),new Wh({method:"DELETE",url:r,headers:n,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function Hh(e){return(Hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gh(e){var t=function(e,t){if("object"!=Hh(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=Hh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Hh(t)?t:t+""}function Yh(e,t,r){return(t=Gh(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Xh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qh(Object(r),!0).forEach(function(t){Yh(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qh(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Kh=class e{constructor(e,{headers:t={},schema:r,fetch:n,timeout:s,urlLengthLimit:i=8e3}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.urlLengthLimit=i;const o=null!=n?n:globalThis.fetch;this.fetch=void 0!==s&&s>0?(e,t)=>{const r=new AbortController,n=setTimeout(()=>r.abort(),s),i=null==t?void 0:t.signal;if(i){if(i.aborted)return clearTimeout(n),o(e,t);const s=()=>{clearTimeout(n),r.abort()};return i.addEventListener("abort",s,{once:!0}),o(e,Xh(Xh({},t),{},{signal:r.signal})).finally(()=>{clearTimeout(n),i.removeEventListener("abort",s)})}return o(e,Xh(Xh({},t),{},{signal:r.signal})).finally(()=>clearTimeout(n))}:o}from(e){if(!e||"string"!=typeof e||""===e.trim())throw new Error("Invalid relation name: relation must be a non-empty string.");return new Vh(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,t={},{head:r=!1,get:n=!1,count:s}={}){var i;let o;const a=new URL(`${this.url}/rpc/${e}`);let l;const c=e=>null!==e&&"object"==typeof e&&(!Array.isArray(e)||e.some(c)),u=r&&Object.values(t).some(c);u?(o="POST",l=t):r||n?(o=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{a.searchParams.append(e,t)})):(o="POST",l=t);const h=new Headers(this.headers);return u?h.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&h.set("Prefer",`count=${s}`),new Wh({method:o,url:a,headers:h,schema:this.schemaName,body:l,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch,urlLengthLimit:this.urlLengthLimit})}};class Jh{constructor(){}static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node){const t=e.node,r=parseInt(t.replace(/^v/,"").split(".")[0]);return r>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const Qh="2.0.0",Zh=Qh,ed=1e4;var td,rd,nd,sd,id,od,ad,ld,cd,ud,hd;(rd=td||(td={}))[rd.connecting=0]="connecting",rd[rd.open=1]="open",rd[rd.closing=2]="closing",rd[rd.closed=3]="closed",(sd=nd||(nd={})).closed="closed",sd.errored="errored",sd.joined="joined",sd.joining="joining",sd.leaving="leaving",(od=id||(id={})).close="phx_close",od.error="phx_error",od.join="phx_join",od.reply="phx_reply",od.leave="phx_leave",od.access_token="access_token",(ad||(ad={})).websocket="websocket",(cd=ld||(ld={})).Connecting="connecting",cd.Open="open",cd.Closing="closing",cd.Closed="closed";class dd{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=e?e:[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&"string"==typeof e.payload.event)return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const n=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var t,r;const n=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:{},s=(new TextEncoder).encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,s)}_encodeUserBroadcastPush(e,t,r){var n,s;const i=e.topic,o=null!==(n=e.ref)&&void 0!==n?n:"",a=null!==(s=e.join_ref)&&void 0!==s?s:"",l=e.payload.event,c=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},u=0===Object.keys(c).length?"":JSON.stringify(c);if(a.length>255)throw new Error(`joinRef length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`userEvent length ${l.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`metadata length ${u.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+a.length+o.length+i.length+l.length+u.length,d=new ArrayBuffer(this.HEADER_LENGTH+h);let f=new DataView(d),p=0;f.setUint8(p++,this.KINDS.userBroadcastPush),f.setUint8(p++,a.length),f.setUint8(p++,o.length),f.setUint8(p++,i.length),f.setUint8(p++,l.length),f.setUint8(p++,u.length),f.setUint8(p++,t),Array.from(a,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(o,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(i,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(l,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(u,e=>f.setUint8(p++,e.charCodeAt(0)));var g=new Uint8Array(d.byteLength+r.byteLength);return g.set(new Uint8Array(d),0),g.set(new Uint8Array(r),d.byteLength),g.buffer}decode(e,t){if(this._isArrayBuffer(e)){return t(this._binaryDecode(e))}if("string"==typeof e){const r=JSON.parse(e),[n,s,i,o,a]=r;return t({join_ref:n,ref:s,topic:i,event:o,payload:a})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),n=new TextDecoder;if(r===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,n)}_decodeUserBroadcast(e,t,r){const n=t.getUint8(1),s=t.getUint8(2),i=t.getUint8(3),o=t.getUint8(4);let a=this.HEADER_LENGTH+4;const l=r.decode(e.slice(a,a+n));a+=n;const c=r.decode(e.slice(a,a+s));a+=s;const u=r.decode(e.slice(a,a+i));a+=i;const h=e.slice(a,e.byteLength),d=o===this.JSON_ENCODING?JSON.parse(r.decode(h)):h,f={type:this.BROADCAST_EVENT,event:c,payload:d};return i>0&&(f.meta=JSON.parse(u)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:f}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)}_pick(e,t){return e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(([e])=>t.includes(e))):{}}}class fd{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(hd=ud||(ud={})).abstime="abstime",hd.bool="bool",hd.date="date",hd.daterange="daterange",hd.float4="float4",hd.float8="float8",hd.int2="int2",hd.int4="int4",hd.int4range="int4range",hd.int8="int8",hd.int8range="int8range",hd.json="json",hd.jsonb="jsonb",hd.money="money",hd.numeric="numeric",hd.oid="oid",hd.reltime="reltime",hd.text="text",hd.time="time",hd.timestamp="timestamp",hd.timestamptz="timestamptz",hd.timetz="timetz",hd.tsrange="tsrange",hd.tstzrange="tstzrange";const pd=(e,t,r={})=>{var n;const s=null!==(n=r.skipTypes)&&void 0!==n?n:[];return t?Object.keys(t).reduce((r,n)=>(r[n]=gd(n,e,t,s),r),{}):{}},gd=(e,t,r,n)=>{const s=t.find(t=>t.name===e),i=null==s?void 0:s.type,o=r[e];return i&&!n.includes(i)?md(i,o):yd(o)},md=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return xd(t,r)}switch(e){case ud.bool:return vd(t);case ud.float4:case ud.float8:case ud.int2:case ud.int4:case ud.int8:case ud.numeric:case ud.oid:return bd(t);case ud.json:case ud.jsonb:return wd(t);case ud.timestamp:return _d(t);case ud.abstime:case ud.date:case ud.daterange:case ud.int4range:case ud.int8range:case ud.money:case ud.reltime:case ud.text:case ud.time:case ud.timestamptz:case ud.timetz:case ud.tsrange:case ud.tstzrange:default:return yd(t)}},yd=e=>e,vd=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},bd=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},wd=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},xd=(e,t)=>{if("string"!=typeof e)return e;const r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;const i=e.slice(1,r);try{n=JSON.parse("["+i+"]")}catch(s){n=i?i.split(","):[]}return n.map(e=>md(t,e))}return e},_d=e=>"string"==typeof e?e.replace(" ","T"):e,Sd=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class kd{constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Cd,Td,Ed,Od,jd,Pd,Ad,Dd;(Td=Cd||(Cd={})).SYNC="sync",Td.JOIN="join",Td.LEAVE="leave";class Nd{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Nd.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=Nd.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Nd.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const s=this.cloneDeep(e),i=this.transformState(t),o={},a={};return this.map(s,(e,t)=>{i[e]||(a[e]=t)}),this.map(i,(e,t)=>{const r=s[e];if(r){const n=t.map(e=>e.presence_ref),s=r.map(e=>e.presence_ref),i=t.filter(e=>s.indexOf(e.presence_ref)<0),l=r.filter(e=>n.indexOf(e.presence_ref)<0);i.length>0&&(o[e]=i),l.length>0&&(a[e]=l)}else o[e]=t}),this.syncDiff(s,{joins:o,leaves:a},r,n)}static syncDiff(e,t,r,n){const{joins:s,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(s,(t,n)=>{var s;const i=null!==(s=e[t])&&void 0!==s?s:[];if(e[t]=this.cloneDeep(n),i.length>0){const r=e[t].map(e=>e.presence_ref),n=i.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...n)}r(t,i,n)}),this.map(i,(t,r)=>{let s=e[t];if(!s)return;const i=r.map(e=>e.presence_ref);s=s.filter(e=>i.indexOf(e.presence_ref)<0),e[t]=s,n(t,s,r),0===s.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return t[r]="metas"in n?n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Od=Ed||(Ed={})).ALL="*",Od.INSERT="INSERT",Od.UPDATE="UPDATE",Od.DELETE="DELETE",(Pd=jd||(jd={})).BROADCAST="broadcast",Pd.PRESENCE="presence",Pd.POSTGRES_CHANGES="postgres_changes",Pd.SYSTEM="system",(Dd=Ad||(Ad={})).SUBSCRIBED="SUBSCRIBED",Dd.TIMED_OUT="TIMED_OUT",Dd.CLOSED="CLOSED",Dd.CHANNEL_ERROR="CHANNEL_ERROR";class Md{constructor(e,t={config:{}},r){var n,s;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=nd.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new kd(this,id.join,this.params,this.timeout),this.rejoinTimer=new fd(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=nd.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=nd.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=nd.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=nd.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=nd.errored,this.rejoinTimer.scheduleTimeout())}),this._on(id.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new Nd(this),this.broadcastEndpointURL=Sd(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(s=null===(n=this.params.config)||void 0===n?void 0:n.broadcast)||void 0===s?void 0:s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==nd.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params,l=null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==n?n:[],c=!!this.bindings[jd.PRESENCE]&&this.bindings[jd.PRESENCE].length>0||!0===(null===(s=this.params.config.presence)||void 0===s?void 0:s.enabled),u={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:c}),postgres_changes:l,private:a};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(Ad.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(Ad.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket._isManualToken()||this.socket.setAuth(),void 0!==t){const n=this.bindings.postgres_changes,s=null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0,i=[];for(let r=0;r<s;r++){const s=n[r],{filter:{event:o,schema:a,table:l,filter:c}}=s,u=t&&t[r];if(!(u&&u.event===o&&Md.isFilterValueEqual(u.schema,a)&&Md.isFilterValueEqual(u.table,l)&&Md.isFilterValueEqual(u.filter,c)))return this.unsubscribe(),this.state=nd.errored,void(null==e||e(Ad.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},s),{id:u.id}))}return this.bindings.postgres_changes=i,void(e&&e(Ad.SUBSCRIBED))}null==e||e(Ad.SUBSCRIBED)}).receive("error",t=>{this.state=nd.errored,null==e||e(Ad.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(Ad.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===nd.joined&&e===jd.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var n;if(null==t)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,i,null!==(n=r.timeout)&&void 0!==n?n:this.timeout);if(202===o.status)return{success:!0};let a=o.statusText;try{const e=await o.json();a=e.error||e.message||a}catch(l){}return Promise.reject(new Error(a))}async send(e,t={}){var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var n,s,i;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(s=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===s?void 0:s.broadcast)||void 0===i?void 0:i.ack)||r("ok"),o.receive("ok",()=>r("ok")),o.receive("error",()=>r("error")),o.receive("timeout",()=>r("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(s){return"AbortError"===s.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=nd.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(id.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new kd(this,id.leave,{},e),r.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=nd.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const n=new AbortController,s=setTimeout(()=>n.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(s),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new kd(this,e,t,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,s;const i=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=id;if(r&&[o,a,l,c].indexOf(i)>=0&&r!==this._joinRef())return;let u=this._onMessage(i,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,r,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===i}).map(e=>e.callback(u,r)):null===(s=this.bindings[i])||void 0===s||s.filter(e=>{var r,n,s,o,a,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,o=null===(r=e.filter)||void 0===r?void 0:r.event;return i&&(null===(n=t.ids)||void 0===n?void 0:n.includes(i))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(s=t.data)||void 0===s?void 0:s.type.toLocaleLowerCase()))}{const r=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i}).map(e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:n,type:s,errors:i}=e,o={schema:t,table:r,commit_timestamp:n,eventType:s,new:{},old:{},errors:i};u=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===nd.closed}_isJoined(){return this.state===nd.joined}_isJoining(){return this.state===nd.joining}_isLeaving(){return this.state===nd.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),s={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&Md.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}static isFilterValueEqual(e,t){return(null!=e?e:void 0)===(null!=t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(id.close,{},e)}_onError(e){this._on(id.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=nd.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=pd(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=pd(e.columns,e.old_record)),t}}const Rd=()=>{},Ld=25e3,Id=10,$d=100,Fd=[1e3,2e3,5e3,1e4];class zd{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ed,this.transport=null,this.heartbeatIntervalMs=Ld,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Rd,this.ref=0,this.reconnectTimer=null,this.vsn=Zh,this.logger=Rd,this.conn=null,this.sendBuffer=[],this.serializer=new dd,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${ad.websocket}`,this.httpEndpoint=Sd(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Jh.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(e?this.conn.close(e,null!=t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return"ok"===t&&this._remove(e),0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case td.connecting:return ld.Connecting;case td.open:return ld.Open;case td.closing:return ld.Closing;default:return ld.Closed}}isConnected(){return this.connectionState()===ld.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const r=`realtime:${e}`,n=this.getChannels().find(e=>e.topic===r);if(n)return n;{const r=new Md(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:n,ref:s}=e,i=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${s})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(Xa){this.log("error","error in heartbeat callback",Xa)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},$d)}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(Xa){this.log("error","error in heartbeat callback",Xa)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(Xa){this.log("error","error in heartbeat callback",Xa)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){const t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(Xa){this.log("error","error in heartbeat callback",Xa)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:t,event:r,payload:n,ref:s}=e,i=s?`(${s})`:"",o=n.status||"";this.log("receive",`${o} ${t} ${r} ${i}`.trim(),n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,s)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===td.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===td.open||this.conn.readyState===td.connecting)try{this.conn.close()}catch(Xa){this.log("error","Error closing connection",Xa)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`);(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(Xa){this.log("error","error in heartbeat callback",Xa)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(id.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,r=!1;if(e)t=e,r=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(Xa){this.log("error","Error fetching access token from callback",Xa),t=this.accessTokenValue}else t=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const r={access_token:t,version:"realtime-js/2.95.3"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(id.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(Xa){this.log("error",`error in ${e} callback`,Xa)}})}catch(Xa){this.log("error",`error triggering ${e} callbacks`,Xa)}}_setupReconnectionTimer(){this.reconnectTimer=new fd(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Id)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,n,s,i,o,a,l,c,u,h,d;switch(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:ed,this.heartbeatIntervalMs=null!==(n=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==n?n:Ld,this.worker=null!==(s=null==e?void 0:e.worker)&&void 0!==s&&s,this.accessToken=null!==(i=null==e?void 0:e.accessToken)&&void 0!==i?i:null,this.heartbeatCallback=null!==(o=null==e?void 0:e.heartbeatCallback)&&void 0!==o?o:Rd,this.vsn=null!==(a=null==e?void 0:e.vsn)&&void 0!==a?a:Zh,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null==e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>Fd[e-1]||1e4,this.vsn){case"1.0.0":this.encode=null!==(c=null==e?void 0:e.encode)&&void 0!==c?c:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(u=null==e?void 0:e.decode)&&void 0!==u?u:(e,t)=>t(JSON.parse(e));break;case Qh:this.encode=null!==(h=null==e?void 0:e.encode)&&void 0!==h?h:this.serializer.encode.bind(this.serializer),this.decode=null!==(d=null==e?void 0:e.decode)&&void 0!==d?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}var Bd=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&!0===t.icebergType?.includes("CommitState")}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};function Ud(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:s,body:i,headers:o}){const a=function(e,t,r){const n=new URL(t,e);if(r)for(const[s,i]of Object.entries(r))void 0!==i&&n.searchParams.set(s,i);return n.toString()}(e.baseUrl,n,s),l=await async function(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:`Bearer ${e.token}`}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}(e.auth),c=await t(a,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...l,...o},body:i?JSON.stringify(i):void 0}),u=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),d=h&&u?JSON.parse(u):u;if(!c.ok){const e=h?d:void 0,t=e?.error;throw new Bd(t?.message??`Request failed with status ${c.status}`,{status:c.status,icebergType:t?.type,icebergCode:t?.code,details:e})}return{status:c.status,headers:c.headers,data:d}}}}function Wd(e){return e.join("")}var Vd=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Wd(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Wd(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Wd(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Wd(e.namespace)}`}),!0}catch(t){if(t instanceof Bd&&404===t.status)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Bd&&409===r.status)return;throw r}}};function Hd(e){return e.join("")}var Gd=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Hd(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Hd(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Hd(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Hd(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Hd(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Hd(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Bd&&404===r.status)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Bd&&409===r.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},Yd=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Ud({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new Vd(this.client,t),this.tableOps=new Gd(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},qd=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name="vectors"===t?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function Xd(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}var Kd=class extends qd{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name="vectors"===n?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Jd=class extends qd{constructor(e,t,r="storage"){super(e,r),this.name="vectors"===r?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const Qd=e=>{if(Array.isArray(e))return e.map(e=>Qd(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,r])=>{const n=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[n]=Qd(r)}),t};function Zd(e){return(Zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ef(e){var t=function(e,t){if("object"!=Zd(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=Zd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Zd(t)?t:t+""}function tf(e,t,r){return(t=ef(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function nf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rf(Object(r),!0).forEach(function(t){tf(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rf(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const sf=e=>{var t;return e.msg||e.message||e.error_description||("string"==typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},of=(e,t,r,n)=>{const s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&"HEAD"!==e&&n?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(n)?(s.headers=nf({"Content-Type":"application/json"},null==t?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,(null==t?void 0:t.duplex)&&(s.duplex=t.duplex),nf(nf({},s),r)):nf(nf({},s),r)};async function af(e,t,r,n,s,i,o){return new Promise((a,l)=>{e(r,of(t,n,s,i)).then(e=>{if(!e.ok)throw e;if(null==n?void 0:n.noResolveJson)return e;if("vectors"===o){const t=e.headers.get("content-type");if("0"===e.headers.get("content-length")||204===e.status)return{};if(!t||!t.includes("application/json"))return{}}return e.json()}).then(e=>a(e)).catch(e=>(async(e,t,r,n)=>{if(e&&"object"==typeof e&&"status"in e&&"ok"in e&&"number"==typeof e.status&&!(null==r?void 0:r.noResolveJson)){const r=e,s=r.status||500;if("function"==typeof r.json)r.json().then(e=>{const r=(null==e?void 0:e.statusCode)||(null==e?void 0:e.code)||s+"";t(new Kd(sf(e),s,r,n))}).catch(()=>{if("vectors"===n){const e=s+"";t(new Kd(r.statusText||`HTTP ${s} error`,s,e,n))}else{const e=s+"";t(new Kd(r.statusText||`HTTP ${s} error`,s,e,n))}});else{const e=s+"";t(new Kd(r.statusText||`HTTP ${s} error`,s,e,n))}}else t(new Jd(sf(e),e,n))})(e,l,n,o))})}function lf(e="storage"){return{get:async(t,r,n,s)=>af(t,"GET",r,n,s,void 0,e),post:async(t,r,n,s,i)=>af(t,"POST",r,s,i,n,e),put:async(t,r,n,s,i)=>af(t,"PUT",r,s,i,n,e),head:async(t,r,n,s)=>af(t,"HEAD",r,nf(nf({},n),{},{noResolveJson:!0}),s,void 0,e),remove:async(t,r,n,s,i)=>af(t,"DELETE",r,s,i,n,e)}}const cf=lf("storage"),{get:uf,post:hf,put:df,head:ff,remove:pf}=cf,gf=lf("vectors");var mf=class{constructor(e,t={},r,n="storage"){var s;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=(s=r)?(...e)=>s(...e):(...e)=>fetch(...e),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){try{return{data:await e(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xd(t))return{data:null,error:t};throw t}}},yf=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Xd(e))return{data:null,error:e};throw e}}};let vf;vf=Symbol.toStringTag;var bf=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[vf]="BlobDownloadBuilder",this.promise=null}asStream(){return new yf(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await(await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Xd(e))return{data:null,error:e};throw e}}};const wf={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},xf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var _f=class extends mf{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var s=this;return s.handleOperation(async()=>{let i;const o=nf(nf({},xf),n);let a=nf(nf({},s.headers),"POST"===e&&{"x-upsert":String(o.upsert)});const l=o.metadata;"undefined"!=typeof Blob&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",s.encodeMetadata(l)),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",s.encodeMetadata(l))):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=s.toBase64(s.encodeMetadata(l))),("undefined"!=typeof ReadableStream&&i instanceof ReadableStream||i&&"object"==typeof i&&"pipe"in i&&"function"==typeof i.pipe)&&!o.duplex&&(o.duplex="half")),(null==n?void 0:n.headers)&&(a=nf(nf({},a),n.headers));const c=s._removeEmptyFolders(t),u=s._getFinalPath(c),h=await("PUT"==e?df:hf)(s.fetch,`${s.url}/object/${u}`,i,nf({headers:a},(null==o?void 0:o.duplex)?{duplex:o.duplex}:{}));return{path:c,id:h.Id,fullPath:h.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var s=this;const i=s._removeEmptyFolders(e),o=s._getFinalPath(i),a=new URL(s.url+`/object/upload/sign/${o}`);return a.searchParams.set("token",t),s.handleOperation(async()=>{let e;const t=nf({upsert:xf.upsert},n),o=nf(nf({},s.headers),{"x-upsert":String(t.upsert)});return"undefined"!=typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,o["cache-control"]=`max-age=${t.cacheControl}`,o["content-type"]=t.contentType),{path:i,fullPath:(await df(s.fetch,a.toString(),e,{headers:o})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const s=nf({},r.headers);(null==t?void 0:t.upsert)&&(s["x-upsert"]="true");const i=await hf(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(r.url+i.url),a=o.searchParams.get("token");if(!a)throw new qd("No token returned by API");return{signedUrl:o.toString(),path:e,token:a}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await hf(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await hf(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let s=n._getFinalPath(e),i=await hf(n.fetch,`${n.url}/object/sign/${s}`,nf({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:n.headers});const o=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${i.signedURL}${o}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const s=await hf(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return s.map(e=>nf(nf({},e),{},{signedUrl:e.signedURL?encodeURI(`${n.url}${e.signedURL}${i}`):null}))})}download(e,t,r){const n=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=s?`?${s}`:"",o=this._getFinalPath(e);return new bf(()=>uf(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0},r),this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>Qd(await uf(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await ff(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Xd(n)&&n instanceof Jd){const e=n.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],s=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==s&&n.push(s);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&n.push(o);let a=n.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${a}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await pf(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const s=nf(nf(nf({},wf),t),{},{prefix:e||""});return await hf(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=nf({},e);return await hf(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Sf={"X-Client-Info":"storage-js/2.95.3"};var kf=class extends mf{constructor(e,t={},r,n){const s=new URL(e);(null==n?void 0:n.useNewHostname)&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));super(s.href.replace(/\/$/,""),nf(nf({},Sf),t),r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await uf(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await uf(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await hf(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await df(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await hf(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await pf(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Cf=class extends mf{constructor(e,t={},r){super(e.replace(/\/$/,""),nf(nf({},Sf),t),r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await hf(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;void 0!==(null==e?void 0:e.limit)&&r.set("limit",e.limit.toString()),void 0!==(null==e?void 0:e.offset)&&r.set("offset",e.offset.toString()),(null==e?void 0:e.sortColumn)&&r.set("sortColumn",e.sortColumn),(null==e?void 0:e.sortOrder)&&r.set("sortOrder",e.sortOrder),(null==e?void 0:e.search)&&r.set("search",e.search);const n=r.toString(),s=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await uf(t.fetch,s,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await pf(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!(e=>!(!e||"string"!=typeof e)&&!(0===e.length||e.length>100)&&e.trim()===e&&!e.includes("/")&&!e.includes("\\")&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e))(e))throw new qd("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Yd({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(e,t){const r=e[t];return"function"!=typeof r?r:async(...t)=>{try{return{data:await r.apply(e,t),error:null}}catch(s){if(n)throw s;return{data:null,error:s}}}}})}},Tf=class extends mf{constructor(e,t={},r){super(e.replace(/\/$/,""),nf(nf({},Sf),{},{"Content-Type":"application/json"},t),r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await gf.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await gf.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},Ef=class extends mf{constructor(e,t={},r){super(e.replace(/\/$/,""),nf(nf({},Sf),{},{"Content-Type":"application/json"},t),r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error("segmentIndex must be between 0 and "+(e.segmentCount-1))}return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},Of=class extends mf{constructor(e,t={},r){super(e.replace(/\/$/,""),nf(nf({},Sf),{},{"Content-Type":"application/json"},t),r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await gf.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},jf=class extends Of{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Pf(this.url,this.headers,e,this.fetch)}async createBucket(e){return(()=>super.createBucket)().call(this,e)}async getBucket(e){return(()=>super.getBucket)().call(this,e)}async listBuckets(e={}){return(()=>super.listBuckets)().call(this,e)}async deleteBucket(e){return(()=>super.deleteBucket)().call(this,e)}},Pf=class extends Tf{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){return(()=>super.createIndex)().call(this,nf(nf({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(e={}){return(()=>super.listIndexes)().call(this,nf(nf({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return(()=>super.getIndex)().call(this,this.vectorBucketName,e)}async deleteIndex(e){return(()=>super.deleteIndex)().call(this,this.vectorBucketName,e)}index(e){return new Af(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},Af=class extends Ef{constructor(e,t,r,n,s){super(e,t,s),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=this;return(()=>super.putVectors)().call(t,nf(nf({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var t=this;return(()=>super.getVectors)().call(t,nf(nf({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(e={}){var t=this;return(()=>super.listVectors)().call(t,nf(nf({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var t=this;return(()=>super.queryVectors)().call(t,nf(nf({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var t=this;return(()=>super.deleteVectors)().call(t,nf(nf({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},Df=class extends kf{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new _f(this.url,this.headers,e,this.fetch)}get vectors(){return new jf(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Cf(this.url+"/iceberg",this.headers,this.fetch)}};const Nf="2.95.3",Mf=3e4,Rf=9e4,Lf={"X-Client-Info":`gotrue-js/${Nf}`},If="X-Supabase-Api-Version",$f={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Ff=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class zf extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Bf(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Uf extends zf{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class Wf extends zf{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Vf extends zf{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class Hf extends Vf{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Gf(e){return Bf(e)&&"AuthSessionMissingError"===e.name}class Yf extends Vf{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qf extends Vf{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Xf extends Vf{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Kf extends Vf{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Jf extends Vf{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Qf extends Vf{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Zf(e){return Bf(e)&&"AuthRetryableFetchError"===e.name}class ep extends Vf{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class tp extends Vf{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const rp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),np=" \t\n\r=".split(""),sp=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<np.length;t+=1)e[np[t].charCodeAt(0)]=-2;for(let t=0;t<rp.length;t+=1)e[rp[t].charCodeAt(0)]=t;return e})();function ip(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(rp[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(rp[e]),t.queuedBits-=6}}function op(e,t,r){const n=sp[e];if(!(n>-1)){if(-2===n)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function ap(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let o=0;o<e.length;o+=1)op(e.charCodeAt(o),s,i);return t.join("")}function lp(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function cp(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let s=0;s<e.length;s+=1)op(e.charCodeAt(s),r,n);return new Uint8Array(t)}function up(e){const t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const t=1024*(n-55296)&65535;n=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}lp(n,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function hp(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>ip(e,r,n)),ip(null,r,n),t.join("")}const dp=()=>"undefined"!=typeof window&&"undefined"!=typeof document,fp={tested:!1,writable:!1},pp=()=>{if(!dp())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(Xa){return!1}if(fp.tested)return fp.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),fp.tested=!0,fp.writable=!0}catch(Xa){fp.tested=!0,fp.writable=!1}return fp.writable};const gp=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),mp=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},yp=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(n){return r}},vp=async(e,t)=>{await e.removeItem(t)};class bp{constructor(){this.promise=new bp.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function wp(e){const t=e.split(".");if(3!==t.length)throw new tp("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!Ff.test(t[r]))throw new tp("JWT not in base64url format");return{header:JSON.parse(ap(t[0])),payload:JSON.parse(ap(t[1])),signature:cp(t[2]),raw:{header:t[0],payload:t[1]}}}function xp(e){return("0"+e.toString(16)).substr(-2)}async function _p(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Sp(e,t,r=!1){const n=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,xp).join("")}();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await mp(e,`${t}-code-verifier`,s);const i=await _p(n);return[i,n===i?"plain":"s256"]}bp.promiseConstructor=Promise;const kp=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Cp=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Tp(e){if(!Cp.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ep(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Op(e){return JSON.parse(JSON.stringify(e))}const jp=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Pp=[502,503,504];async function Ap(e){var t,r;if(!("object"==typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"==typeof r.json))throw new Qf(jp(e),0);if(Pp.includes(e.status))throw new Qf(jp(e),e.status);let n,s;try{n=await e.json()}catch(Xa){throw new Wf(jp(Xa),Xa)}const i=function(e){const t=e.headers.get(If);if(!t)return null;if(!t.match(kp))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(Xa){return null}}(e);if(i&&i.getTime()>=$f.timestamp&&"object"==typeof n&&n&&"string"==typeof n.code?s=n.code:"object"==typeof n&&n&&"string"==typeof n.error_code&&(s=n.error_code),s){if("weak_password"===s)throw new ep(jp(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===s)throw new Hf}else if("object"==typeof n&&n&&"object"==typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new ep(jp(n),e.status,n.weak_password.reasons);throw new Uf(jp(n),e.status||500,s)}async function Dp(e,t,r,n){var s;const i=Object.assign({},null==n?void 0:n.headers);i[If]||(i[If]=$f.name),(null==n?void 0:n.jwt)&&(i.Authorization=`Bearer ${n.jwt}`);const o=null!==(s=null==n?void 0:n.query)&&void 0!==s?s:{};(null==n?void 0:n.redirectTo)&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await async function(e,t,r,n,s,i){const o=((e,t,r,n)=>{const s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))})(t,n,s,i);let a;try{a=await e(r,Object.assign({},o))}catch(Xa){throw console.error(Xa),new Qf(jp(Xa),0)}a.ok||await Ap(a);if(null==n?void 0:n.noResolveJson)return a;try{return await a.json()}catch(Xa){await Ap(Xa)}}(e,t,r+a,{headers:i,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}function Np(e){var t;let r=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Mp(e){const t=Np(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function Rp(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Lp(e){return{data:e,error:null}}function Ip(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,o=Cr(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},user:Object.assign({},o)},error:null}}function $p(e){return e}const Fp=["global","local","others"];class zp{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=gp(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Fp[0]){if(Fp.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fp.join(", ")}`);try{return await Dp(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Bf(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Dp(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Rp})}catch(r){if(Bf(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Cr(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await Dp(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Ip,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(Bf(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Dp(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Rp})}catch(t){if(Bf(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,s,i,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await Dp(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(s=null===(n=null==e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==s?s:""},xform:$p});if(c.error)throw c.error;const u=await c.json(),h=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,d=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(Bf(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){Tp(e);try{return await Dp(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Rp})}catch(t){if(Bf(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Tp(e);try{return await Dp(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Rp})}catch(r){if(Bf(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Tp(e);try{return await Dp(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Rp})}catch(r){if(Bf(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Tp(e.userId);try{const{data:t,error:r}=await Dp(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(Bf(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Tp(e.userId),Tp(e.id);try{return{data:await Dp(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Bf(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,n,s,i,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await Dp(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(s=null===(n=null==e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==s?s:""},xform:$p});if(c.error)throw c.error;const u=await c.json(),h=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,d=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(Bf(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(e){try{return await Dp(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(Bf(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Dp(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(Bf(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Dp(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(r){if(Bf(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await Dp(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Bf(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Dp(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(Bf(t))return{data:null,error:t};throw t}}}function Bp(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Up=!!(globalThis&&pp()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Wp extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Vp extends Wp{}async function Hp(e,t,r){Up&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Up&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(!n){if(0===t)throw Up&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Vp(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Up)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(Xa){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",Xa)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}Up&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{Up&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))}function Gp(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Yp(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class qp extends Error{constructor({message:e,code:t,cause:r,name:n}){var s;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=null!==(s=null!=n?n:r instanceof Error?r.name:void 0)&&void 0!==s?s:"Unknown Error",this.code=t}}class Xp extends qp{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function Kp({error:e,options:t}){var r,n,s;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new qp({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(!0===(null===(r=i.authenticatorSelection)||void 0===r?void 0:r.requireResidentKey))return new qp({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if("conditional"===t.mediation&&"required"===(null===(n=i.authenticatorSelection)||void 0===n?void 0:n.userVerification))return new qp({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if("required"===(null===(s=i.authenticatorSelection)||void 0===s?void 0:s.userVerification))return new qp({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if("InvalidStateError"===e.name)return new qp({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if("NotAllowedError"===e.name)return new qp({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("NotSupportedError"===e.name){return 0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new qp({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new qp({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e})}if("SecurityError"===e.name){const t=window.location.hostname;if(!ng(t))return new qp({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(i.rp.id!==t)return new qp({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new qp({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new qp({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new qp({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Jp({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new qp({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if("NotAllowedError"===e.name)return new qp({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("SecurityError"===e.name){const t=window.location.hostname;if(!ng(t))return new qp({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new qp({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new qp({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new qp({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}const Qp=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function Zp(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=Cr(e,["challenge","user","excludeCredentials"]),i=cp(t).buffer,o=Object.assign(Object.assign({},r),{id:cp(r.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:i,user:o});if(n&&n.length>0){a.excludeCredentials=new Array(n.length);for(let e=0;e<n.length;e++){const t=n[e];a.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:cp(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return a}function eg(e){if(!e)throw new Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Cr(e,["challenge","allowCredentials"]),s=cp(t).buffer,i=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let e=0;e<r.length;e++){const t=r[e];i.allowCredentials[e]=Object.assign(Object.assign({},t),{id:cp(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return i}function tg(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:hp(new Uint8Array(e.response.attestationObject)),clientDataJSON:hp(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=r.authenticatorAttachment)&&void 0!==t?t:void 0}}function rg(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:hp(new Uint8Array(s.authenticatorData)),clientDataJSON:hp(new Uint8Array(s.clientDataJSON)),signature:hp(new Uint8Array(s.signature)),userHandle:s.userHandle?hp(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:null!==(t=r.authenticatorAttachment)&&void 0!==t?t:void 0}}function ng(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function sg(){var e,t;return!!(dp()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"==typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const ig={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},og={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ag(...e){const t=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),r=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),n={};for(const s of e)if(s)for(const e in s){const i=s[e];if(void 0!==i)if(Array.isArray(i))n[e]=i;else if(r(i))n[e]=i;else if(t(i)){const r=n[e];t(r)?n[e]=ag(r,i):n[e]=ag(i)}else n[e]=i}return n}class lg{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:n},s){var i;try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:a};const l=null!=n?n:Qp.createNewAbortSignal();if("create"===o.webauthn.type){const{user:e}=o.webauthn.credential_options.publicKey;if(!e.name){const t=r;if(t)e.name=`${e.id}:${t}`;else{const t=(await this.client.getUser()).data.user,r=(null===(i=null==t?void 0:t.user_metadata)||void 0===i?void 0:i.name)||(null==t?void 0:t.email)||(null==t?void 0:t.id)||"User";e.name=`${e.id}:${r}`}}e.displayName||(e.displayName=e.name)}switch(o.webauthn.type){case"create":{const t=function(e,t){return ag(ig,e,t||{})}(o.webauthn.credential_options.publicKey,null==s?void 0:s.create),{data:r,error:n}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Xp("Browser returned unexpected credential type",t)}:{data:null,error:new Xp("Empty credential response",t)}}catch(Vg){return{data:null,error:Kp({error:Vg,options:e})}}}({publicKey:t,signal:l});return r?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:r}},error:null}:{data:null,error:n}}case"request":{const t=function(e,t){return ag(og,e,t||{})}(o.webauthn.credential_options.publicKey,null==s?void 0:s.request),{data:r,error:n}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Xp("Browser returned unexpected credential type",t)}:{data:null,error:new Xp("Empty credential response",t)}}catch(Vg){return{data:null,error:Jp({error:Vg,options:e})}}}(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:t,signal:l}));return r?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:r}},error:null}:{data:null,error:n}}}}catch(o){return Bf(o)?{data:null,error:o}:{data:null,error:new Wf("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=("undefined"!=typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!=typeof window?[window.location.origin]:void 0),signal:n}={}},s){if(!t)return{data:null,error:new zf("rpId is required for WebAuthn authentication")};try{if(!sg())return{data:null,error:new Wf("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:n},{request:s});if(!i)return{data:null,error:o};const{webauthn:a}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:a.type,rpId:t,rpOrigins:r,credential_response:a.credential_response}})}catch(i){return Bf(i)?{data:null,error:i}:{data:null,error:new Wf("Unexpected error in authenticate",i)}}}async _register({friendlyName:e,webauthn:{rpId:t=("undefined"!=typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!=typeof window?[window.location.origin]:void 0),signal:n}={}},s){if(!t)return{data:null,error:new zf("rpId is required for WebAuthn registration")};try{if(!sg())return{data:null,error:new Wf("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(t=>{var r;return null===(r=t.data)||void 0===r?void 0:r.all.find(t=>"webauthn"===t.factor_type&&t.friendly_name===e&&"unverified"!==t.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null==e?void 0:e.id}):void 0),{data:null,error:o};const{data:a,error:l}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:n},{create:s});return a?this._verify({factorId:i.id,challengeId:a.challengeId,webauthn:{rpId:t,rpOrigins:r,type:a.webauthn.type,credential_response:a.webauthn.credential_response}}):{data:null,error:l}}catch(i){return Bf(i)?{data:null,error:i}:{data:null,error:new Wf("Unexpected error in register",i)}}}}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(Xa){"undefined"!=typeof self&&(self.globalThis=self)}}();const cg={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Lf,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function ug(e,t,r){return await r()}const hg={};class dg{get jwks(){var e,t;return null!==(t=null===(e=hg[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){hg[this.storageKey]=Object.assign(Object.assign({},hg[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=hg[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){hg[this.storageKey]=Object.assign(Object.assign({},hg[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},cg),e);if(this.storageKey=s.storageKey,this.instanceID=null!==(t=dg.nextInstanceID[this.storageKey])&&void 0!==t?t:0,dg.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,"function"==typeof s.debug&&(this.logger=s.debug),this.instanceID>0&&dp()){const e=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new zp({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=gp(s.fetch),this.lock=s.lock||ug,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&dp()&&(null===(r=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===r?void 0:r.locks)?this.lock=Hp:this.lock=ug,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new lg(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:pp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Bp(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Bp(this.memoryStorage)),dp()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(Xa){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",Xa)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e);try{await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}catch(t){this._debug("#broadcastChannel","error",t)}})}this.initialize().catch(e=>{this._debug("#initialize()","error",e)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Nf}) ${(new Date).toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},r="none";if(dp()&&(t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(Xa){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),dp()&&this.detectSessionInUrl&&"none"!==r){const{data:n,error:s}=await this._getSessionFromURL(t,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),function(e){return Bf(e)&&"AuthImplicitGrantRedirectError"===e.name}(s)){const t=null===(e=s.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:s}}return{error:s}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Bf(t)?this._returnResult({error:t}):this._returnResult({error:new Wf("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const s=await Dp(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:Np}),{data:i,error:o}=s;if(o||!i)return this._returnResult({data:{user:null,session:null},error:o});const a=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:l,session:a},error:null})}catch(s){if(Bf(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(e){var t,r,n;try{let s;if("email"in e){const{email:r,password:n,options:i}=e;let o=null,a=null;"pkce"===this.flowType&&([o,a]=await Sp(this.storage,this.storageKey)),s=await Dp(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:o,code_challenge_method:a},xform:Np})}else{if(!("phone"in e))throw new qf("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:o}=e;s=await Dp(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(r=null==o?void 0:o.data)&&void 0!==r?r:{},channel:null!==(n=null==o?void 0:o.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:Np})}}const{data:i,error:o}=s;if(o||!i)return await vp(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const a=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:l,session:a},error:null})}catch(s){if(await vp(this.storage,`${this.storageKey}-code-verifier`),Bf(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:n,options:s}=e;t=await Dp(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:Mp})}else{if(!("phone"in e))throw new qf("You must provide either an email or phone number and a password");{const{phone:r,password:n,options:s}=e;t=await Dp(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:Mp})}}const{data:r,error:n}=t;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!r||!r.session||!r.user){const e=new Yf;return this._returnResult({data:{user:null,session:null},error:e})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(t){if(Bf(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,n,s;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,n,s,i,o,a,l,c,u,h;let d,f;if("message"in e)d=e.message,f=e.signature;else{const{chain:u,wallet:h,statement:p,options:g}=e;let m;if(dp())if("object"==typeof h)m=h;else{const e=window;if(!("ethereum"in e)||"object"!=typeof e.ethereum||!("request"in e.ethereum)||"function"!=typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");m=e.ethereum}else{if("object"!=typeof h||!(null==g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");m=h}const y=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href),v=await m.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!v||0===v.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const b=Gp(v[0]);let w=null===(r=null==g?void 0:g.signInWithEthereum)||void 0===r?void 0:r.chainId;if(!w){const e=await m.request({method:"eth_chainId"});w=parseInt(e,16)}d=function(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:c,scheme:u,uri:h,version:d}=e;if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==d)throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`);const f=`${u?`${u}://${n}`:n} wants you to sign in with your Ethereum account:\n${Gp(e.address)}\n\n${e.statement?`${e.statement}\n`:""}`;let p=`URI: ${h}\nVersion: ${d}\nChain ID: ${r}${o?`\nNonce: ${o}`:""}\nIssued At: ${i.toISOString()}`;if(s&&(p+=`\nExpiration Time: ${s.toISOString()}`),a&&(p+=`\nNot Before: ${a.toISOString()}`),l&&(p+=`\nRequest ID: ${l}`),c){let e="\nResources:";for(const t of c){if(!t||"string"!=typeof t)throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${t}`);e+=`\n- ${t}`}p+=e}return`${f}\n${p}`}({domain:y.host,address:b,statement:p,uri:y.href,version:"1",chainId:w,nonce:null===(n=null==g?void 0:g.signInWithEthereum)||void 0===n?void 0:n.nonce,issuedAt:null!==(i=null===(s=null==g?void 0:g.signInWithEthereum)||void 0===s?void 0:s.issuedAt)&&void 0!==i?i:new Date,expirationTime:null===(o=null==g?void 0:g.signInWithEthereum)||void 0===o?void 0:o.expirationTime,notBefore:null===(a=null==g?void 0:g.signInWithEthereum)||void 0===a?void 0:a.notBefore,requestId:null===(l=null==g?void 0:g.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(c=null==g?void 0:g.signInWithEthereum)||void 0===c?void 0:c.resources}),f=await m.request({method:"personal_sign",params:[Yp(d),b]})}try{const{data:t,error:r}=await Dp(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:f},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:Np});if(r)throw r;if(!t||!t.session||!t.user){const e=new Yf;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(p){if(Bf(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(e){var t,r,n,s,i,o,a,l,c,u,h,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{const{chain:h,wallet:d,statement:g,options:m}=e;let y;if(dp())if("object"==typeof d)y=d;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");y=e.solana}else{if("object"!=typeof d||!(null==m?void 0:m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=d}const v=new URL(null!==(t=null==m?void 0:m.url)&&void 0!==t?t:window.location.href);if("signIn"in y&&y.signIn){const e=await y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==m?void 0:m.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),g?{statement:g}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");f="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in y&&"function"==typeof y.signMessage&&"publicKey"in y&&"object"==typeof y&&y.publicKey&&"toBase58"in y.publicKey&&"function"==typeof y.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${v.host} wants you to sign in with your Solana account:`,y.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${v.href}`,`Issued At: ${null!==(n=null===(r=null==m?void 0:m.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==n?n:(new Date).toISOString()}`,...(null===(s=null==m?void 0:m.signInWithSolana)||void 0===s?void 0:s.notBefore)?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...(null===(i=null==m?void 0:m.signInWithSolana)||void 0===i?void 0:i.expirationTime)?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...(null===(o=null==m?void 0:m.signInWithSolana)||void 0===o?void 0:o.chainId)?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...(null===(a=null==m?void 0:m.signInWithSolana)||void 0===a?void 0:a.nonce)?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...(null===(l=null==m?void 0:m.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...(null===(u=null===(c=null==m?void 0:m.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===u?void 0:u.length)?["Resources",...m.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await y.signMessage((new TextEncoder).encode(f),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:r}=await Dp(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:hp(p)},(null===(h=e.options)||void 0===h?void 0:h.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:Np});if(r)throw r;if(!t||!t.session||!t.user){const e=new Yf;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(g){if(Bf(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(e){const t=await yp(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!=t?t:"").split("/");try{if(!r&&"pkce"===this.flowType)throw new Jf;const{data:t,error:s}=await Dp(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Np});if(await vp(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!t||!t.session||!t.user){const e=new Yf;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:s})}catch(s){if(await vp(this.storage,`${this.storageKey}-code-verifier`),Bf(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:s,nonce:i}=e,o=await Dp(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:Np}),{data:a,error:l}=o;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a||!a.session||!a.user){const e=new Yf;return this._returnResult({data:{user:null,session:null},error:e})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:l})}catch(t){if(Bf(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,n,s,i;try{if("email"in e){const{email:n,options:s}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await Sp(this.storage,this.storageKey));const{error:a}=await Dp(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null==s?void 0:s.data)&&void 0!==t?t:{},create_user:null===(r=null==s?void 0:s.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:i,code_challenge_method:o},redirectTo:null==s?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}if("phone"in e){const{phone:t,options:r}=e,{data:o,error:a}=await Dp(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null==r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(s=null==r?void 0:r.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(i=null==r?void 0:r.channel)&&void 0!==i?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a})}throw new qf("You must provide either an email or phone number.")}catch(o){if(await vp(this.storage,`${this.storageKey}-code-verifier`),Bf(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var t,r;try{let n,s;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,s=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:i,error:o}=await Dp(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:Np});if(o)throw o;if(!i){throw new Error("An error occurred on token verification.")}const a=i.session,l=i.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),this._returnResult({data:{user:l,session:a},error:null})}catch(n){if(Bf(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var t,r,n,s,i;try{let o=null,a=null;"pkce"===this.flowType&&([o,a]=await Sp(this.storage,this.storageKey));const l=await Dp(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:Lp});return(null===(s=l.data)||void 0===s?void 0:s.url)&&dp()&&!(null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(o){if(await vp(this.storage,`${this.storageKey}-code-verifier`),Bf(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Hf;const{error:n}=await Dp(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(Bf(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:s}=e,{error:i}=await Dp(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},redirectTo:null==s?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}if("phone"in e){const{phone:r,type:n,options:s}=e,{data:i,error:o}=await Dp(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o})}throw new qf("You must provide either an email or phone number and a type")}catch(t){if(Bf(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(Xa){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(Xa){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await yp(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<Rf;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const t=await yp(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=Ep()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const t={value:this.suppressGetSessionWarning};e.user=function(e,t){return new Proxy(e,{get:(e,r,n)=>{if("__isInsecureUserWarningProxy"===r)return!0;if("symbol"==typeof r){const t=r.toString();if("Symbol(Symbol.toPrimitive)"===t||"Symbol(Symbol.toStringTag)"===t||"Symbol(util.inspect.custom)"===t||"Symbol(nodejs.util.inspect.custom)"===t)return Reflect.get(e,r,n)}return t.value||"string"!=typeof r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,r,n)}})}(e.user,t),t.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Dp(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Rp}):await this._useSession(async e=>{var t,r,n;const{data:s,error:i}=e;if(i)throw i;return(null===(t=s.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await Dp(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(r=s.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,xform:Rp}):{data:{user:null},error:new Hf}})}catch(t){if(Bf(t))return Gf(t)&&(await this._removeSession(),await vp(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:n,error:s}=r;if(s)throw s;if(!n.session)throw new Hf;const i=n.session;let o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=await Sp(this.storage,this.storageKey));const{data:l,error:c}=await Dp(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:i.access_token,xform:Rp});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(r){if(await vp(this.storage,`${this.storageKey}-code-verifier`),Bf(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Hf;const t=Date.now()/1e3;let r=t,n=!0,s=null;const{payload:i}=wp(e.access_token);if(i.exp&&(r=i.exp,n=r<=t),n){const{data:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!t)return{data:{user:null,session:null},error:null};s=t}else{const{data:n,error:i}=await this._getUser(e.access_token);if(i)return this._returnResult({data:{user:null,session:null},error:i});s={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(t){if(Bf(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:n,error:s}=t;if(s)throw s;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new Hf;const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Bf(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!dp())throw new Xf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Xf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Kf("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Xf("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Kf("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:s,refresh_token:i,expires_in:o,expires_at:a,token_type:l}=e;if(!(s&&o&&i&&l))throw new Xf("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(o);let h=c+u;a&&(h=parseInt(a));const d=h-c;1e3*d<=Mf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${u}s`);const f=h-u;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,h,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,h,c);const{data:p,error:g}=await this._getUser(s);if(g)throw g;const m={provider_token:r,provider_refresh_token:n,access_token:s,expires_in:u,expires_at:h,refresh_token:i,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:e.type},error:null})}catch(r){if(Bf(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await yp(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:n,error:s}=t;if(s&&!Gf(s))return this._returnResult({error:s});const i=null===(r=n.session)||void 0===r?void 0:r.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return Bf(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status)&&!Gf(t))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await vp(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=Symbol("auth-callback"),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:n},error:s}=t;if(s)throw s;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(Vg){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",Vg),console.error(Vg)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;"pkce"===this.flowType&&([r,n]=await Sp(this.storage,this.storageKey,!0));try{return await Dp(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(await vp(this.storage,`${this.storageKey}-code-verifier`),Bf(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(t){if(Bf(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:n}=await this._useSession(async t=>{var r,n,s,i,o;const{data:a,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:!0});return await Dp(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(i=a.session)||void 0===i?void 0:i.access_token)&&void 0!==o?o:void 0})});if(n)throw n;return dp()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==r?void 0:r.url),this._returnResult({data:{provider:e.provider,url:null==r?void 0:r.url},error:null})}catch(r){if(Bf(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:n,data:{session:s}}=t;if(n)throw n;const{options:i,provider:o,token:a,access_token:l,nonce:c}=e,u=await Dp(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!==(r=null==s?void 0:s.access_token)&&void 0!==r?r:void 0,body:{provider:o,id_token:a,access_token:l,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:Np}),{data:h,error:d}=u;return d?this._returnResult({data:{user:null,session:null},error:d}):h&&h.session&&h.user?(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:d})):this._returnResult({data:{user:null,session:null},error:new Yf})}catch(n){if(await vp(this.storage,`${this.storageKey}-code-verifier`),Bf(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:s,error:i}=t;if(i)throw i;return await Dp(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(r=s.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0})})}catch(t){if(Bf(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await function(e,t){const r=new Promise((r,n)=>{(async()=>{for(let s=0;s<1/0;s++)try{const n=await e(s);if(!t(s,null,n))return void r(n)}catch(Xa){if(!t(s,Xa))return void n(Xa)}})()});return r}(async r=>(r>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Dp(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Np})),(e,t)=>{const n=200*Math.pow(2,e);return t&&Zf(t)&&Date.now()+n-r<Mf})}catch(r){if(this._debug(t,"error",r),Bf(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),dp()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await yp(this.storage,this.storageKey);if(s&&this.userStorage){let t=await yp(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:s.user},await mp(this.userStorage,this.storageKey+"-user",t)),s.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:Ep()}else if(s&&!s.user&&!s.user){const e=await yp(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(s.user=e.user,await vp(this.storage,this.storageKey+"-user"),await mp(this.storage,this.storageKey,s)):s.user=Ep()}if(this._debug(r,"session from storage",s),!this._isValidSession(s))return this._debug(r,"session is not valid"),void(null!==s&&await this._removeSession());const i=1e3*(null!==(t=s.expires_at)&&void 0!==t?t:1/0)-Date.now()<Rf;if(this._debug(r,`session has${i?"":" not"} expired with margin of 90000s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=await this._callRefreshToken(s.refresh_token);e&&(console.error(e),Zf(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(s.user&&!0===s.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(s.access_token);!t&&(null==e?void 0:e.user)?(s.user=e.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(n){console.error("Error getting user data:",n),this._debug(r,"error getting user data, skipping SIGNED_IN notification",n)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(Vg){return this._debug(r,"error",Vg),void console.error(Vg)}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Hf;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new bp;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new Hf;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={data:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(s){if(this._debug(n,"error",s),Bf(s)){const e={data:null,error:s};return Zf(s)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],s=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(Xa){n.push(Xa)}});if(await Promise.all(s),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await vp(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await mp(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const n=Op(e);await mp(this.storage,this.storageKey,n)}else{const e=Op(t);await mp(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await vp(this.storage,this.storageKey),await vp(this.storage,this.storageKey+"-code-verifier"),await vp(this.storage,this.storageKey+"-user"),this.userStorage&&await vp(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&dp()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(Xa){console.error("removing visibilitychange callback failed",Xa)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Mf);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*r.expires_at-e)/Mf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(Xa){console.error("Auto refresh tick failed with error. This is likely a transient error.",Xa)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(Xa){if(!(Xa.isAcquireTimeout||Xa instanceof Wp))throw Xa;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!dp()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){const[e,t]=await Sp(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null==r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:s}=t;return s?this._returnResult({data:null,error:s}):await Dp(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(t){if(Bf(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:a,error:l}=await Dp(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===a.type&&(null===(n=null==a?void 0:a.totp)||void 0===n?void 0:n.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),this._returnResult({data:a,error:null}))})}catch(t){if(Bf(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:s}=t;if(s)return this._returnResult({data:null,error:s});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?tg(e.webauthn.credential_response):rg(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:a}=await Dp(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:i,headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return a?this._returnResult({data:null,error:a}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:a}))})}catch(t){if(Bf(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:s}=t;if(s)return this._returnResult({data:null,error:s});const i=await Dp(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});if(i.error)return i;const{data:o}=i;if("webauthn"!==o.type)return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Zp(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:eg(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Bf(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n={all:[],phone:[],totp:[],webauthn:[]};for(const s of null!==(e=null==t?void 0:t.factors)&&void 0!==e?e:[])n.all.push(s),"verified"===s.status&&n[s.factor_type].push(s);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,r,n,s;if(e)try{const{payload:n}=wp(e);let s=null;n.aal&&(s=n.aal);let i=s;const{data:{user:o},error:a}=await this.getUser(e);if(a)return this._returnResult({data:null,error:a});(null!==(r=null===(t=null==o?void 0:o.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(i="aal2");return{data:{currentLevel:s,nextLevel:i,currentAuthenticationMethods:n.amr||[]},error:null}}catch(u){if(Bf(u))return this._returnResult({data:null,error:u});throw u}const{data:{session:i},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=wp(i.access_token);let l=null;a.aal&&(l=a.aal);let c=l;(null!==(s=null===(n=i.user.factors)||void 0===n?void 0:n.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(c="aal2");return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:a.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Dp(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new Hf})})}catch(t){if(Bf(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Hf});const i=await Dp(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return i.data&&i.data.redirect_url&&dp()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(r){if(Bf(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Hf});const i=await Dp(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return i.data&&i.data.redirect_url&&dp()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(r){if(Bf(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await Dp(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new Hf})})}catch(e){if(Bf(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?(await Dp(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Hf})})}catch(t){if(Bf(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;const n=Date.now();if(r=this.jwks.keys.find(t=>t.kid===e),r&&this.jwks_cached_at+6e5>n)return r;const{data:s,error:i}=await Dp(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return s.keys&&0!==s.keys.length?(this.jwks=s,this.jwks_cached_at=n,r=s.keys.find(t=>t.kid===e),r||null):null}async getClaims(e,t={}){try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});r=e.session.access_token}const{header:n,payload:s,signature:i,raw:{header:o,payload:a}}=wp(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(s.exp);const l=n.alg&&!n.alg.startsWith("HS")&&n.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(n.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:s,header:n,signature:i},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),u=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!(await crypto.subtle.verify(c,u,i,up(`${o}.${a}`))))throw new tp("Invalid JWT signature");return{data:{claims:s,header:n,signature:i},error:null}}catch(r){if(Bf(r))return this._returnResult({data:null,error:r});throw r}}}dg.nextInstanceID={};const fg=dg;let pg="";pg="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const gg={headers:{"X-Client-Info":`supabase-js-${pg}/2.95.3`}},mg={schema:"public"},yg={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},vg={};function bg(e){return(bg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wg(e){var t=function(e,t){if("object"!=bg(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=bg(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bg(t)?t:t+""}function xg(e,t,r){return(t=wg(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Sg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_g(Object(r),!0).forEach(function(t){xg(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const kg=(e,t,r)=>{const n=(e=>e?(...t)=>e(...t):(...e)=>fetch(...e))(r),s=Headers;return async(r,i)=>{var o;const a=null!==(o=await t())&&void 0!==o?o:e;let l=new s(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),n(r,Sg(Sg({},i),{},{headers:l}))}};var Cg=class extends fg{constructor(e){super(e)}},Tg=class{constructor(e,t,r){var n,s;this.supabaseUrl=e,this.supabaseKey=t;const i=function(e){const t=null==e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((r=t).endsWith("/")?r:r+"/")}catch(n){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var r}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,a=function(e,t){var r,n;const{db:s,auth:i,realtime:o,global:a}=e,{db:l,auth:c,realtime:u,global:h}=t,d={db:Sg(Sg({},l),s),auth:Sg(Sg({},c),i),realtime:Sg(Sg({},u),o),storage:{},global:Sg(Sg(Sg({},h),a),{},{headers:Sg(Sg({},null!==(r=null==h?void 0:h.headers)&&void 0!==r?r:{}),null!==(n=null==a?void 0:a.headers)&&void 0!==n?n:{})}),accessToken:async()=>""};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=r?r:{},{db:mg,realtime:vg,auth:Sg(Sg({},yg),{},{storageKey:o}),global:gg});var l;(this.storageKey=null!==(n=a.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(s=a.global.headers)&&void 0!==s?s:{},a.accessToken)?(this.accessToken=a.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(l=a.auth)&&void 0!==l?l:{},this.headers,a.global.fetch);this.fetch=kg(t,this._getAccessToken.bind(this),a.global.fetch),this.realtime=this._initRealtimeClient(Sg({headers:this.headers,accessToken:this._getAccessToken.bind(this)},a.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new Kh(new URL("rest/v1",i).href,{headers:this.headers,schema:a.db.schema,fetch:this.fetch,timeout:a.db.timeout,urlLengthLimit:a.db.urlLengthLimit}),this.storage=new Df(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),a.accessToken||this._listenForAuthEvents()}get functions(){return new $h(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t,r=this;if(r.accessToken)return await r.accessToken();const{data:n}=await r.auth.getSession();return null!==(e=null===(t=n.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,storageKey:i,flowType:o,lock:a,debug:l,throwOnError:c},u,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Cg({url:this.authUrl.href,headers:Sg(Sg({},d),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,flowType:o,lock:a,debug:l,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new zd(this.realtimeUrl.href,Sg(Sg({},e),{},{params:Sg(Sg({},{apikey:this.supabaseKey}),null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=r,this.realtime.setAuth(r))}};(function(){if("undefined"!=typeof window)return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(null==t)return!1;const r=t.match(/^v(\d+)\./);return!!r&&parseInt(r[1],10)<=18})()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");console.error(" [SUPABASE] VITE_SUPABASE_URL not set in environment variables"),console.error(" [SUPABASE] VITE_SUPABASE_ANON_KEY not set in environment variables"),console.log(" [SUPABASE] Initializing client with URL:",void 0+"...");const Eg=((e,t,r)=>new Tg(e,t,r))("",""),Og=[{id:"template1",name:"Template 1",path:new URL(""+new URL("template1-C8ehQCk7.jpeg",import.meta.url).href,import.meta.url).href},{id:"template2",name:"Template 2",path:new URL(""+new URL("template2-CGWLcm4s.jpeg",import.meta.url).href,import.meta.url).href},{id:"template3",name:"Template 3",path:new URL(""+new URL("template3-yVgy9xkv.jpeg",import.meta.url).href,import.meta.url).href}];function jg({sourceImage:e,onSave:t,onClose:r,isLoading:n}){const s=f.useRef(null),i=f.useRef(null),[o,a]=f.useState(Og[0].id),[c,u]=f.useState(!1),[h,d]=f.useState(!0),[p,g]=f.useState("");f.useEffect(()=>{if(!s.current)return;(async()=>{try{d(!0),console.log(" [PhotoboxEditor] Initializing canvas...");const t=s.current;if(!t)return;const r=new Jc(t,{width:800,height:600,backgroundColor:"#f0f0f0"});i.current=r,console.log(" [PhotoboxEditor] Canvas created"),eh.fromURL(e,{crossOrigin:"anonymous",onLoaded:e=>{try{console.log(" [PhotoboxEditor] Source image loaded"),e.scaleToWidth(800),e.set({left:0,top:Math.max(0,(600-e.getScaledHeight())/2),selectable:!1}),r.add(e),r.renderAll()}catch(Vg){console.error(" [PhotoboxEditor] Error adding source image:",Vg),g("Failed to load camera image")}},onError:()=>{console.error(" [PhotoboxEditor] Failed to load source image"),g("Failed to load camera image")}});const n=Og.find(e=>e.id===o)?.path;return n&&(console.log(" [PhotoboxEditor] Loading template from:",n),eh.fromURL(n,{crossOrigin:"anonymous",onLoaded:e=>{try{console.log(" [PhotoboxEditor] Template loaded"),e.scaleToWidth(800),e.set({left:0,top:0,selectable:!0}),r.add(e),r.renderAll(),d(!1)}catch(Vg){console.error(" [PhotoboxEditor] Error adding template:",Vg),d(!1)}},onError:()=>{console.error(" [PhotoboxEditor] Failed to load template"),d(!1),g("Failed to load template")}})),()=>{try{r.dispose()}catch(Vg){console.log("  Error disposing canvas:",Vg)}}}catch(t){console.error(" [PhotoboxEditor] Canvas initialization error:",t),g("Canvas initialization failed"),d(!1)}})()},[e,o]);return l.jsx("div",{"code-path":"src/components/PhotoboxEditor.tsx:200:5",className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{"code-path":"src/components/PhotoboxEditor.tsx:201:7",className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-auto",children:[l.jsxs("div",{"code-path":"src/components/PhotoboxEditor.tsx:203:9",className:"sticky top-0 bg-gradient-to-r from-pink-500 to-purple-600 p-4 text-white flex items-center justify-between",children:[l.jsx("h2",{"code-path":"src/components/PhotoboxEditor.tsx:204:11",className:"text-xl font-bold",children:" Photobox Editor"}),l.jsx("button",{"code-path":"src/components/PhotoboxEditor.tsx:205:11",onClick:r,disabled:c,className:"p-1 hover:bg-white/20 rounded transition",children:l.jsx(ne,{"code-path":"src/components/PhotoboxEditor.tsx:210:13",className:"w-6 h-6"})})]}),l.jsxs("div",{"code-path":"src/components/PhotoboxEditor.tsx:215:9",className:"p-6 space-y-6",children:[p&&l.jsxs("div",{"code-path":"src/components/PhotoboxEditor.tsx:217:13",className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[l.jsx("p",{"code-path":"src/components/PhotoboxEditor.tsx:218:15",className:"text-red-800 font-semibold mb-2",children:" Error"}),l.jsx("p",{"code-path":"src/components/PhotoboxEditor.tsx:219:15",className:"text-red-700 text-sm",children:p}),l.jsx(It,{"code-path":"src/components/PhotoboxEditor.tsx:220:15",onClick:r,variant:"outline",className:"mt-4",children:"Close"})]}),!p&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{"code-path":"src/components/PhotoboxEditor.tsx:229:15",className:"flex justify-center bg-gray-100 p-4 rounded-lg relative",children:[l.jsx("canvas",{"code-path":"src/components/PhotoboxEditor.tsx:230:17",ref:s,className:"border-4 border-gray-300 rounded shadow-lg"}),h&&l.jsx("div",{"code-path":"src/components/PhotoboxEditor.tsx:235:19",className:"absolute inset-0 bg-black/20 rounded flex items-center justify-center",children:l.jsxs("div",{"code-path":"src/components/PhotoboxEditor.tsx:236:21",className:"bg-white px-4 py-2 rounded-lg shadow-lg text-center",children:[l.jsx("div",{"code-path":"src/components/PhotoboxEditor.tsx:237:23",className:"animate-spin mb-2",children:""}),l.jsx("p",{"code-path":"src/components/PhotoboxEditor.tsx:238:23",className:"text-sm font-medium text-gray-700",children:"Loading editor..."})]})})]}),l.jsxs("div",{"code-path":"src/components/PhotoboxEditor.tsx:245:15",className:"space-y-3",children:[l.jsx("label",{"code-path":"src/components/PhotoboxEditor.tsx:246:17",className:"block text-sm font-semibold text-gray-700",children:" Select Template"}),l.jsx("div",{"code-path":"src/components/PhotoboxEditor.tsx:249:17",className:"grid grid-cols-3 gap-4",children:Og.map(e=>l.jsxs("button",{"code-path":"src/components/PhotoboxEditor.tsx:251:21",onClick:()=>(e=>{if(a(e),d(!0),!i.current)return;const t=i.current,r=t.getObjects();for(let s=r.length-1;s>0;s--)t.remove(r[s]);const n=Og.find(t=>t.id===e)?.path;n&&(console.log(" [PhotoboxEditor] Switching to template:",e),eh.fromURL(n,{crossOrigin:"anonymous",onLoaded:e=>{try{e.scaleToWidth(800),e.set({left:0,top:0,selectable:!0}),t.add(e),t.renderAll(),d(!1),console.log(" [PhotoboxEditor] Template switched successfully")}catch(Vg){console.error(" [PhotoboxEditor] Error switching template:",Vg),d(!1)}},onError:()=>{console.error(" [PhotoboxEditor] Failed to load new template"),d(!1)}}))})(e.id),disabled:h||c||n,className:`relative p-3 rounded-lg border-2 transition ${o===e.id?"border-pink-500 bg-pink-50":"border-gray-300 hover:border-pink-300"} ${h||c||n?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx("img",{"code-path":"src/components/PhotoboxEditor.tsx:261:23",src:e.path,alt:e.name,className:"w-full h-24 object-cover rounded",onError:t=>{console.error("Failed to load template thumbnail:",e.id),t.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100"%3E%3Crect fill="%23ccc" width="100" height="100"/%3E%3C/svg%3E'}}),l.jsx("p",{"code-path":"src/components/PhotoboxEditor.tsx:270:23",className:"mt-2 text-sm font-medium text-gray-700",children:e.name})]},e.id))})]}),l.jsxs("div",{"code-path":"src/components/PhotoboxEditor.tsx:277:15",className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-900",children:[l.jsx("p",{"code-path":"src/components/PhotoboxEditor.tsx:278:17",className:"font-semibold mb-1",children:" Editor Controls:"}),l.jsxs("ul",{"code-path":"src/components/PhotoboxEditor.tsx:279:17",className:"list-disc list-inside space-y-1 text-xs",children:[l.jsx("li",{"code-path":"src/components/PhotoboxEditor.tsx:280:19",children:"Click and drag elements to move them"}),l.jsx("li",{"code-path":"src/components/PhotoboxEditor.tsx:281:19",children:"Use corner handles to resize"}),l.jsx("li",{"code-path":"src/components/PhotoboxEditor.tsx:282:19",children:"Right-click to rotate"}),l.jsx("li",{"code-path":"src/components/PhotoboxEditor.tsx:283:19",children:"Select template to switch frames"})]})]}),l.jsxs("div",{"code-path":"src/components/PhotoboxEditor.tsx:288:15",className:"flex gap-3 justify-end",children:[l.jsx(It,{"code-path":"src/components/PhotoboxEditor.tsx:289:17",onClick:r,disabled:c||h,variant:"outline",children:"Cancel"}),l.jsx(It,{"code-path":"src/components/PhotoboxEditor.tsx:296:17",onClick:async()=>{if(i.current){u(!0);try{console.log(" [PhotoboxEditor] Exporting canvas...");i.current.getElement().toBlob(async e=>{try{if(!e)throw new Error("Failed to create blob");const n=Og.find(e=>e.id===o)?.name||"Unknown";console.log(" [PhotoboxEditor] Canvas exported, saving..."),await t(e,n),u(!1),r()}catch(n){console.error(" [PhotoboxEditor] Blob save error:",n),u(!1)}},"image/png",.95)}catch(e){console.error(" [PhotoboxEditor] Save error:",e),u(!1)}}},disabled:c||n||h,className:"bg-gradient-to-r from-pink-500 to-purple-600 text-white hover:from-pink-600 hover:to-purple-700",children:c?" Saving...":" Save Photobox"})]})]})]})]})})}function Pg({onSaveComplete:e}){const[t,r]=f.useState(!1),[n,s]=f.useState(!1),[i,o]=f.useState(""),[a,c]=f.useState(!1),u=f.useRef(null),{isLoading:h,photoboxStatus:d,savePhotobox:p}=function(){const[e,t]=f.useState(!1),[r,n]=f.useState("idle"),s=f.useCallback(async e=>{try{console.log(" [Photobox] Uploading edited photo to Cloudinary...");const t=new FormData;t.append("file",e),t.append("upload_preset","MEMORY_CLD"),t.append("resource_type","auto");const r=await fetch("https://api.cloudinary.com/v1_1/dfmieytqu/image/upload",{method:"POST",body:t});if(!r.ok)throw new Error(`Upload failed: ${r.statusText}`);const n=await r.json();if(!n.secure_url)throw new Error("No secure_url returned from Cloudinary");return console.log(" [Photobox] Cloudinary upload success:",n.secure_url),n.secure_url}catch(t){throw console.error(" [Photobox] Cloudinary upload error:",t),t}},[]),i=f.useCallback(async(e,t)=>{try{console.log(" [Photobox] Saving to Supabase...",{templateName:t}),n("saving");const r=`Photobox - ${t} - ${(new Date).toLocaleDateString()}`,{data:s,error:i}=await Eg.from("Photobox").insert([{title:r,image_url:e,file_type:"image/png",template_name:t}]).select();if(i)throw console.error(" [Photobox] Supabase error:",i.message),n("error"),i;console.log(" [Photobox] Saved to Supabase:",s?.[0]?.id),n("success"),setTimeout(()=>n("idle"),2e3)}catch(r){throw console.error(" [Photobox] Save failed:",r),n("error"),setTimeout(()=>n("idle"),3e3),r}},[]);return{isLoading:e,photoboxStatus:r,savePhotobox:f.useCallback(async(e,r)=>{try{t(!0);const n=await s(e);await i(n,r),console.log(" [Photobox] Complete save workflow finished")}catch(n){throw console.error(" [Photobox] Save workflow failed:",n),n}finally{t(!1)}},[s,i]),uploadPhotoToCloudinary:s,savePhotoboxToSupabase:i}}(),g=f.useCallback(()=>{a||t||n||(c(!0),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{console.log(" [PhotoboxButton] Opening camera..."),r(!0),c(!1)},100))},[a,t,n]),m=f.useCallback(e=>{console.log(" [PhotoboxButton] Photo captured, size:",e.length),o(e),r(!1);const t=setTimeout(()=>{console.log(" [PhotoboxButton] Opening editor..."),s(!0)},150);return()=>clearTimeout(t)},[]),y=f.useCallback(async(t,r)=>{try{console.log(" [PhotoboxButton] Processing save..."),await p(t,r),console.log(" [PhotoboxButton] Save complete"),o(""),s(!1),e?.()}catch(n){console.error(" [PhotoboxButton] Save failed:",n)}},[p,e]),v=f.useCallback(()=>{r(!1),c(!1),u.current&&clearTimeout(u.current)},[]);return l.jsxs(l.Fragment,{children:[l.jsx(It,{"code-path":"src/components/PhotoboxButton.tsx:87:7",onClick:g,disabled:t||n||h||a,className:"flex items-center gap-2 bg-gradient-to-r from-yellow-400 to-pink-500 text-white hover:from-yellow-500 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all",title:"Create a photo with templates and effects",children:a?l.jsxs(l.Fragment,{children:[l.jsx("span",{"code-path":"src/components/PhotoboxButton.tsx:95:13",className:"animate-spin",children:""}),"Initializing..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ee,{"code-path":"src/components/PhotoboxButton.tsx:100:13",className:"w-5 h-5"}),"Photobox"]})}),t&&l.jsx(vs,{"code-path":"src/components/PhotoboxButton.tsx:108:9",onCapture:m,onClose:v}),n&&i&&l.jsx(jg,{"code-path":"src/components/PhotoboxButton.tsx:116:9",sourceImage:i,onSave:y,onClose:()=>{s(!1),o("")},isLoading:h}),"saving"===d&&l.jsxs("div",{"code-path":"src/components/PhotoboxButton.tsx:129:9",className:"fixed bottom-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 z-40 animate-pulse",children:[l.jsx("span",{"code-path":"src/components/PhotoboxButton.tsx:130:11",className:"animate-spin",children:""}),"Saving photobox..."]}),"success"===d&&l.jsxs("div",{"code-path":"src/components/PhotoboxButton.tsx:136:9",className:"fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 z-40 animate-in fade-in",children:[l.jsx("span",{"code-path":"src/components/PhotoboxButton.tsx:137:11",children:""}),"Photobox saved successfully!"]}),"error"===d&&l.jsxs("div",{"code-path":"src/components/PhotoboxButton.tsx:143:9",className:"fixed bottom-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 z-40 animate-in fade-in",children:[l.jsx("span",{"code-path":"src/components/PhotoboxButton.tsx:144:11",children:""}),"Error saving photobox"]})]})}function Ag({status:e,message:t}){if("idle"===e)return null;let r=null,n="bg-blue-100",s="text-blue-700",i="border-blue-300",o=t||"Menyimpan...";switch(e){case"saving":r=l.jsx(V,{"code-path":"src/components/CloudStatus.tsx:21:14",className:"w-4 h-4 animate-pulse"}),n="bg-blue-100",s="text-blue-700",i="border-blue-300",o="Menyimpan ke cloud...";break;case"success":r=l.jsx(W,{"code-path":"src/components/CloudStatus.tsx:28:14",className:"w-4 h-4"}),n="bg-green-100",s="text-green-700",i="border-green-300",o="Tersimpan";break;case"error":r=l.jsx(U,{"code-path":"src/components/CloudStatus.tsx:35:14",className:"w-4 h-4"}),n="bg-red-100",s="text-red-700",i="border-red-300",o="Gagal menyimpan"}return l.jsxs("div",{"code-path":"src/components/CloudStatus.tsx:44:5",className:`fixed bottom-6 right-6 px-4 py-3 rounded-lg border-2 flex items-center gap-2 ${n} ${s} ${i} shadow-lg transition-all duration-300`,children:[r,l.jsx("span",{"code-path":"src/components/CloudStatus.tsx:48:7",className:"text-sm font-medium",children:o})]})}function Dg(){const[e,t]=f.useState([]);return f.useEffect(()=>{const e=[];for(let t=0;t<15;t++)e.push({id:t,x:100*Math.random(),y:100*Math.random(),size:15+25*Math.random(),duration:8+10*Math.random(),delay:5*Math.random(),type:"heart"});for(let t=15;t<20;t++)e.push({id:t,x:-10,y:80*Math.random(),size:30,duration:15+10*Math.random(),delay:8*Math.random(),type:"plane"});t(e)},[]),l.jsxs("div",{"code-path":"src/components/themes/LoveTheme.tsx:50:5",className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[l.jsx("div",{"code-path":"src/components/themes/LoveTheme.tsx:52:7",className:"absolute inset-0 bg-gradient-to-br from-pink-200 via-rose-100 to-pink-300"}),e.filter(e=>"heart"===e.type).map(e=>l.jsx("div",{"code-path":"src/components/themes/LoveTheme.tsx:56:9",className:"absolute animate-float-heart",style:{left:`${e.x}%`,top:`${e.y}%`,animationDuration:`${e.duration}s`,animationDelay:`${e.delay}s`},children:l.jsx(G,{"code-path":"src/components/themes/LoveTheme.tsx:66:11",className:"text-pink-400/40",style:{width:e.size,height:e.size},fill:"currentColor"})},e.id)),e.filter(e=>"plane"===e.type).map(e=>l.jsx("div",{"code-path":"src/components/themes/LoveTheme.tsx:79:9",className:"absolute animate-paper-plane",style:{top:`${e.y}%`,animationDuration:`${e.duration}s`,animationDelay:`${e.delay}s`},children:l.jsx("svg",{"code-path":"src/components/themes/LoveTheme.tsx:88:11",width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none",className:"text-rose-400/50",children:l.jsx("path",{"code-path":"src/components/themes/LoveTheme.tsx:95:13",d:"M2 12L22 2L15 22L11 13L2 12Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})},e.id)),l.jsx("div",{"code-path":"src/components/themes/LoveTheme.tsx:108:7",className:"absolute inset-0",children:[...Array(20)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/LoveTheme.tsx:110:11",className:"absolute w-1 h-1 bg-yellow-300 rounded-full animate-sparkle",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:3*Math.random()+"s"}},`sparkle-${t}`))})]})}const Ng={jellyfish:"",nemo:"",dolphin:"",starfish:"",seahorse:""};function Mg(){const[e,t]=f.useState([]),[r,n]=f.useState([]);f.useEffect(()=>{const e=[],r=["jellyfish","nemo","dolphin","starfish","seahorse"];for(let t=0;t<12;t++)e.push({id:t,x:90*Math.random()+5,y:80*Math.random()+10,type:r[Math.floor(Math.random()*r.length)],direction:Math.random()>.5?"left":"right",speed:10+20*Math.random(),size:30+20*Math.random(),showBubble:!1});t(e)},[]);const s=f.useCallback((e,r,s)=>{t(t=>t.map(t=>t.id===e?{...t,showBubble:!0}:t));const i=Date.now();n(e=>[...e,{id:i,x:r,y:s}]),setTimeout(()=>{n(e=>e.filter(e=>e.id!==i)),t(t=>t.map(t=>t.id===e?{...t,showBubble:!1}:t))},2e3)},[]);return l.jsxs("div",{"code-path":"src/components/themes/LoveSeaTheme.tsx:64:5",className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[l.jsx("div",{"code-path":"src/components/themes/LoveSeaTheme.tsx:66:7",className:"absolute inset-0 bg-gradient-to-b from-cyan-200 via-blue-300 to-blue-500"}),l.jsxs("div",{"code-path":"src/components/themes/LoveSeaTheme.tsx:69:7",className:"absolute bottom-0 left-0 right-0 h-32",children:[l.jsx("svg",{"code-path":"src/components/themes/LoveSeaTheme.tsx:70:9",className:"absolute bottom-0 w-full h-full animate-wave",viewBox:"0 0 1440 120",preserveAspectRatio:"none",children:l.jsx("path",{"code-path":"src/components/themes/LoveSeaTheme.tsx:75:11",fill:"rgba(255,255,255,0.3)",d:"M0,60 C240,120 480,0 720,60 C960,120 1200,0 1440,60 L1440,120 L0,120 Z"})}),l.jsx("svg",{"code-path":"src/components/themes/LoveSeaTheme.tsx:80:9",className:"absolute bottom-0 w-full h-full animate-wave-slow",viewBox:"0 0 1440 120",preserveAspectRatio:"none",children:l.jsx("path",{"code-path":"src/components/themes/LoveSeaTheme.tsx:85:11",fill:"rgba(255,255,255,0.2)",d:"M0,40 C360,100 720,20 1080,80 C1260,100 1380,60 1440,40 L1440,120 L0,120 Z"})})]}),e.map(e=>l.jsxs("div",{"code-path":"src/components/themes/LoveSeaTheme.tsx:94:9",className:"absolute cursor-pointer pointer-events-auto transition-transform hover:scale-125 "+("left"===e.direction?"animate-swim-left":"animate-swim-right"),style:{left:`${e.x}%`,top:`${e.y}%`,animationDuration:`${e.speed}s`,fontSize:e.size},onClick:t=>{t.stopPropagation(),s(e.id,e.x,e.y)},children:[l.jsx("span",{"code-path":"src/components/themes/LoveSeaTheme.tsx:110:11",className:"select-none filter drop-shadow-lg",children:Ng[e.type]}),e.showBubble&&l.jsx("div",{"code-path":"src/components/themes/LoveSeaTheme.tsx:116:13",className:"absolute -top-8 left-1/2 -translate-x-1/2 animate-bubble-pop",children:l.jsx(G,{"code-path":"src/components/themes/LoveSeaTheme.tsx:117:15",className:"w-6 h-6 text-pink-500 fill-pink-500"})})]},e.id)),[...Array(15)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/LoveSeaTheme.tsx:125:9",className:"absolute rounded-full bg-white/30 animate-bubble-float",style:{left:100*Math.random()+"%",bottom:"-20px",width:10+20*Math.random()+"px",height:10+20*Math.random()+"px",animationDuration:8+10*Math.random()+"s",animationDelay:5*Math.random()+"s"}},`bubble-${t}`)),r.map(e=>l.jsx("div",{"code-path":"src/components/themes/LoveSeaTheme.tsx:141:9",className:"absolute pointer-events-none",style:{left:`${e.x}%`,top:`${e.y}%`},children:[...Array(5)].map((e,t)=>l.jsx(G,{"code-path":"src/components/themes/LoveSeaTheme.tsx:150:13",className:"absolute w-4 h-4 text-pink-500 fill-pink-500 animate-love-bubble",style:{animationDelay:.1*t+"s",transform:`rotate(${72*t}deg) translateY(-20px)`}},t))},e.id)),l.jsx("div",{"code-path":"src/components/themes/LoveSeaTheme.tsx:163:7",className:"absolute bottom-0 left-0 right-0 flex justify-around pointer-events-none",children:[...Array(8)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/LoveSeaTheme.tsx:165:11",className:"w-4 h-24 bg-gradient-to-t from-green-600 to-green-400 rounded-full origin-bottom animate-sway",style:{animationDelay:.3*t+"s",animationDuration:3+2*Math.random()+"s",opacity:.6}},`seaweed-${t}`))})]})}function Rg(){const[e,t]=f.useState([]),[r,n]=f.useState([]);return f.useEffect(()=>{const e=[];for(let t=0;t<50;t++)e.push({id:t,x:100*Math.random(),delay:10*Math.random(),duration:8+8*Math.random(),size:10+15*Math.random(),swayAmount:30+50*Math.random()});t(e);n([{id:1,x:5,scale:.8},{id:2,x:85,scale:1},{id:3,x:50,scale:.6}])},[]),l.jsxs("div",{"code-path":"src/components/themes/SakuraTheme.tsx:47:5",className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:49:7",className:"absolute inset-0 bg-gradient-to-b from-pink-100 via-pink-50 to-white"}),l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:52:7",className:"absolute inset-0 opacity-30",children:[...Array(5)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:54:11",className:"absolute h-px bg-gradient-to-r from-transparent via-pink-300 to-transparent animate-wind",style:{top:20+15*t+"%",left:"-100%",width:"100%",animationDelay:2*t+"s",animationDuration:"4s"}},`wind-${t}`))}),r.map(e=>l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:70:9",className:"absolute bottom-0 animate-tree-sway",style:{left:`${e.x}%`,transform:`scale(${e.scale})`,transformOrigin:"bottom center"},children:l.jsxs("div",{"code-path":"src/components/themes/SakuraTheme.tsx:80:11",className:"relative",children:[l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:81:13",className:"w-8 h-32 bg-gradient-to-t from-amber-800 to-amber-600 rounded-full mx-auto"}),l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:83:13",className:"absolute -top-16 left-1/2 -translate-x-1/2",children:l.jsxs("div",{"code-path":"src/components/themes/SakuraTheme.tsx:84:15",className:"relative w-48 h-48",children:[l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:86:17",className:"absolute inset-0 bg-gradient-to-br from-pink-300 via-pink-400 to-purple-400 rounded-full opacity-80 blur-sm"}),[...Array(12)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:89:19",className:"absolute w-8 h-8 bg-pink-300 rounded-full animate-flower-glow",style:{left:20+60*Math.random()+"%",top:20+60*Math.random()+"%",animationDelay:.3*t+"s"}},t))]})})]})},e.id)),e.map(e=>l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:107:9",className:"absolute animate-fall-sway",style:{left:`${e.x}%`,animationDelay:`${e.delay}s`,animationDuration:`${e.duration}s`,"--sway-amount":`${e.swayAmount}px`},children:l.jsxs("svg",{"code-path":"src/components/themes/SakuraTheme.tsx:117:11",width:e.size,height:e.size,viewBox:"0 0 20 20",className:"text-pink-300",children:[l.jsx("path",{"code-path":"src/components/themes/SakuraTheme.tsx:123:13",d:"M10 0C10 0 12 5 12 10C12 15 10 20 10 20C10 20 8 15 8 10C8 5 10 0 10 0Z",fill:"currentColor",opacity:"0.8"}),l.jsx("path",{"code-path":"src/components/themes/SakuraTheme.tsx:128:13",d:"M0 10C0 10 5 8 10 8C15 8 20 10 20 10C20 10 15 12 10 12C5 12 0 10 0 10Z",fill:"currentColor",opacity:"0.6"})]})},e.id)),l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:138:7",className:"absolute top-1/4 left-1/4 animate-petal-stuck",children:l.jsx("svg",{"code-path":"src/components/themes/SakuraTheme.tsx:139:9",width:"15",height:"15",viewBox:"0 0 20 20",className:"text-pink-400",children:l.jsx("path",{"code-path":"src/components/themes/SakuraTheme.tsx:140:11",d:"M10 0C10 0 12 5 12 10C12 15 10 20 10 20C10 20 8 15 8 10C8 5 10 0 10 0Z",fill:"currentColor"})})}),l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:143:7",className:"absolute top-1/3 right-1/3 animate-petal-stuck",style:{animationDelay:"1s"},children:l.jsx("svg",{"code-path":"src/components/themes/SakuraTheme.tsx:144:9",width:"12",height:"12",viewBox:"0 0 20 20",className:"text-pink-300",children:l.jsx("path",{"code-path":"src/components/themes/SakuraTheme.tsx:145:11",d:"M10 0C10 0 12 5 12 10C12 15 10 20 10 20C10 20 8 15 8 10C8 5 10 0 10 0Z",fill:"currentColor"})})}),l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:148:7",className:"absolute bottom-1/4 left-1/3 animate-petal-stuck",style:{animationDelay:"2s"},children:l.jsx("svg",{"code-path":"src/components/themes/SakuraTheme.tsx:149:9",width:"18",height:"18",viewBox:"0 0 20 20",className:"text-pink-400",children:l.jsx("path",{"code-path":"src/components/themes/SakuraTheme.tsx:150:11",d:"M10 0C10 0 12 5 12 10C12 15 10 20 10 20C10 20 8 15 8 10C8 5 10 0 10 0Z",fill:"currentColor"})})}),l.jsx("div",{"code-path":"src/components/themes/SakuraTheme.tsx:155:7",className:"absolute inset-0 bg-gradient-radial from-pink-200/20 via-transparent to-transparent"})]})}function Lg({media:e}){const[t,r]=f.useState(null),n=f.useCallback(e=>{r(e)},[]),s=t?e[t.mediaIndex]:null;return l.jsxs("div",{"code-path":"src/components/themes/SpaceTheme.tsx:39:5",className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:41:7",className:"absolute inset-0 bg-gradient-to-b from-indigo-950 via-purple-950 to-black"}),l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:44:7",className:"absolute inset-0",children:[...Array(100)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:46:11",className:"absolute rounded-full bg-white animate-twinkle",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",width:1+3*Math.random()+"px",height:1+3*Math.random()+"px",animationDelay:3*Math.random()+"s",animationDuration:2+3*Math.random()+"s"}},`star-${t}`))}),l.jsxs("div",{"code-path":"src/components/themes/SpaceTheme.tsx:62:7",className:"absolute inset-0",children:[l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:63:9",className:"absolute top-1/4 left-1/4 w-96 h-96 bg-purple-600/20 rounded-full blur-3xl animate-pulse-slow"}),l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:64:9",className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-pink-600/20 rounded-full blur-3xl animate-pulse-slow",style:{animationDelay:"1s"}}),l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:65:9",className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-indigo-600/10 rounded-full blur-3xl animate-pulse-slow",style:{animationDelay:"2s"}})]}),[...Array(3)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:70:9",className:"absolute w-1 h-1 bg-white rounded-full animate-shooting-star",style:{top:10+20*t+"%",left:"-10%",animationDelay:4*t+"s"},children:l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:79:11",className:"absolute inset-0 w-20 h-px bg-gradient-to-r from-white to-transparent -rotate-45 origin-left"})},`shooting-${t}`)),[{id:1,x:50,y:50,size:80,color:"from-orange-400 to-red-500",name:"Mars",orbitRadius:0,orbitDuration:0,mediaIndex:0},{id:2,x:20,y:30,size:60,color:"from-blue-400 to-cyan-500",name:"Neptune",orbitRadius:150,orbitDuration:20,mediaIndex:1},{id:3,x:80,y:70,size:70,color:"from-yellow-400 to-orange-500",name:"Jupiter",orbitRadius:200,orbitDuration:25,mediaIndex:2},{id:4,x:30,y:80,size:50,color:"from-purple-400 to-pink-500",name:"Venus",orbitRadius:120,orbitDuration:15,mediaIndex:3},{id:5,x:70,y:20,size:55,color:"from-green-400 to-teal-500",name:"Uranus",orbitRadius:180,orbitDuration:22,mediaIndex:4}].map(e=>l.jsxs("div",{"code-path":"src/components/themes/SpaceTheme.tsx:85:9",className:"absolute pointer-events-auto cursor-pointer",style:{left:`${e.x}%`,top:`${e.y}%`,transform:"translate(-50%, -50%)"},onClick:()=>n(e),children:[e.orbitRadius>0&&l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:97:13",className:"absolute border border-white/10 rounded-full animate-orbit",style:{width:2*e.orbitRadius,height:2*e.orbitRadius,left:-e.orbitRadius+e.size/2,top:-e.orbitRadius+e.size/2,animationDuration:`${e.orbitDuration}s`}}),l.jsxs("div",{"code-path":"src/components/themes/SpaceTheme.tsx:110:11",className:`relative rounded-full bg-gradient-to-br ${e.color} shadow-2xl transition-transform duration-300 hover:scale-110`,style:{width:e.size,height:e.size,boxShadow:"0 0 30px rgba(255,255,255,0.3), inset -10px -10px 20px rgba(0,0,0,0.3)"},children:[l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:119:13",className:"absolute inset-2 rounded-full bg-white/10"}),l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:120:13",className:"absolute top-1/4 left-1/4 w-1/3 h-1/3 rounded-full bg-white/20"}),l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:123:13",className:"absolute -bottom-6 left-1/2 -translate-x-1/2 text-white text-xs font-medium whitespace-nowrap opacity-70",children:e.name})]})]},e.id)),t&&s&&l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:132:9",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm pointer-events-auto",children:l.jsxs("div",{"code-path":"src/components/themes/SpaceTheme.tsx:133:11",className:"relative max-w-2xl w-full mx-4",children:[l.jsx("button",{"code-path":"src/components/themes/SpaceTheme.tsx:135:13",onClick:()=>r(null),className:"absolute -top-12 right-0 w-10 h-10 bg-white/20 rounded-full flex items-center justify-center hover:bg-white/30 transition-colors",children:l.jsx(ne,{"code-path":"src/components/themes/SpaceTheme.tsx:139:15",className:"w-6 h-6 text-white"})}),l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:143:13",className:"rounded-2xl overflow-hidden shadow-2xl",children:"photo"===s.type?l.jsx("img",{"code-path":"src/components/themes/SpaceTheme.tsx:145:17",src:s.url,alt:"Memory",className:"w-full max-h-[70vh] object-contain"}):l.jsx("video",{"code-path":"src/components/themes/SpaceTheme.tsx:151:17",src:s.url,controls:!0,className:"w-full max-h-[70vh]"})}),l.jsxs("div",{"code-path":"src/components/themes/SpaceTheme.tsx:160:13",className:"mt-4 text-center",children:[l.jsxs("h3",{"code-path":"src/components/themes/SpaceTheme.tsx:161:15",className:"text-2xl font-bold text-white",children:["Memory from ",t.name]}),l.jsxs("p",{"code-path":"src/components/themes/SpaceTheme.tsx:162:15",className:"text-white/70",children:["Year ",s.year]})]})]})}),l.jsxs("div",{"code-path":"src/components/themes/SpaceTheme.tsx:169:7",className:"absolute top-10 right-10 w-24 h-24 rounded-full bg-gradient-to-br from-gray-200 to-gray-400 shadow-lg",children:[l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:170:9",className:"absolute top-4 left-4 w-4 h-4 rounded-full bg-gray-300/50"}),l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:171:9",className:"absolute bottom-6 right-6 w-6 h-6 rounded-full bg-gray-300/50"}),l.jsx("div",{"code-path":"src/components/themes/SpaceTheme.tsx:172:9",className:"absolute top-1/2 left-1/2 w-3 h-3 rounded-full bg-gray-300/50"})]})]})}const Ig=["","","","","","","","","",""];function $g(){const[e,t]=f.useState([]),[r,n]=f.useState([]),s=f.useRef(null);f.useEffect(()=>{s.current={play:(()=>{const e=new(window.AudioContext||window.webkitAudioContext);return()=>{const t=e.createOscillator(),r=e.createGain();t.connect(r),r.connect(e.destination),t.frequency.setValueAtTime(400,e.currentTime),t.frequency.exponentialRampToValueAtTime(600,e.currentTime+.1),t.frequency.exponentialRampToValueAtTime(300,e.currentTime+.3),r.gain.setValueAtTime(.3,e.currentTime),r.gain.exponentialRampToValueAtTime(.01,e.currentTime+.3),t.start(e.currentTime),t.stop(e.currentTime+.3)}})()};const e=[];for(let t=0;t<8;t++)e.push({id:t,x:90*Math.random()+5,y:70*Math.random()+15,direction:Math.random()>.5?"left":"right",type:Math.random()>.7?"scratching":"walking",emoji:Ig[Math.floor(Math.random()*Ig.length)]});t(e)},[]);const i=f.useCallback(e=>{s.current&&s.current.play(),n(t=>[...t,e]),setTimeout(()=>{n(t=>t.filter(t=>t!==e))},1e3)},[]);return l.jsxs("div",{"code-path":"src/components/themes/CatTheme.tsx:73:5",className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:75:7",className:"absolute inset-0 bg-gradient-to-br from-orange-100 via-yellow-50 to-orange-200"}),l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:78:7",className:"absolute inset-0 opacity-10",children:[...Array(15)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:80:11",className:"absolute animate-fade-paw",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:.5*t+"s"},children:l.jsxs("svg",{"code-path":"src/components/themes/CatTheme.tsx:89:13",width:"30",height:"30",viewBox:"0 0 24 24",fill:"currentColor",className:"text-orange-400",children:[l.jsx("circle",{"code-path":"src/components/themes/CatTheme.tsx:90:15",cx:"12",cy:"14",r:"5"}),l.jsx("circle",{"code-path":"src/components/themes/CatTheme.tsx:91:15",cx:"6",cy:"8",r:"2.5"}),l.jsx("circle",{"code-path":"src/components/themes/CatTheme.tsx:92:15",cx:"12",cy:"5",r:"2.5"}),l.jsx("circle",{"code-path":"src/components/themes/CatTheme.tsx:93:15",cx:"18",cy:"8",r:"2.5"})]})},`paw-${t}`))}),[...Array(5)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:101:9",className:"absolute animate-bounce-slow",style:{left:10+20*t+"%",bottom:"10%",animationDelay:.3*t+"s"},children:l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:110:11",className:"w-8 h-8 rounded-full bg-gradient-to-br from-pink-400 to-red-500 shadow-lg",children:l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:111:13",className:"absolute inset-1 rounded-full border-2 border-white/30"})})},`yarn-${t}`)),e.filter(e=>"walking"===e.type).map(e=>l.jsxs("div",{"code-path":"src/components/themes/CatTheme.tsx:118:9",className:"absolute pointer-events-auto cursor-pointer transition-transform hover:scale-125 "+("left"===e.direction?"animate-cat-walk-left":"animate-cat-walk-right"),style:{left:`${e.x}%`,top:`${e.y}%`,animationDuration:15+10*Math.random()+"s"},onClick:()=>i(e.id),children:[l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:130:11",className:"text-4xl select-none filter drop-shadow-lg",children:e.emoji}),r.includes(e.id)&&l.jsxs("div",{"code-path":"src/components/themes/CatTheme.tsx:136:13",className:"absolute -top-4 left-1/2 -translate-x-1/2 flex gap-1 animate-scratch",children:[l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:137:15",className:"text-red-400 text-xl",children:""}),l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:138:15",className:"text-red-400 text-xl",children:""}),l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:139:15",className:"text-red-400 text-xl",children:""})]})]},e.id)),e.filter(e=>"scratching"===e.type).map(e=>l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:147:9",className:"absolute pointer-events-auto cursor-pointer",style:{left:`${e.x}%`,top:`${e.y}%`},onClick:()=>i(e.id),children:l.jsxs("div",{"code-path":"src/components/themes/CatTheme.tsx:156:11",className:"relative",children:[l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:157:13",className:"text-4xl select-none filter drop-shadow-lg animate-scratch-text",children:""}),l.jsxs("div",{"code-path":"src/components/themes/CatTheme.tsx:162:13",className:"absolute -bottom-2 left-0 right-0 flex justify-center gap-1",children:[l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:163:15",className:"w-0.5 h-6 bg-red-400/60 rounded-full transform -rotate-12"}),l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:164:15",className:"w-0.5 h-8 bg-red-400/60 rounded-full"}),l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:165:15",className:"w-0.5 h-6 bg-red-400/60 rounded-full transform rotate-12"})]}),r.includes(e.id)&&l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:170:15",className:"absolute -top-6 left-1/2 -translate-x-1/2",children:l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:171:17",className:"text-2xl animate-bounce",children:""})})]})},e.id)),[...Array(6)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:180:9",className:"absolute animate-float-fish",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:.8*t+"s"},children:l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:189:11",className:"text-2xl",children:""})},`fish-${t}`)),l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:194:7",className:"absolute bottom-8 left-8",children:l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:195:9",className:"w-16 h-8 bg-gradient-to-b from-orange-400 to-orange-600 rounded-b-full shadow-lg",children:l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:196:11",className:"absolute top-1 left-2 right-2 h-3 bg-amber-700 rounded-full"})})}),l.jsxs("div",{"code-path":"src/components/themes/CatTheme.tsx:201:7",className:"absolute bottom-12 right-12",children:[l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:202:9",className:"text-5xl",children:""}),l.jsxs("div",{"code-path":"src/components/themes/CatTheme.tsx:203:9",className:"absolute -top-4 right-0 flex flex-col items-center animate-zzz",children:[l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:204:11",className:"text-sm text-blue-400 font-bold",children:"Z"}),l.jsx("span",{"code-path":"src/components/themes/CatTheme.tsx:205:11",className:"text-xs text-blue-400 font-bold",children:"z"})]})]}),l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:210:7",className:"absolute top-1/4 left-1/4 w-4 h-4 bg-orange-300 rounded-full animate-ping"}),l.jsx("div",{"code-path":"src/components/themes/CatTheme.tsx:211:7",className:"absolute top-3/4 right-1/4 w-3 h-3 bg-yellow-300 rounded-full animate-ping",style:{animationDelay:"1s"}})]})}function Fg(){const[e,t]=f.useState([]);return f.useEffect(()=>{const e=[];for(let t=0;t<30;t++)e.push({id:t,x:100*Math.random(),y:100*Math.random(),size:2+6*Math.random(),duration:10+15*Math.random(),delay:5*Math.random(),type:["glow","heart","sparkle"][Math.floor(3*Math.random())]});t(e)},[]),l.jsxs("div",{"code-path":"src/components/themes/OriginalTheme.tsx:37:5",className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:39:7",className:"absolute inset-0 bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900"}),l.jsxs("div",{"code-path":"src/components/themes/OriginalTheme.tsx:42:7",className:"absolute inset-0",children:[l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:43:9",className:"absolute top-1/4 left-1/4 w-[500px] h-[500px] bg-purple-600/20 rounded-full blur-[100px] animate-pulse-slow"}),l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:44:9",className:"absolute bottom-1/4 right-1/4 w-[400px] h-[400px] bg-pink-600/20 rounded-full blur-[100px] animate-pulse-slow",style:{animationDelay:"2s"}}),l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:45:9",className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-indigo-600/15 rounded-full blur-[120px] animate-pulse-slow",style:{animationDelay:"1s"}})]}),l.jsxs("div",{"code-path":"src/components/themes/OriginalTheme.tsx:49:7",className:"absolute inset-0",children:[[...Array(8)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:52:11",className:"absolute animate-float-hex",style:{left:10+12*t+"%",top:15+t%3*25+"%",animationDelay:.5*t+"s"},children:l.jsx("svg",{"code-path":"src/components/themes/OriginalTheme.tsx:61:13",width:"40",height:"46",viewBox:"0 0 40 46",className:"text-white/5",children:l.jsx("path",{"code-path":"src/components/themes/OriginalTheme.tsx:67:15",d:"M20 0L40 11.5V34.5L20 46L0 34.5V11.5L20 0Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"1"})})},`hex-${t}`)),[...Array(12)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:79:11",className:"absolute rounded-full border border-white/10 animate-float-circle",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",width:30+50*Math.random()+"px",height:30+50*Math.random()+"px",animationDelay:.3*t+"s"}},`circle-${t}`))]}),e.map(e=>l.jsxs("div",{"code-path":"src/components/themes/OriginalTheme.tsx:95:9",className:"absolute animate-float-particle",style:{left:`${e.x}%`,top:`${e.y}%`,animationDuration:`${e.duration}s`,animationDelay:`${e.delay}s`},children:["glow"===e.type&&l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:106:13",className:"rounded-full bg-white/30 blur-sm",style:{width:e.size,height:e.size}}),"heart"===e.type&&l.jsx(G,{"code-path":"src/components/themes/OriginalTheme.tsx:115:13",className:"text-pink-400/30",style:{width:3*e.size,height:3*e.size},fill:"currentColor"}),"sparkle"===e.type&&l.jsx(ee,{"code-path":"src/components/themes/OriginalTheme.tsx:125:13",className:"text-yellow-300/40",style:{width:2*e.size,height:2*e.size}})]},e.id)),l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:137:7",className:"absolute inset-0 overflow-hidden",children:[...Array(5)].map((e,t)=>l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:139:11",className:"absolute top-0 w-px h-full bg-gradient-to-b from-transparent via-white/5 to-transparent animate-ray",style:{left:20+15*t+"%",animationDelay:.5*t+"s"}},`ray-${t}`))}),l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:151:7",className:"absolute inset-0 opacity-[0.03]",style:{backgroundImage:"\n            linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px),\n            linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)\n          ",backgroundSize:"50px 50px"}}),l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:163:7",className:"absolute bottom-0 left-0 right-0 h-32",children:l.jsxs("svg",{"code-path":"src/components/themes/OriginalTheme.tsx:164:9",className:"w-full h-full",preserveAspectRatio:"none",children:[l.jsx("defs",{"code-path":"src/components/themes/OriginalTheme.tsx:165:11",children:l.jsxs("linearGradient",{"code-path":"src/components/themes/OriginalTheme.tsx:166:13",id:"lineGrad",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[l.jsx("stop",{"code-path":"src/components/themes/OriginalTheme.tsx:167:15",offset:"0%",stopColor:"rgba(168, 85, 247, 0)"}),l.jsx("stop",{"code-path":"src/components/themes/OriginalTheme.tsx:168:15",offset:"50%",stopColor:"rgba(168, 85, 247, 0.3)"}),l.jsx("stop",{"code-path":"src/components/themes/OriginalTheme.tsx:169:15",offset:"100%",stopColor:"rgba(168, 85, 247, 0)"})]})}),[...Array(5)].map((e,t)=>l.jsx("line",{"code-path":"src/components/themes/OriginalTheme.tsx:173:13",x1:"0",y1:20+20*t,x2:"100%",y2:20+20*t,stroke:"url(#lineGrad)",strokeWidth:"1",className:"animate-pulse-line",style:{animationDelay:.2*t+"s"}},t))]})}),l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:189:7",className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:l.jsx("div",{"code-path":"src/components/themes/OriginalTheme.tsx:190:9",className:"w-[800px] h-[800px] rounded-full bg-gradient-radial from-purple-500/10 via-transparent to-transparent animate-pulse-slow"})})]})}const zg=["082339503532","085339951848"];const Bg=[2021,2022,2023,2024,2025,2026];function Ug(){const[e,t]=f.useState([]),[r,n]=f.useState(!0),[s,i]=f.useState("idle"),o=f.useCallback(async()=>{try{console.log(" [SUPABASE] Fetching data from Memories table..."),n(!0);const{data:e,error:r}=await Eg.from("Memories").select("*").order("created_at",{ascending:!1});if(r)return console.error(" [SUPABASE] Query error:",{message:r.message,code:r.code,details:r.details,hint:r.hint,timestamp:(new Date).toISOString()}),void t(Bg.map(e=>({year:e,media:[]})));if(!e)return console.log(" [SUPABASE] No data returned (null)"),void t(Bg.map(e=>({year:e,media:[]})));if(!Array.isArray(e))return console.error(" [SUPABASE] Invalid data format - expected array:",typeof e),void t(Bg.map(e=>({year:e,media:[]})));console.log(" [SUPABASE] Query success, processing",e.length,"records..."),console.log(" [SUPABASE] Sample data structure:",e.length>0?{sample:e[0],keys:Object.keys(e[0]||{})}:"No data");const s=Bg.map(t=>({year:t,media:e.filter(e=>e.year&&"number"==typeof e.year?e.year===t:(console.log(" [SUPABASE] Skipping item year mismatch:",{id:e.id,year:e.year,yearType:typeof e.year}),!1)).map(e=>({id:e.id.toString(),type:e.file_type?.startsWith("video/")?"video":"photo",url:e.image_url||"",year:e.year,createdAt:new Date(e.created_at)}))}));t(s);const i=s.reduce((e,t)=>e+t.media.length,0);console.log(" [SUPABASE] State updated with",i,"items across",s.filter(e=>e.media.length>0).length,"years")}catch(e){console.error(" [SUPABASE] Exception during fetch:",{error:e instanceof Error?e.message:String(e),timestamp:(new Date).toISOString()}),t(Bg.map(e=>({year:e,media:[]})))}finally{n(!1)}},[]);f.useEffect(()=>{console.log(" [HOOK] useMediaStorage mounted, loading initial data..."),o()},[o]);const a=f.useCallback((e,r,n)=>{const s=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;console.log(" [ADDMEDIA] START - Adding new media:",{year:e,fileName:r.name,fileSize:`${(r.size/1024).toFixed(2)} KB`,fileType:r.type,mediaId:s,timestamp:(new Date).toISOString()}),i("saving");const a={id:s,type:r.type.startsWith("video/")?"video":"photo",url:"",year:e,createdAt:new Date};return t(t=>(console.log(" [ADDMEDIA] Adding placeholder to yearData for year:",e),t.map(t=>t.year===e?{...t,media:[...t.media,a]}:t))),(async e=>{const t=new FormData;t.append("file",e),t.append("upload_preset","MEMORY_CLD"),t.append("resource_type","auto");try{console.log(" [CLOUDINARY] Starting upload:",{fileName:e.name,fileSize:`${(e.size/1024).toFixed(2)} KB`,fileType:e.type,timestamp:(new Date).toISOString()});const r=await fetch("https://api.cloudinary.com/v1_1/dfmieytqu/image/upload",{method:"POST",body:t});if(!r.ok)throw new Error(`Upload failed with status ${r.status}: ${r.statusText}`);const n=await r.json();if(!n.secure_url)throw new Error("Cloudinary did not return secure_url in response");return console.log(" [CLOUDINARY] Upload success:",{url:n.secure_url,publicId:n.public_id,width:n.width,height:n.height,resourceType:n.resource_type}),{url:n.secure_url,publicId:n.public_id}}catch(r){throw console.error(" [CLOUDINARY] Upload failed:",{error:r instanceof Error?r.message:String(r),fileName:e.name,timestamp:(new Date).toISOString()}),r}})(r).then(async({url:r})=>{if(console.log(" [ADDMEDIA] Cloudinary upload complete, updating UI with real URL..."),t(t=>(console.log(" [ADDMEDIA] Updating placeholder URL with Cloudinary URL"),t.map(t=>t.year===e?{...t,media:t.media.map(e=>e.id===s?{...e,url:r}:e)}:t))),n)try{console.log(" [ADDMEDIA] Executing onUploadComplete callback (App.tsx Supabase insert)..."),await Promise.resolve(n(r)),console.log(" [ADDMEDIA] onUploadComplete callback completed SUCCESSFULLY")}catch(a){throw console.error(" [ADDMEDIA] ERROR in onUploadComplete callback:",{error:a instanceof Error?a.message:String(a),stack:a instanceof Error?a.stack:void 0}),a}console.log(" [ADDMEDIA] Waiting 1500ms for Supabase transaction to fully commit..."),await new Promise(e=>setTimeout(e,1500)),console.log(" [ADDMEDIA] SYNCING: Calling fetchFromSupabase() to refresh data...");try{await o(),console.log(" [ADDMEDIA] SYNC COMPLETE - All devices see the new data WITHOUT reload!")}catch(l){console.error(" [ADDMEDIA] ERROR during sync/fetchFromSupabase:",{error:l instanceof Error?l.message:String(l),stack:l instanceof Error?l.stack:void 0})}i("success"),setTimeout(()=>i("idle"),2e3)}).catch(e=>{console.error(" [ADDMEDIA] FAILED - Error during upload process:",{error:e instanceof Error?e.message:String(e),stack:e instanceof Error?e.stack:void 0,fileName:r.name,fileType:r.type}),i("error"),setTimeout(()=>i("idle"),3e3)}),a},[o]),l=f.useCallback(async(e,r)=>{console.log(" [REMOVEMEDIA] START - Removing media:",{year:e,mediaId:r}),t(t=>t.map(t=>t.year===e?{...t,media:t.media.filter(e=>e.id!==r)}:t)),await new Promise(e=>setTimeout(e,300)),console.log(" [REMOVEMEDIA] Syncing deletion across devices..."),await o(),console.log(" [REMOVEMEDIA] COMPLETE - Deletion synced")},[o]),c=f.useCallback(t=>e.find(e=>e.year===t)?.media||[],[e]),u=f.useCallback(()=>e.flatMap(e=>e.media),[e]);return{yearData:e,isLoading:r,cloudStatus:s,addMedia:a,removeMedia:l,getMediaByYear:c,getAllMedia:u,fetchFromSupabase:o,years:Bg}}function Wg(){const{user:e,login:t,logout:r,isAuthenticated:n,isLoading:s}=function(){const[e,t]=f.useState(null),[r,n]=f.useState(!0);return f.useEffect(()=>{const e=localStorage.getItem("memory_user");e&&t(JSON.parse(e)),n(!1)},[]),{user:e,login:f.useCallback((e,r)=>{if(zg.includes(e)&&"20052006"===r){const r={phone:e,isLoggedIn:!0};return t(r),localStorage.setItem("memory_user",JSON.stringify(r)),!0}return!1},[]),logout:f.useCallback(()=>{t(null),localStorage.removeItem("memory_user")},[]),isAuthenticated:!0===e?.isLoggedIn,isLoading:r}}(),{addMedia:i,removeMedia:o,getMediaByYear:a,getAllMedia:c,years:u,isLoading:h,cloudStatus:d,fetchFromSupabase:p}=Ug(),[g,m]=f.useState(!1),[y,v]=f.useState(2021),[b,w]=f.useState("love"),[x,_]=f.useState(!1),S=f.useCallback((e,r)=>t(e,r),[t]),k=f.useCallback((e,t)=>{console.log(" Starting upload for year:",e,"File:",t.name),i(e,t,async r=>{_(!0);try{console.log(" Cloudinary upload complete, saving to Supabase...");const n=`Kenangan ${e} - ${t.name}`,s=r;if(!e||!s||!t.type)return void console.error(" [APP] Invalid input for Supabase insert:",{year:e,url:s?"present":"MISSING",fileType:t.type||"MISSING"});const{data:i,error:o}=await Eg.from("Memories").insert([{title:n,image_url:s,year:e,file_type:t.type}]).select();if(o)return void console.error(" [APP] Error saving to Supabase:",{message:o.message,code:o.code,details:o.details,hint:o.hint});console.log(" Tersimpan ke Supabase:",i?.[0]?.id),console.log(" Waiting 1500ms for Supabase transaction to fully commit..."),await new Promise(e=>setTimeout(e,1500)),console.log(" Fetching updated data from Supabase..."),await p(),console.log(" Data ter-update di UI setelah Supabase insert - TANPA RELOAD!")}catch(Vg){console.error(" Error in saveToSupabase:",Vg)}finally{_(!1)}})},[i,p]),C=f.useCallback(async(e,t)=>{console.log(" [APP] Delete request:",{year:e,mediaId:t});try{const{error:r}=await Eg.from("Memories").delete().eq("id",parseInt(t));if(r)return void console.error(" [APP] Error deleting from Supabase:",r.message);console.log(" [APP] Deleted from Supabase:",t),await o(e,t)}catch(Vg){const t=Vg instanceof Error?Vg.message:String(Vg);console.error(" [APP] Delete exception:",t)}},[o]);if(s||h)return l.jsx("div",{"code-path":"src/App.tsx:141:7",className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-100 to-purple-100",children:l.jsxs("div",{"code-path":"src/App.tsx:142:9",className:"text-center",children:[l.jsx(G,{"code-path":"src/App.tsx:143:11",className:"w-12 h-12 text-pink-500 animate-bounce mx-auto mb-4"}),l.jsx("p",{"code-path":"src/App.tsx:144:11",className:"text-gray-600",children:"Memuat memory..."})]})});const T=c(),E=n;return l.jsxs("div",{"code-path":"src/App.tsx:154:5",className:"min-h-screen relative overflow-x-hidden",children:[(()=>{switch(b){case"love":return l.jsx(Dg,{"code-path":"src/App.tsx:123:16"});case"love-sea":return l.jsx(Mg,{"code-path":"src/App.tsx:125:16"});case"sakura":return l.jsx(Rg,{"code-path":"src/App.tsx:127:16"});case"space":return l.jsx(Lg,{"code-path":"src/App.tsx:129:16",media:c()});case"cat":return l.jsx($g,{"code-path":"src/App.tsx:131:16"});case"original":return l.jsx(Fg,{"code-path":"src/App.tsx:133:16"});default:return l.jsx(Dg,{"code-path":"src/App.tsx:135:16"})}})(),l.jsxs("div",{"code-path":"src/App.tsx:159:7",className:"relative z-10 min-h-screen",children:[l.jsx("header",{"code-path":"src/App.tsx:161:9",className:"sticky top-0 z-50 backdrop-blur-md bg-white/30 border-b border-white/20",children:l.jsxs("div",{"code-path":"src/App.tsx:162:11",className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[l.jsxs("div",{"code-path":"src/App.tsx:164:13",className:"flex items-center gap-2",children:[l.jsx(G,{"code-path":"src/App.tsx:165:15",className:"w-6 h-6 text-pink-500 fill-pink-500"}),l.jsx("span",{"code-path":"src/App.tsx:166:15",className:"font-bold text-gray-800",children:"Memory"})]}),l.jsx("div",{"code-path":"src/App.tsx:170:13",className:"flex items-center gap-3",children:E?l.jsxs(l.Fragment,{children:[l.jsxs("span",{"code-path":"src/App.tsx:173:19",className:"text-sm text-gray-600 flex items-center gap-1",children:[l.jsx(Y,{"code-path":"src/App.tsx:174:21",className:"w-4 h-4 text-green-500"}),e?.phone.slice(-4)]}),l.jsx(It,{"code-path":"src/App.tsx:177:19",variant:"ghost",size:"sm",onClick:r,className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:l.jsx(X,{"code-path":"src/App.tsx:183:21",className:"w-4 h-4"})})]}):l.jsxs(It,{"code-path":"src/App.tsx:187:17",variant:"ghost",size:"sm",onClick:()=>m(!0),className:"text-gray-600 hover:text-pink-500 hover:bg-pink-50",children:[l.jsx(q,{"code-path":"src/App.tsx:193:19",className:"w-4 h-4 mr-1"}),"Login"]})})]})}),l.jsx("div",{"code-path":"src/App.tsx:202:9",className:"sticky top-16 z-40 backdrop-blur-sm border-b border-pink-200/50",children:l.jsxs("div",{"code-path":"src/App.tsx:203:11",className:"max-w-6xl mx-auto px-4 py-4 flex items-center justify-between gap-4",children:[l.jsx("div",{"code-path":"src/App.tsx:204:13",className:"flex-1",children:l.jsx(ys,{"code-path":"src/App.tsx:205:15",currentTheme:b,onSelectTheme:w})}),n?l.jsx(Pg,{"code-path":"src/App.tsx:213:15",onSaveComplete:()=>{console.log(" [App] Photobox save complete, refreshing data..."),p()}}):null]})}),l.jsxs("main",{"code-path":"src/App.tsx:222:9",className:"max-w-6xl mx-auto px-4 py-8",children:[l.jsxs("div",{"code-path":"src/App.tsx:224:11",className:"text-center mb-12",children:[l.jsx("h1",{"code-path":"src/App.tsx:225:13",className:"text-5xl md:text-7xl font-bold bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 bg-clip-text text-transparent mb-4 animate-pulse-slow",children:"MEMORY"}),l.jsxs("p",{"code-path":"src/App.tsx:228:13",className:"text-xl md:text-2xl text-gray-700 font-medium flex items-center justify-center gap-3",children:[l.jsx(G,{"code-path":"src/App.tsx:229:15",className:"w-5 h-5 text-pink-500 fill-pink-500"}),"NAK PUNGUT & NAK SOA",l.jsx(G,{"code-path":"src/App.tsx:231:15",className:"w-5 h-5 text-pink-500 fill-pink-500"})]}),l.jsxs("div",{"code-path":"src/App.tsx:233:13",className:"mt-4 flex items-center justify-center gap-2",children:[l.jsx(ee,{"code-path":"src/App.tsx:234:15",className:"w-4 h-4 text-yellow-500"}),l.jsx("span",{"code-path":"src/App.tsx:235:15",className:"text-sm text-gray-500",children:E?"Kamu bisa menambah dan menghapus foto/video":"Login untuk menambah foto/video"}),l.jsx(ee,{"code-path":"src/App.tsx:240:15",className:"w-4 h-4 text-yellow-500"})]}),x&&l.jsx("p",{"code-path":"src/App.tsx:243:15",className:"text-sm text-blue-500 mt-2",children:" Menyimpan ke cloud..."})]}),l.jsxs("div",{"code-path":"src/App.tsx:248:11",className:"mb-12",children:[l.jsxs("h2",{"code-path":"src/App.tsx:249:13",className:"text-2xl font-bold text-center text-gray-800 mb-6 flex items-center justify-center gap-2",children:[l.jsx(ee,{"code-path":"src/App.tsx:250:15",className:"w-5 h-5 text-purple-500"}),"Pilih Tahun",l.jsx(ee,{"code-path":"src/App.tsx:252:15",className:"w-5 h-5 text-purple-500"})]}),l.jsx(fs,{"code-path":"src/App.tsx:254:13",years:u,selectedYear:y,onSelectYear:v,onAddMedia:k,onRemoveMedia:C,getMediaByYear:a,isAuthenticated:E,onLoginClick:()=>m(!0)})]}),l.jsxs("div",{"code-path":"src/App.tsx:267:11",className:"mb-12",children:[l.jsxs("h2",{"code-path":"src/App.tsx:268:13",className:"text-2xl font-bold text-center text-gray-800 mb-6",children:["Kenangan Tahun ",y]}),a(y).length>0?l.jsx(ps,{"code-path":"src/App.tsx:272:15",media:a(y),isAuthenticated:E,onRemoveMedia:C,maxItems:{top:5,bottom:6}}):l.jsxs("div",{"code-path":"src/App.tsx:279:15",className:"text-center py-12 bg-white/50 rounded-2xl backdrop-blur-sm",children:[l.jsx(G,{"code-path":"src/App.tsx:280:17",className:"w-12 h-12 text-pink-300 mx-auto mb-4"}),l.jsx("p",{"code-path":"src/App.tsx:281:17",className:"text-gray-500",children:"Belum ada kenangan di tahun ini"}),E&&l.jsx("p",{"code-path":"src/App.tsx:283:19",className:"text-sm text-gray-400 mt-2",children:"Tekan tombol + di slider tahun untuk menambah foto/video"})]})]}),T.length>0&&l.jsxs("div",{"code-path":"src/App.tsx:293:13",className:"mb-12",children:[l.jsxs("h2",{"code-path":"src/App.tsx:294:15",className:"text-2xl font-bold text-center text-gray-800 mb-6 flex items-center justify-center gap-2",children:[l.jsx(G,{"code-path":"src/App.tsx:295:17",className:"w-5 h-5 text-pink-500 fill-pink-500"}),"Semua Kenangan",l.jsx(G,{"code-path":"src/App.tsx:297:17",className:"w-5 h-5 text-pink-500 fill-pink-500"})]}),l.jsx(ps,{"code-path":"src/App.tsx:299:15",media:T,isAuthenticated:E,onRemoveMedia:C,maxItems:{top:5,bottom:6}})]}),l.jsx(gs,{"code-path":"src/App.tsx:309:11",theme:b})]}),l.jsxs("footer",{"code-path":"src/App.tsx:313:9",className:"py-8 text-center",children:[l.jsxs("div",{"code-path":"src/App.tsx:314:11",className:"flex items-center justify-center gap-2 text-gray-500",children:[l.jsx(G,{"code-path":"src/App.tsx:315:13",className:"w-4 h-4 text-pink-500 fill-pink-500"}),l.jsx("span",{"code-path":"src/App.tsx:316:13",children:"Made with love for Nak Pungut & Nak Soa"}),l.jsx(G,{"code-path":"src/App.tsx:317:13",className:"w-4 h-4 text-pink-500 fill-pink-500"})]}),l.jsx("p",{"code-path":"src/App.tsx:319:11",className:"text-sm text-gray-400 mt-2",children:"2021 - 2026"})]})]}),l.jsx(ds,{"code-path":"src/App.tsx:324:7",isOpen:g,onClose:()=>m(!1),onLogin:S}),l.jsx(Ag,{"code-path":"src/App.tsx:331:7",status:d})]})}window.addEventListener("error",e=>{console.error(" [GLOBAL] Unhandled error:",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,error:e.error?.message||String(e.error),stack:e.error?.stack,timestamp:(new Date).toISOString()})}),window.addEventListener("unhandledrejection",e=>{console.error(" [GLOBAL] Unhandled promise rejection:",{reason:e.reason?.message||String(e.reason),stack:e.reason?.stack,timestamp:(new Date).toISOString()})}),A.createRoot(document.getElementById("root")).render(l.jsx(f.StrictMode,{"code-path":"src/main.tsx:29:3",children:l.jsx(Wg,{"code-path":"src/main.tsx:30:5"})}));
